{"version":3,"file":"collective.bbcodesnippets.js","sources":["../../../../js/src/main.js"],"sourcesContent":["// keep import for unknown reason, otherwise:\n// Uncaught Error: Dynamic requires are not currently supported by @rollup/plugin-commonjs\n// do not ask why...\nimport { list } from \"./restapi.js\";\n\nconst replace = (selection, template) => {\n  const content = selection.getContent({format: 'text'})\n  let replaced = template.replace(\"$TEXT\", content)\n  let position = replaced.indexOf(\"$CURSOR\")\n  replaced = replaced.replace(\"$CURSOR\", \"\")\n  selection.setContent(replaced)\n  // if (position >= 0) {\n  //   selection.setCursorLocation(selection, position)\n  // }\n}\n\nrequire([\"tinymce\"], function (tinymce) {\n  console.log(\"create and add collectivebbcodesnippets\")\n  const portalUrl = document.body.dataset[\"portalUrl\"]\n  const bbcodesnippet_enabled_url = portalUrl + \"/@bbcodesnippets_enabled\"\n  fetch(\n    bbcodesnippet_enabled_url, \n    {\n      headers: {'Accept': 'application/json'}\n    }\n  )\n  .then(response => response.json())\n  .then(data => {\n    tinymce.create(\"tinymce.plugins.CollectiveBBCodeSnippetsPlugin\", {\n      init: editor => {\n        editor.on(\"init\", function () {\n          console.log(\"editor on init!\")\n        })\n        // Adds a menu item to the tools menu\n        data.forEach( (entry, index) => {\n          const identifier = 'bbcs' + entry.name\n          console.log(index + \" \" + identifier)\n          editor.addMenuItem(identifier, {\n            text: entry.name + \" (\" + entry.snippet + \")\",\n            context: \"bbcs\",\n            onClick: () => {\n              replace(editor.selection, entry.template)\n            }\n          })\n        })\n      }\n    })\n    tinymce.PluginManager.add(\n      \"collectivebbcodesnippets\",\n      tinymce.plugins.CollectiveBBCodeSnippetsPlugin\n    )\n  })\n  .catch(err => {\n    console.log(err)\n  })   \n})()\n"],"names":[],"mappings":";;;EAAA;AAIA;EACA,MAAM,OAAO,GAAG,CAAC,SAAS,EAAE,QAAQ,KAAK;EACzC,EAAE,MAAM,OAAO,GAAG,SAAS,CAAC,UAAU,CAAC,CAAC,MAAM,EAAE,MAAM,CAAC,EAAC;EACxD,EAAE,IAAI,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC,OAAO,EAAE,OAAO,EAAC;EACnD,EAAE,IAAI,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC,SAAS,EAAC;EAC5C,EAAE,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC,SAAS,EAAE,EAAE,EAAC;EAC5C,EAAE,SAAS,CAAC,UAAU,CAAC,QAAQ,EAAC;EAChC;EACA;EACA;EACA,EAAC;AACD;EACA,OAAO,CAAC,CAAC,SAAS,CAAC,EAAE,UAAU,OAAO,EAAE;EACxC,EAAE,OAAO,CAAC,GAAG,CAAC,yCAAyC,EAAC;EACxD,EAAE,MAAM,SAAS,GAAG,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAC;EACtD,EAAE,MAAM,yBAAyB,GAAG,SAAS,GAAG,2BAA0B;EAC1E,EAAE,KAAK;EACP,IAAI,yBAAyB;EAC7B,IAAI;EACJ,MAAM,OAAO,EAAE,CAAC,QAAQ,EAAE,kBAAkB,CAAC;EAC7C,KAAK;EACL,GAAG;EACH,GAAG,IAAI,CAAC,QAAQ,IAAI,QAAQ,CAAC,IAAI,EAAE,CAAC;EACpC,GAAG,IAAI,CAAC,IAAI,IAAI;EAChB,IAAI,OAAO,CAAC,MAAM,CAAC,gDAAgD,EAAE;EACrE,MAAM,IAAI,EAAE,MAAM,IAAI;EACtB,QAAQ,MAAM,CAAC,EAAE,CAAC,MAAM,EAAE,YAAY;EACtC,UAAU,OAAO,CAAC,GAAG,CAAC,iBAAiB,EAAC;EACxC,SAAS,EAAC;EACV;EACA,QAAQ,IAAI,CAAC,OAAO,EAAE,CAAC,KAAK,EAAE,KAAK,KAAK;EACxC,UAAU,MAAM,UAAU,GAAG,MAAM,GAAG,KAAK,CAAC,KAAI;EAChD,UAAU,OAAO,CAAC,GAAG,CAAC,KAAK,GAAG,GAAG,GAAG,UAAU,EAAC;EAC/C,UAAU,MAAM,CAAC,WAAW,CAAC,UAAU,EAAE;EACzC,YAAY,IAAI,EAAE,KAAK,CAAC,IAAI,GAAG,IAAI,GAAG,KAAK,CAAC,OAAO,GAAG,GAAG;EACzD,YAAY,OAAO,EAAE,MAAM;EAC3B,YAAY,OAAO,EAAE,MAAM;EAC3B,cAAc,OAAO,CAAC,MAAM,CAAC,SAAS,EAAE,KAAK,CAAC,QAAQ,EAAC;EACvD,aAAa;EACb,WAAW,EAAC;EACZ,SAAS,EAAC;EACV,OAAO;EACP,KAAK,EAAC;EACN,IAAI,OAAO,CAAC,aAAa,CAAC,GAAG;EAC7B,MAAM,0BAA0B;EAChC,MAAM,OAAO,CAAC,OAAO,CAAC,8BAA8B;EACpD,MAAK;EACL,GAAG,CAAC;EACJ,GAAG,KAAK,CAAC,GAAG,IAAI;EAChB,IAAI,OAAO,CAAC,GAAG,CAAC,GAAG,EAAC;EACpB,GAAG,EAAC;EACJ,CAAC,CAAC;;;;;;"}