<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <record id="view_bank_export_format_tree" model="ir.ui.view">
        <field name="name">bank.export.format.tree</field>
        <field name="model">bank.export.format</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name" />
                <field name="bank" />
            </tree>
        </field>
    </record>
    <record id="view_bank_export_format_form" model="ir.ui.view">
        <field name="name">bank.export.format.form</field>
        <field name="model">bank.export.format</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" />
                        </h1>
                    </div>
                    <group>
                        <field name="bank" />
                    </group>
                    <notebook>
                        <page string="Export Format">
                            <field
                                name="export_format_ids"
                                widget="section_and_note_one2many"
                            >
                                <tree editable="bottom">
                                    <control>
                                        <create
                                            name="add_line_control"
                                            string="Add a line"
                                        />
                                        <create
                                            name="add_section_control"
                                            string="Add a section"
                                            context="{'default_display_type': 'line_section'}"
                                        />
                                        <create
                                            name="add_note_control"
                                            string="Add a note"
                                            context="{'default_display_type': 'line_note'}"
                                        />
                                    </control>

                                    <field
                                        name="display_type"
                                        force_save="1"
                                        invisible="1"
                                    />
                                    <field name="sequence" widget="handle" />
                                    <field name="name" style="white-space: normal;" />
                                    <field name="condition_line" />
                                    <field
                                        name="match_group"
                                        string="Group"
                                        optional="show"
                                    />
                                    <field
                                        name="need_loop"
                                        string="Loop"
                                        optional="show"
                                    />
                                    <field name="sub_loop" optional="show" />
                                    <field
                                        name="sub_value_loop"
                                        optional="show"
                                        attrs="{'required': [('sub_loop', '=', True)]}"
                                    />
                                    <field name="end_line" optional="show" />
                                    <field name="lenght" />
                                    <field name="lenght_from" optional="show" />
                                    <field name="lenght_to" optional="show" />
                                    <field name="value_alignment" optional="show" />
                                    <field name="value_blank_space" optional="show" />
                                    <field name="value_type" />
                                    <field name="value" style="white-space: normal;" />
                                </tree>
                            </field>
                        </page>
                        <page string="Help">
                            <group>
                                <div>
                                    <p>
                                        There are <b
                                        >Condition Line, Sub Value Loop and Value</b> can be any valid python expressions.
                                    </p>
                                    <p>
                                        Data that supports Python expressions, including:
                                        <code>
                                            {rec, line, sub_line, today, today_datetime, idx, idx_line, idx_sub_line, wht_cert, invoices}
                                        </code>
                                        .
                                    </p>
                                    <ul>
                                        <li>
                                            <code>rec</code>
                                            : record on which the action is triggered (bank.payment.export)
                                        </li>
                                        <li>
                                            <code>line</code>
                                            :
                                            <ul>
                                                <li>If <b
                                                    >Loop</b> is not selected, it will retrieve data from <b
                                                    >rec.export_line_ids</b> (bank.payment.export.line).</li>
                                                <li>If <b
                                                    >Loop</b> is selected, it will retrieve data from that specific line (bank.payment.export.line).</li>
                                            </ul>
                                        </li>
                                        <li>
                                            <code>sub_line</code>
                                            : object of the sub loop. it will have data if <b
                                            >Sub Loop</b> is selected.
                                        </li>
                                        <li>
                                            <code>today</code>
                                            : Current date (Format: Date).
                                        </li>
                                        <li>
                                            <code>today_datetime</code>
                                            : Current date and time (Format: Datetime).
                                        </li>
                                        <li>
                                            <code>idx</code>
                                            : The index of that line.
                                        </li>
                                        <li>
                                            <code>idx_line</code>
                                            : The index of that Loop (used when Loop is selected).
                                        </li>
                                        <li>
                                            <code>idx_sub_line</code>
                                            : The index of that Sub Loop (used when Sub Loop is selected).
                                        </li>
                                        <li>
                                            <code>wht_cert</code>
                                            : Withholding Tax from payment. It will have a value when the module <code
                                            >l10n_th_account_tax</code> is installed; if not, it will be set to False.
                                        </li>
                                        <li>
                                            <code>invoices</code>
                                            : Invoices from the payment.
                                        </li>
                                    </ul>
                                    <p>
                                        Looping is used to display data from <b
                                        >rec.export_line_ids</b> (bank.payment.export.line).
                                    </p>
                                    <ul>
                                        <li>
                                            <b>Group</b>
                                            : Used to group for looping within the same group.
                                        </li>
                                        <li>
                                            <b>Loop</b>
                                            : For looping to display according to the lines of bank.payment.export.line.
                                        </li>
                                        <li>
                                            <b>Sub Loop</b>
                                            : For cases where you want to nest loops, such as retrieving all invoices of that line.
                                        </li>
                                        <li>
                                            <b>Sub Value Loop</b>
                                            : The field needed for the sub loop (must be filled in when selecting Sub Loop).
                                        </li>
                                    </ul>
                                    <p>
                                        <b>Skipping Display</b>
                                        You can skip the display of a line if it doesn't meet the conditions set in the <b
                                        >Condition Line</b>.
                                    </p>
                                    <p>
                                        <b>Formatting</b>
                                        <ul>
                                            <li>
                                                <b>End Line</b>
                                                : If the line is the last line, it will use <code
                                                >/r/t</code> after put value.
                                            </li>
                                            <li>
                                                <b>Lenght</b>
                                                : The length of the displayed value. if <b
                                                >Value Type</b> is Fixed, <b
                                                >Value</b> will be throw error if it exceeds the specified length.
                                            </li>
                                            <li>
                                                <b>Alignment</b>
                                                : Aligning values to the left or right.
                                            </li>
                                            <li>
                                                <b>Blank Space</b>
                                                : Defining remaining space when the displayed value does not reach the specified length.
                                            </li>
                                            <li>
                                                <b>Value Type</b>
                                                : Fixed is used when the value is fixed, and Python is used when the value is dynamic.
                                            </li>
                                        </ul>
                                    </p>
                                </div>
                            </group>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>
    <record id="action_bank_export_format_template" model="ir.actions.act_window">
        <field name="name">Bank Export Format</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">bank.export.format</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                Click to create a Format Bank Export.
            </p>
        </field>
    </record>

    <!-- Menu -->
    <menuitem
        id="menu_bank_export_format"
        name="Bank Export Format"
        parent="base.menu_custom"
        sequence="90"
    />
    <menuitem
        id="menu_bank_export_format_template"
        parent="menu_bank_export_format"
        action="action_bank_export_format_template"
        sequence="10"
    />
</odoo>
