(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7544077b"],{"0534":function(e,n,t){"use strict";t("2e63")},"0673":function(e,n,t){"use strict";t("70c9")},"277a":function(e,n,t){"use strict";t.r(n);var i=function(){var e=this,n=e._self._c;return n("div",[n("el-breadcrumb",{attrs:{separator:"/"}},[n("el-breadcrumb-item",[e._v("AIGC专区")]),n("el-breadcrumb-item",[e._v("StableDiffusion文生图")])],1),n("el-card",[n("el-row",[n("el-col",{attrs:{span:12}},[n("div",[n("SdInfo",{attrs:{sd_info:e.sd_info},on:{getSdInfo:e.getSdInfo}}),"已初始化"===e.sd_info.state?n("div",[n("el-form",{ref:"form",attrs:{model:e.sd_reasonning,rules:e.rules}},[n("el-form-item",{attrs:{label:"正向提示词",prop:"prompt"}},[n("el-input",{attrs:{type:"textarea",placeholder:"用来引导SD模型生成图片的自然语言。建议使用单词+,拼接的方式。例：1girl,long hair,stand,dress"},model:{value:e.sd_reasonning.prompt,callback:function(n){e.$set(e.sd_reasonning,"prompt",n)},expression:"sd_reasonning.prompt"}})],1),n("el-form-item",{attrs:{label:"反向提示词",prop:"negative_prompt"}},[n("el-input",{attrs:{type:"textarea",placeholder:"用于引导SD模型不要在生成图片时使用的风格"},model:{value:e.sd_reasonning.negative_prompt,callback:function(n){e.$set(e.sd_reasonning,"negative_prompt",n)},expression:"sd_reasonning.negative_prompt"}})],1),n("el-form-item",{attrs:{label:"checkpoint"}},[n("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(n){return e.openFileSelect("checkpoint")}}},[e._v("选择文件")]),n("el-input",{attrs:{placeholder:"第三方checkpoint(全路径)"},model:{value:e.sd_reasonning.checkpoint,callback:function(n){e.$set(e.sd_reasonning,"checkpoint",n)},expression:"sd_reasonning.checkpoint"}})],1),n("el-form-item",{attrs:{label:"lora"}},[n("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(n){return e.openFileSelect("lora")}}},[e._v("选择文件")]),n("el-input",{attrs:{placeholder:"第三方lora(全路径)"},model:{value:e.sd_reasonning.lora,callback:function(n){e.$set(e.sd_reasonning,"lora",n)},expression:"sd_reasonning.lora"}})],1),n("el-form-item",[n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("种子")]),n("el-col",{attrs:{span:9}},[n("el-input-number",{model:{value:e.sd_reasonning.seed,callback:function(n){e.$set(e.sd_reasonning,"seed",n)},expression:"sd_reasonning.seed"}})],1),n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("采样方式")]),n("el-col",{attrs:{span:9}},[n("el-select",{model:{value:e.sd_reasonning.scheduler,callback:function(n){e.$set(e.sd_reasonning,"scheduler",n)},expression:"sd_reasonning.scheduler"}},[n("el-option",{attrs:{value:"Euler"}},[e._v("Euler")]),n("el-option",{attrs:{value:"DPM"}},[e._v("DPM")]),n("el-option",{attrs:{value:"LMS"}},[e._v("LMS")]),n("el-option",{attrs:{value:"PNDM"}},[e._v("PNDM")]),n("el-option",{attrs:{value:"DDIM"}},[e._v("DDIM")])],1)],1)],1),n("el-form-item",{attrs:{label:"",prop:"num_inference_steps"}},[n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("采样步数")]),n("el-col",{attrs:{span:9}},[n("el-input-number",{model:{value:e.sd_reasonning.num_inference_steps,callback:function(n){e.$set(e.sd_reasonning,"num_inference_steps",n)},expression:"sd_reasonning.num_inference_steps"}})],1),n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("图片张数")]),n("el-col",{attrs:{span:9}},[n("el-input-number",{model:{value:e.sd_reasonning.img_num,callback:function(n){e.$set(e.sd_reasonning,"img_num",n)},expression:"sd_reasonning.img_num"}})],1)],1),n("el-form-item",{attrs:{label:"",prop:"img_height"}},[n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("图片宽度")]),n("el-col",{attrs:{span:9}},[n("el-input-number",{model:{value:e.sd_reasonning.img_width,callback:function(n){e.$set(e.sd_reasonning,"img_width",n)},expression:"sd_reasonning.img_width"}})],1),n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("图片高度")]),n("el-col",{attrs:{span:9}},[n("el-input-number",{model:{value:e.sd_reasonning.img_height,callback:function(n){e.$set(e.sd_reasonning,"img_height",n)},expression:"sd_reasonning.img_height"}})],1)],1),n("el-form-item",[n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("引导系数")]),n("el-col",{attrs:{span:9}},[n("el-input-number",{attrs:{placeholder:"提示词引导系数"},model:{value:e.sd_reasonning.guidance_scale,callback:function(n){e.$set(e.sd_reasonning,"guidance_scale",n)},expression:"sd_reasonning.guidance_scale"}})],1),n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("lora系数")]),n("el-col",{attrs:{span:9}},[n("el-input-number",{attrs:{precision:2,step:.01,max:1,placeholder:"lora影响系数"},model:{value:e.sd_reasonning.lora_alpha,callback:function(n){e.$set(e.sd_reasonning,"lora_alpha",n)},expression:"sd_reasonning.lora_alpha"}})],1)],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(n){return e.onSubmit("form")}}},[e._v("提交")])],1)],1)],1):e._e()],1)]),n("el-col",{attrs:{span:12}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading_img,expression:"loading_img"}],staticClass:"image-area"},[0==e.generate_imgs.length?n("div",{staticStyle:{"line-height":"28px"}},[n("el-empty",{attrs:{description:"AIGC文生图"}})],1):e._e(),-1!==e.current_seed?n("div",{staticStyle:{"text-align":"center"}},[e._v(" 图片种子: "),n("el-tag",[e._v(e._s(e.current_seed))])],1):e._e(),e._l(e.generate_imgs,(function(t,i){return e.generate_imgs.length>0?n("div",{key:i,staticClass:"image-container"},[n("img",{staticClass:"gallery-image",attrs:{src:t},on:{click:function(n){return e.viewImage(t)}}}),n("div",[n("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(n){return e.saveImg(t)}}},[e._v("保存图片")])],1)]):e._e()}))],2)]),n("image-viewer",{ref:"imageViewerRef",attrs:{visible:e.viewerVisible},on:{"update:visible":function(n){e.viewerVisible=n}}})],1)],1)],1)},a=[],r=(t("b64b"),t("4989")),o=(t("ff51"),t("e700")),s=t("dd0c"),l={components:{ImageViewer:o["a"],SdInfo:s["a"]},data:function(){return{current_seed:-1,loading_img:!1,viewerVisible:!1,generate_imgs:[],sd_info:{state:"待初始化"},sd_reasonning:{prompt:"",negative_prompt:"",seed:-1,checkpoint:null,lora_alpha:.7,lora:null,scheduler:"Euler",num_inference_steps:30,guidance_scale:3,img_num:2,img_height:512,img_width:512},rules:{prompt:[{required:!0,message:"请输入正向提示词",trigger:"blur"}]}}},created:function(){this.getSdInfo()},methods:{openFileSelect:function(e){var n=this;return r["a"].openFileSelector().then((function(t){t&&t.length>0&&(n.sd_reasonning[e]=t[0])})).catch((function(e){n.$message.error(e)})),!1},getSdInfo:function(){var e=this;r["a"].getSdInfo().then((function(n){e.sd_info=JSON.parse(n)})).catch((function(n){e.$message.error(n)}))},onSubmit:function(e){var n=this;this.$refs[e].validate((function(e){if(e){if(n.sd_reasonning.img_width%8!==0)return n.$message.error("图片宽度必须为8的倍数"),!1;if(n.sd_reasonning.img_height%8!==0)return n.$message.error("图片高度必须为8的倍数"),!1;n.loading_img=!0,n.$message.success("开始生成图片"),r["a"].sdGeneratePic(n.sd_reasonning).then((function(e){n.loading_img=!1,n.generate_imgs=e.images,n.current_seed=e.seed})).catch((function(e){n.loading_img=!1,n.$message.error(e)}))}}))},saveImg:function(e){var n=this;r["a"].saveImages(e).then((function(e){"success"===e&&n.$message.success("保存成功")})).catch((function(e){n.$message.error(e)}))},viewImage:function(e){this.$refs.imageViewerRef.loadImage(e),this.viewerVisible=!0}}},c=l,u=(t("0534"),t("2877")),d=Object(u["a"])(c,i,a,!1,null,null,null);n["default"]=d.exports},"2ca0":function(e,n,t){"use strict";var i=t("23e7"),a=t("4625"),r=t("06cf").f,o=t("50c4"),s=t("577e"),l=t("5a34"),c=t("1d80"),u=t("ab13"),d=t("c430"),p=a("".slice),w=Math.min,f=u("startsWith"),_=!d&&!f&&!!function(){var e=r(String.prototype,"startsWith");return e&&!e.writable}();i({target:"String",proto:!0,forced:!_&&!f},{startsWith:function(e){var n=s(c(this));l(e);var t=o(w(arguments.length>1?arguments[1]:void 0,n.length)),i=s(e);return p(n,t,t+i.length)===i}})},"2e63":function(e,n,t){},"44e7":function(e,n,t){"use strict";var i=t("861d"),a=t("c6b6"),r=t("b622"),o=r("match");e.exports=function(e){var n;return i(e)&&(void 0!==(n=e[o])?!!n:"RegExp"===a(e))}},4989:function(e,n,t){"use strict";var i=t("c7eb"),a=t("1da1"),r=(t("0fb7"),t("450d"),t("f529")),o=t.n(r);t("d3b7"),t("ff51");n["a"]={showTips:function(){window.pywebview.api.show_tips().then((function(e){o.a.info(e)}))},getNav:function(){return window.pywebview.api.get_nav()},getSysInfo:function(){return window.pywebview.api.get_sys_info()},initEnv:function(){return window.pywebview.api.init_env()},modelList:function(e,n,t){return window.pywebview.api.model_list({page:e,limit:n,search:t})},createModel:function(e){return window.pywebview.api.create_model(e)},searchModelFile:function(e){return window.pywebview.api.search_model_file(e)},openFileSelector:function(){return window.pywebview.api.open_file_select()},createDownload:function(e){return window.pywebview.api.create_download(e)},createBatchDownload:function(e){return window.pywebview.api.create_batch_download(e)},getDownloadFiles:function(e){return window.pywebview.api.get_download_files(e)},delFile:function(e){return window.pywebview.api.delete_file_download(e)},delModel:function(e){return window.pywebview.api.delete_model(e)},importFile:function(e){return window.pywebview.api.import_file(e)},fileList:function(e){return window.pywebview.api.file_list(e)},getModel:function(e){return window.pywebview.api.get_model(e)},runModel:function(e){return window.pywebview.api.run_model(e)},listRunningModel:function(e){return window.pywebview.api.list_running_model(e)},stopRunningModel:function(e){return window.pywebview.api.stop_running_model(e)},listRunningModeHistory:function(e){return window.pywebview.api.list_running_model_history(e)},delRunningModel:function(e){return window.pywebview.api.del_running_model(e)},showTk:function(){return window.pywebview.api.show_tk()},splitMergeGguf:function(e){return window.pywebview.api.split_merge_gguf(e)},listSplitMerge:function(e){return window.pywebview.api.list_split_merge(e)},listQuantize:function(e){return window.pywebview.api.list_quantize(e)},listQuantizeParams:function(){return window.pywebview.api.list_quantize_params()},quantize:function(e){return window.pywebview.api.quantize(e)},convertHfToGguf:function(e){return window.pywebview.api.convert_hf_to_gguf(e)},listConvertModel:function(e){return window.pywebview.api.list_covert_model(e)},getSetting:function(){return window.pywebview.api.get_setting()},saveSetting:function(e){return window.pywebview.api.save_setting(e)},getLlamaCppConfig:function(){return window.pywebview.api.get_llama_cpp_config()},saveLlamaCppConfig:function(e){return window.pywebview.api.save_llama_cpp_config(e)},getLLamaServerInfo:function(){return window.pywebview.api.get_llama_server_info()},startLLamaServer:function(){return window.pywebview.api.start_llama_server()},stopLLamaServer:function(){return window.pywebview.api.stop_llama_server()},openFileInSysEdit:function(e){return window.pywebview.api.open_file_in_sys_edit(e)},train:function(e){return Object(a["a"])(Object(i["a"])().mark((function n(){return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,t){window.pywebview.api.train(e).then((function(e){n(e)})).catch((function(e){t(e)}))})));case 1:case"end":return n.stop()}}),n)})))()},getTrainList:function(e,n){return window.pywebview.api.get_train_list(e,n)},deleteTrainRecord:function(e){return window.pywebview.api.delete_train_record(e)},generateTrainCode:function(e){return window.pywebview.api.generate_train_code(e)},checkSshConnection:function(e,n,t,i){return window.pywebview.api.check_ssh_connection(e,n,t,i)},remoteTrain:function(e){return Object(a["a"])(Object(i["a"])().mark((function n(){return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,t){window.pywebview.api.remote_train(e).then((function(e){n(e)})).catch((function(e){t(e)}))})));case 1:case"end":return n.stop()}}),n)})))()},getLlamaFactoryInfo:function(){return window.pywebview.api.get_llamafactory_info()},installLlamaFactory:function(){return window.pywebview.api.install_llamafactory()},installLlamafactoryManual:function(){return window.pywebview.api.install_llamafactory_manual()},reloadInstallState:function(){return window.pywebview.api.reload_install_state()},isTraining:function(){return window.pywebview.api.is_training()},stopTrain:function(){return window.pywebview.api.stop_train()},getAiChatUrl:function(){return window.pywebview.api.get_ai_chat_url()},startLlamafactory:function(){return window.pywebview.api.start_lf_webui()},stopLlamafactory:function(){return window.pywebview.api.stop_lf_webui()},isLlamafactoryRunning:function(){return window.pywebview.api.is_lf_running()},getRecentServerInfo:function(){return window.pywebview.api.get_recent_server_info()},getSdInfo:function(){return window.pywebview.api.get_sd_info()},initSd:function(){return window.pywebview.api.init_sd()},sdGeneratePic:function(e){return window.pywebview.api.sd_generate_pic(e)},saveImages:function(e){return window.pywebview.api.save_image(e)},sdPicToPic:function(e){return window.pywebview.api.sd_pic_to_pic(e)}}},"5a34":function(e,n,t){"use strict";var i=t("44e7"),a=TypeError;e.exports=function(e){if(i(e))throw new a("The method doesn't accept regular expressions");return e}},"70c9":function(e,n,t){},7685:function(e,n,t){"use strict";t("8fc6")},"8fc6":function(e,n,t){},"99af":function(e,n,t){"use strict";var i=t("23e7"),a=t("d039"),r=t("e8b5"),o=t("861d"),s=t("7b0b"),l=t("07fa"),c=t("3511"),u=t("8418"),d=t("65f0"),p=t("1dde"),w=t("b622"),f=t("1212"),_=w("isConcatSpreadable"),g=f>=51||!a((function(){var e=[];return e[_]=!1,e.concat()[0]!==e})),m=function(e){if(!o(e))return!1;var n=e[_];return void 0!==n?!!n:r(e)},v=!g||!p("concat");i({target:"Array",proto:!0,arity:1,forced:v},{concat:function(e){var n,t,i,a,r,o=s(this),p=d(o,0),w=0;for(n=-1,i=arguments.length;n<i;n++)if(r=-1===n?o:arguments[n],m(r))for(a=l(r),c(w+a),t=0;t<a;t++,w++)t in r&&u(p,w,r[t]);else c(w+1),u(p,w++,r);return p.length=w,p}})},ab13:function(e,n,t){"use strict";var i=t("b622"),a=i("match");e.exports=function(e){var n=/./;try{"/./"[e](n)}catch(t){try{return n[a]=!1,"/./"[e](n)}catch(i){}}return!1}},b64b:function(e,n,t){"use strict";var i=t("23e7"),a=t("7b0b"),r=t("df75"),o=t("d039"),s=o((function(){r(1)}));i({target:"Object",stat:!0,forced:s},{keys:function(e){return r(a(e))}})},dd0c:function(e,n,t){"use strict";var i=function(){var e=this,n=e._self._c;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.sd_info_loading,expression:"sd_info_loading"}],staticClass:"sd-info"},[n("div",[e._v("SD环境状态： "),"已初始化"==e.sd_info.state?n("el-tag",{attrs:{type:"success"}},[e._v(e._s(e.sd_info.state))]):n("el-tag",{attrs:{type:"danger"}},[e._v(e._s(e.sd_info.state))])],1),n("div",[e._v("SD基础模型保存目录："),n("u",[e._v(e._s(e.sd_info.main_model_path))])]),n("div",[e._v("SD版本："),n("u",[e._v(e._s(e.sd_info.sd_version))])]),n("div",[e._v("常用AIGC社区：   "),n("el-link",{attrs:{type:"primary",href:"https://www.liblib.art/",target:"_blank"}},[e._v("liblib art")]),e._v("     "),n("el-link",{attrs:{type:"primary",href:"https://www.aigccn.cc/",target:"_blank"}},[e._v("AIGC社区")]),e._v("     "),n("el-link",{attrs:{type:"primary",href:"https://modelscope.cn/aigc/models",target:"_blank"}},[e._v("ModelScope AIGC")])],1),n("div",["待初始化"===e.sd_info.state?n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.initSd}},[e._v("初始化 ")]):e._e()],1)])},a=[],r=t("4989"),o={name:"SdInfo",props:{sd_info:{type:Object,required:!0,default:{}}},data:function(){return{sd_info_loading:!1}},watch:{},created:function(){},methods:{initSd:function(){var e=this;this.sd_info_loading=!0,r["a"].initSd().then((function(n){e.sd_info_loading=!1,e.$message.success("SD环境初始化完成"),e.$emit("getSdInfo")})).catch((function(n){e.sd_info_loading=!1,e.$message.error(n)}))}}},s=o,l=(t("0673"),t("2877")),c=Object(l["a"])(s,i,a,!1,null,"d8acde96",null);n["a"]=c.exports},e700:function(e,n,t){"use strict";t("99af");var i=function(){var e=this,n=e._self._c;return n("div",{staticClass:"image-viewer-container"},[n("el-dialog",{attrs:{visible:e.dialogVisible,title:"图片查看器",width:"80%","close-on-click-modal":!1},on:{"update:visible":function(n){e.dialogVisible=n},close:e.handleClose},scopedSlots:e._u([{key:"footer",fn:function(){return[n("span",{staticClass:"dialog-footer"},[n("el-button",{on:{click:function(n){e.dialogVisible=!1}}},[e._v("关闭")])],1)]},proxy:!0}])},[[e.imageUrl?n("div",{staticClass:"image-viewer-content"},[n("div",{staticClass:"image-viewer-toolbar"},[n("el-button",{attrs:{icon:"el-icon-zoom-in"},on:{click:e.zoomIn}},[e._v("放大")]),n("el-button",{attrs:{icon:"el-icon-zoom-out"},on:{click:e.zoomOut}},[e._v("缩小")]),n("el-button",{attrs:{icon:"el-icon-refresh-right"},on:{click:e.rotateRight}},[e._v("右转")]),n("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:e.rotateLeft}},[e._v("左转")]),n("el-button",{attrs:{icon:"el-icon-download"},on:{click:e.saveImg}},[e._v("保存")])],1),n("div",{ref:"imageWrapper",staticClass:"image-wrapper"},[n("img",{ref:"image",staticClass:"viewable-image",style:{transform:"scale(".concat(e.scale,") rotate(").concat(e.rotate,"deg)"),transition:"transform 0.3s"},attrs:{src:e.imageUrl},on:{load:e.onImageLoad}})])]):n("div",{staticClass:"loading-state"},[n("el-loading-spinner"),n("p",[e._v("等待图片数据...")])],1)]],2)],1)},a=[],r=(t("2ca0"),t("4989")),o={name:"ImageViewer",props:{visible:{type:Boolean,default:!1}},data:function(){return{dialogVisible:this.visible,imageUrl:"",scale:1,rotate:0,maxScale:3,minScale:.5,scaleStep:.1}},watch:{visible:function(e){this.dialogVisible=e,e||this.resetViewer()}},methods:{loadImage:function(e){e.startsWith("data:")?this.imageUrl=e:this.imageUrl="data:image/png;base64,".concat(e)},onImageLoad:function(){var e=this;this.scale=1,this.rotate=0,this.$nextTick((function(){e.adjustImageToContainer()}))},adjustImageToContainer:function(){var e=this.$refs.image,n=this.$refs.imageWrapper;if(e&&n)e.naturalWidth,e.naturalHeight,n.clientWidth,n.clientHeight},zoomIn:function(){this.scale<this.maxScale&&(this.scale+=this.scaleStep)},zoomOut:function(){this.scale>this.minScale&&(this.scale-=this.scaleStep)},rotateRight:function(){this.rotate+=90},rotateLeft:function(){this.rotate-=90},downloadImage:function(){if(this.imageUrl){var e=document.createElement("a");e.href=this.imageUrl,e.download="image_".concat((new Date).getTime(),".png"),document.body.appendChild(e),e.click(),document.body.removeChild(e)}},resetViewer:function(){this.imageUrl="",this.scale=1,this.rotate=0},handleClose:function(){this.resetViewer(),this.$emit("update:visible",!1)},saveImg:function(){var e=this;r["a"].saveImages(this.imageUrl).then((function(n){"success"===n&&e.$message.success("保存成功")})).catch((function(n){e.$message.error(n)}))}}},s=o,l=(t("7685"),t("2877")),c=Object(l["a"])(s,i,a,!1,null,"d2c7754a",null);n["a"]=c.exports}}]);
//# sourceMappingURL=chunk-7544077b.4cd01197.js.map