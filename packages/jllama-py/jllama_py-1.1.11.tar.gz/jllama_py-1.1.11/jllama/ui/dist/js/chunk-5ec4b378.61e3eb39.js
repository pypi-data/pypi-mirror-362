(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ec4b378"],{"1eac":function(e,n,t){},"4c3d":function(e,n,t){"use strict";t.r(n);var s=function(){var e=this,n=e._self._c;return n("div",[n("el-breadcrumb",{attrs:{separator:"/"}},[n("el-breadcrumb-item",[e._v("AIGC专区")]),n("el-breadcrumb-item",[e._v("StableDiffusion图生图")])],1),n("el-card",[n("el-row",[n("el-col",{attrs:{span:12}},[n("div",[n("SdInfo",{attrs:{sd_info:e.sd_info},on:{getSdInfo:e.getSdInfo}}),"已初始化"===e.sd_info.state?n("div",[n("el-form",{ref:"form",attrs:{model:e.sd_reasonning,rules:e.rules}},[n("el-form-item",{attrs:{label:"上传原图",prop:"input_img"}},[n("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{disabled:""},model:{value:e.sd_reasonning.input_img,callback:function(n){e.$set(e.sd_reasonning,"input_img",n)},expression:"sd_reasonning.input_img"}}),n("br"),n("el-upload",{attrs:{drag:"","list-type":"picture",multiple:!1,accept:"image/*","auto-upload":!0,"file-list":e.fileList,limit:1,"on-success":e.uploadSuccess,"before-upload":e.beforeUpload,"on-remove":e.fileRemove,"on-exceed":e.exceed,action:e.uploadUrl}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[e._v("将图片拖到此处，或"),n("em",[e._v("点击上传")])]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png等图片文件")])])],1),n("el-form-item",{attrs:{label:"正向提示词",prop:"prompt"}},[n("el-input",{attrs:{type:"textarea",placeholder:"用来引导SD模型生成图片的自然语言。建议使用单词+,拼接的方式。例：1girl,long hair,stand,dress"},model:{value:e.sd_reasonning.prompt,callback:function(n){e.$set(e.sd_reasonning,"prompt",n)},expression:"sd_reasonning.prompt"}})],1),n("el-form-item",{attrs:{label:"反向提示词",prop:"negative_prompt"}},[n("el-input",{attrs:{type:"textarea",placeholder:"用于引导SD模型不要在生成图片时使用的风格"},model:{value:e.sd_reasonning.negative_prompt,callback:function(n){e.$set(e.sd_reasonning,"negative_prompt",n)},expression:"sd_reasonning.negative_prompt"}})],1),n("el-form-item",{attrs:{label:"checkpoint"}},[n("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(n){return e.openFileSelect("checkpoint")}}},[e._v("选择文件")]),n("el-input",{attrs:{placeholder:"第三方checkpoint(全路径)"},model:{value:e.sd_reasonning.checkpoint,callback:function(n){e.$set(e.sd_reasonning,"checkpoint",n)},expression:"sd_reasonning.checkpoint"}})],1),n("el-form-item",{attrs:{label:"lora"}},[n("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(n){return e.openFileSelect("lora")}}},[e._v("选择文件")]),n("el-input",{attrs:{placeholder:"第三方lora(全路径)"},model:{value:e.sd_reasonning.lora,callback:function(n){e.$set(e.sd_reasonning,"lora",n)},expression:"sd_reasonning.lora"}})],1),n("el-form-item",[n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("种子")]),n("el-col",{attrs:{span:9}},[n("el-input-number",{model:{value:e.sd_reasonning.seed,callback:function(n){e.$set(e.sd_reasonning,"seed",n)},expression:"sd_reasonning.seed"}})],1),n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("采样方式")]),n("el-col",{attrs:{span:9}},[n("el-select",{model:{value:e.sd_reasonning.scheduler,callback:function(n){e.$set(e.sd_reasonning,"scheduler",n)},expression:"sd_reasonning.scheduler"}},[n("el-option",{attrs:{value:"Euler"}},[e._v("Euler")]),n("el-option",{attrs:{value:"DPM"}},[e._v("DPM")]),n("el-option",{attrs:{value:"LMS"}},[e._v("LMS")]),n("el-option",{attrs:{value:"PNDM"}},[e._v("PNDM")]),n("el-option",{attrs:{value:"DDIM"}},[e._v("DDIM")])],1)],1)],1),n("el-form-item",{attrs:{label:"",prop:"num_inference_steps"}},[n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("采样步数")]),n("el-col",{attrs:{span:9}},[n("el-input-number",{model:{value:e.sd_reasonning.num_inference_steps,callback:function(n){e.$set(e.sd_reasonning,"num_inference_steps",n)},expression:"sd_reasonning.num_inference_steps"}})],1),n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("图片张数")]),n("el-col",{attrs:{span:9}},[n("el-input-number",{model:{value:e.sd_reasonning.img_num,callback:function(n){e.$set(e.sd_reasonning,"img_num",n)},expression:"sd_reasonning.img_num"}})],1)],1),n("el-form-item",{attrs:{label:"",prop:"img_height"}},[n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("图片宽度")]),n("el-col",{attrs:{span:9}},[n("el-input-number",{model:{value:e.sd_reasonning.img_width,callback:function(n){e.$set(e.sd_reasonning,"img_width",n)},expression:"sd_reasonning.img_width"}})],1),n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("图片高度")]),n("el-col",{attrs:{span:9}},[n("el-input-number",{model:{value:e.sd_reasonning.img_height,callback:function(n){e.$set(e.sd_reasonning,"img_height",n)},expression:"sd_reasonning.img_height"}})],1)],1),n("el-form-item",[n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("引导系数")]),n("el-col",{attrs:{span:9}},[n("el-input-number",{attrs:{placeholder:"提示词引导系数"},model:{value:e.sd_reasonning.guidance_scale,callback:function(n){e.$set(e.sd_reasonning,"guidance_scale",n)},expression:"sd_reasonning.guidance_scale"}})],1),n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("lora系数")]),n("el-col",{attrs:{span:9}},[n("el-input-number",{attrs:{precision:2,step:.01,max:1,min:.01,placeholder:"lora影响系数"},model:{value:e.sd_reasonning.lora_alpha,callback:function(n){e.$set(e.sd_reasonning,"lora_alpha",n)},expression:"sd_reasonning.lora_alpha"}})],1)],1),n("el-form-item",[n("el-col",{staticClass:"line",attrs:{span:3}},[e._v("变化率")]),n("el-col",{attrs:{span:9}},[n("el-input-number",{attrs:{precision:2,step:.01,max:1,min:.01,placeholder:"图像变化程度"},model:{value:e.sd_reasonning.strength,callback:function(n){e.$set(e.sd_reasonning,"strength",n)},expression:"sd_reasonning.strength"}})],1)],1),"已初始化"===e.sd_info.ip_adapter_state?n("el-form-item",{attrs:{label:"IP-Adapter"}},[n("el-select",{model:{value:e.sd_reasonning.ip_adapter_model,callback:function(n){e.$set(e.sd_reasonning,"ip_adapter_model",n)},expression:"sd_reasonning.ip_adapter_model"}},e._l(e.ipAdapterModels,(function(e,t){return n("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1):e._e(),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(n){return e.onSubmit("form")}}},[e._v("提交")])],1)],1)],1):e._e()],1)]),n("el-col",{attrs:{span:12}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading_img,expression:"loading_img"}],staticClass:"image-area"},[0==e.generate_imgs.length?n("div",{staticStyle:{"line-height":"28px"}},[n("el-empty",{attrs:{description:"AIGC图生图"}})],1):e._e(),-1!==e.current_seed?n("div",{staticStyle:{"text-align":"center"}},[e._v(" 图片种子: "),n("el-tag",[e._v(e._s(e.current_seed))])],1):e._e(),e._l(e.generate_imgs,(function(t,s){return e.generate_imgs.length>0?n("div",{key:s,staticClass:"image-container"},[n("img",{staticClass:"gallery-image",attrs:{src:t},on:{click:function(n){return e.viewImage(t)}}}),n("div",[n("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(n){return e.saveImg(t)}}},[e._v("保存图片")])],1)]):e._e()}))],2)]),n("image-viewer",{ref:"imageViewerRef",attrs:{visible:e.viewerVisible},on:{"update:visible":function(n){e.viewerVisible=n}}})],1)],1)],1)},a=[],i=(t("b64b"),t("4989")),l=t("ff51"),r=t("e700"),o=t("dd0c"),c={components:{ImageViewer:r["a"],SdInfo:o["a"]},data:function(){return{ipAdapterModels:[],uploadUrl:"http://127.0.0.1:5000/upload",fileList:[],current_seed:-1,loading_img:!1,viewerVisible:!1,generate_imgs:[],sd_info:{state:"待初始化"},sd_reasonning:{input_img:"",prompt:"",negative_prompt:"",seed:-1,checkpoint:null,lora_alpha:.7,lora:null,scheduler:"Euler",num_inference_steps:30,guidance_scale:3,img_num:2,img_height:512,img_width:512,strength:.5},rules:{prompt:[{required:!0,message:"请输入正向提示词",trigger:"blur"}],input_img:[{required:!0,message:"请选择图片",trigger:"blur"}]}}},created:function(){this.getSdInfo(),this.getUploadUrl(),this.getIpAdapterModels()},methods:{openFileSelect:function(e){var n=this;return i["a"].openFileSelector().then((function(t){t&&t.length>0&&(n.sd_reasonning[e]=t[0])})).catch((function(e){n.$message.error(e)})),!1},getSdInfo:function(){var e=this;i["a"].getSdInfo().then((function(n){e.sd_info=JSON.parse(n),"已初始化"!==e.sd_info.state&&e.$message.error("检测到未初始化SD基础环境，请初始化后使用此功能")})).catch((function(n){e.$message.error(n)}))},onSubmit:function(e){var n=this;this.$refs[e].validate((function(e){e&&(n.loading_img=!0,n.$message.success("开始生成图片"),i["a"].sdPicToPic(n.sd_reasonning).then((function(e){n.loading_img=!1,n.generate_imgs=e.images,n.current_seed=e.seed})).catch((function(e){n.loading_img=!1,n.$message.error(e)})))}))},saveImg:function(e){var n=this;i["a"].saveImages(e).then((function(e){"success"===e&&n.$message.success("保存成功")})).catch((function(e){n.$message.error(e)}))},viewImage:function(e){this.$refs.imageViewerRef.loadImage(e),this.viewerVisible=!0},uploadSuccess:function(e,n,t){this.sd_reasonning.input_img=e.file_path,this.sd_reasonning.img_width=Object(l["a"])(e.width),this.sd_reasonning.img_height=Object(l["a"])(e.height),this.fileList=t},beforeUpload:function(e){},fileRemove:function(e,n){},exceed:function(e,n){this.$message.warning("一次只能处理一张图")},getUploadUrl:function(){var e=this.$store.state.sysInfo.base_url;e?this.uploadUrl=e+"/upload":console.log("未从store找到base_url,将使用默认http://127.0.0.1:5000/upload")},getIpAdapterModels:function(){var e=this;i["a"].getIpAdapterModels().then((function(n){e.ipAdapterModels=n})).catch((function(n){e.$message.error(n)}))}}},d=c,p=(t("6c8f"),t("2877")),u=Object(p["a"])(d,s,a,!1,null,null,null);n["default"]=u.exports},"6c8f":function(e,n,t){"use strict";t("1eac")}}]);
//# sourceMappingURL=chunk-5ec4b378.61e3eb39.js.map