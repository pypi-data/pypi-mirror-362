(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e75313f"],{"129f":function(e,t,n){"use strict";e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}},"16db":function(e,t,n){},"309a":function(e,t,n){"use strict";n("16db")},4989:function(e,t,n){"use strict";var i=n("c7eb"),o=n("1da1"),r=(n("0fb7"),n("450d"),n("f529")),a=n.n(r);n("d3b7"),n("ff51");t["a"]={showTips:function(){window.pywebview.api.show_tips().then((function(e){a.a.info(e)}))},getNav:function(){return window.pywebview.api.get_nav()},getSysInfo:function(){return window.pywebview.api.get_sys_info()},initEnv:function(){return window.pywebview.api.init_env()},modelList:function(e,t,n){return window.pywebview.api.model_list({page:e,limit:t,search:n})},createModel:function(e){return window.pywebview.api.create_model(e)},searchModelFile:function(e){return window.pywebview.api.search_model_file(e)},openFileSelector:function(){return window.pywebview.api.open_file_select()},createDownload:function(e){return window.pywebview.api.create_download(e)},createBatchDownload:function(e){return window.pywebview.api.create_batch_download(e)},getDownloadFiles:function(e){return window.pywebview.api.get_download_files(e)},delFile:function(e){return window.pywebview.api.delete_file_download(e)},delModel:function(e){return window.pywebview.api.delete_model(e)},importFile:function(e){return window.pywebview.api.import_file(e)},fileList:function(e){return window.pywebview.api.file_list(e)},getModel:function(e){return window.pywebview.api.get_model(e)},runModel:function(e){return window.pywebview.api.run_model(e)},listRunningModel:function(e){return window.pywebview.api.list_running_model(e)},stopRunningModel:function(e){return window.pywebview.api.stop_running_model(e)},listRunningModeHistory:function(e){return window.pywebview.api.list_running_model_history(e)},delRunningModel:function(e){return window.pywebview.api.del_running_model(e)},showTk:function(){return window.pywebview.api.show_tk()},splitMergeGguf:function(e){return window.pywebview.api.split_merge_gguf(e)},listSplitMerge:function(e){return window.pywebview.api.list_split_merge(e)},listQuantize:function(e){return window.pywebview.api.list_quantize(e)},listQuantizeParams:function(){return window.pywebview.api.list_quantize_params()},quantize:function(e){return window.pywebview.api.quantize(e)},convertHfToGguf:function(e){return window.pywebview.api.convert_hf_to_gguf(e)},listConvertModel:function(e){return window.pywebview.api.list_covert_model(e)},getSetting:function(){return window.pywebview.api.get_setting()},saveSetting:function(e){return window.pywebview.api.save_setting(e)},getLlamaCppConfig:function(){return window.pywebview.api.get_llama_cpp_config()},saveLlamaCppConfig:function(e){return window.pywebview.api.save_llama_cpp_config(e)},getLLamaServerInfo:function(){return window.pywebview.api.get_llama_server_info()},startLLamaServer:function(){return window.pywebview.api.start_llama_server()},stopLLamaServer:function(){return window.pywebview.api.stop_llama_server()},openFileInSysEdit:function(e){return window.pywebview.api.open_file_in_sys_edit(e)},train:function(e){return Object(o["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){window.pywebview.api.train(e).then((function(e){t(e)})).catch((function(e){n(e)}))})));case 1:case"end":return t.stop()}}),t)})))()},getTrainList:function(e,t){return window.pywebview.api.get_train_list(e,t)},deleteTrainRecord:function(e){return window.pywebview.api.delete_train_record(e)},generateTrainCode:function(e){return window.pywebview.api.generate_train_code(e)},checkSshConnection:function(e,t,n,i){return window.pywebview.api.check_ssh_connection(e,t,n,i)},remoteTrain:function(e){return Object(o["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){window.pywebview.api.remote_train(e).then((function(e){t(e)})).catch((function(e){n(e)}))})));case 1:case"end":return t.stop()}}),t)})))()},getLlamaFactoryInfo:function(){return window.pywebview.api.get_llamafactory_info()},installLlamaFactory:function(){return window.pywebview.api.install_llamafactory()},installLlamafactoryManual:function(){return window.pywebview.api.install_llamafactory_manual()},reloadInstallState:function(){return window.pywebview.api.reload_install_state()},isTraining:function(){return window.pywebview.api.is_training()},stopTrain:function(){return window.pywebview.api.stop_train()},getAiChatUrl:function(){return window.pywebview.api.get_ai_chat_url()},startLlamafactory:function(){return window.pywebview.api.start_lf_webui()},stopLlamafactory:function(){return window.pywebview.api.stop_lf_webui()},isLlamafactoryRunning:function(){return window.pywebview.api.is_lf_running()},getRecentServerInfo:function(){return window.pywebview.api.get_recent_server_info()},getSdInfo:function(){return window.pywebview.api.get_sd_info()},initSd:function(){return window.pywebview.api.init_sd()},sdGeneratePic:function(e){return window.pywebview.api.sd_generate_pic(e)},saveImages:function(e){return window.pywebview.api.save_image(e)},sdPicToPic:function(e){return window.pywebview.api.sd_pic_to_pic(e)},initIpAdapter:function(){return window.pywebview.api.init_ip_adapter()},initIpAdapterFaceid:function(){return window.pywebview.api.init_ip_adapter_faceid()},getIpAdapterModels:function(){return window.pywebview.api.get_ip_adapter_models()},sdIpAdapterFaceid:function(e){return window.pywebview.api.sd_ip_adapter_faceid(e)}}},"76b7":function(e,t,n){"use strict";n.r(t);n("b0c0"),n("ac1f"),n("841c");var i=function(){var e=this,t=e._self._c;return t("div",[t("el-breadcrumb",{attrs:{separator:"/"}},[t("el-breadcrumb-item",[e._v("AI推理")]),t("el-breadcrumb-item",[e._v("模型推理")])],1),t("el-card",[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[t("el-form-item",{attrs:{label:"搜索"}},[t("el-input",{attrs:{placeholder:"搜索运行中的模型"},model:{value:e.formInline.search,callback:function(t){e.$set(e.formInline,"search",t)},expression:"formInline.search"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.getTableData}},[e._v("查询")]),t("el-button",{attrs:{type:"success"},on:{click:e.addNew}},[e._v("运行")])],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[t("el-table-column",{attrs:{prop:"model_name",label:"模型名称"}}),t("el-table-column",{attrs:{width:"70",prop:"model_type",label:"类型"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-tag",{attrs:{type:"gguf"===n.row.model_type?"primary":"success","disable-transitions":""}},[e._v(e._s(n.row.model_type)+" ")])]}}])}),t("el-table-column",{attrs:{prop:"file_path",label:"文件路径"}}),t("el-table-column",{attrs:{prop:"reasoning_args",label:"运行参数"}}),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.chat(n.row,n.$index)}}},[e._v("chat")]),t("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.stop(n.row,n.$index)}}},[e._v("停止")])]}}])})],1),t("div",{staticClass:"block"},[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),t("el-dialog",{attrs:{title:"创建服务进程",visible:e.showDialog,"close-on-press-escape":!1,"close-on-click-modal":!1,"destroy-on-close":!0,width:"800px"},on:{"update:visible":function(t){e.showDialog=t},close:e.resetDialog}},[t("el-form",{ref:"modelForm",attrs:{model:e.modelForm,rules:e.rules}},[t("el-form-item",{attrs:{label:"模型","label-width":"120px",prop:"modelId"}},[t("el-select",{attrs:{placeholder:"模型"},on:{change:e.modelChange},model:{value:e.modelForm.modelId,callback:function(t){e.$set(e.modelForm,"modelId",t)},expression:"modelForm.modelId"}},e._l(e.modelList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),"gguf"===e.selectedModel.type?t("el-form-item",{attrs:{label:"文件名","label-width":"120px",prop:"fileId"}},[t("el-select",{attrs:{placeholder:"文件名"},model:{value:e.modelForm.fileId,callback:function(t){e.$set(e.modelForm,"fileId",t)},expression:"modelForm.fileId"}},e._l(e.fileList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.file_name,value:e.id}})})),1)],1):e._e(),"gguf"===e.selectedModel.type?t("el-form-item",{attrs:{label:"-ngl","label-width":"120px",prop:"ngl"}},[t("el-input",{attrs:{type:"number",placeholder:"存储在 VRAM 中的层数,通常数值越大性能越好,但是过大也会导致显存不足","show-word-limit":""},model:{value:e.modelForm.ngl,callback:function(t){e.$set(e.modelForm,"ngl",t)},expression:"modelForm.ngl"}})],1):e._e(),"gguf"===e.selectedModel.type?t("el-form-item",{attrs:{label:"threads","label-width":"120px",prop:"threads"}},[t("el-input",{attrs:{type:"number",placeholder:"生成期间使用的线程数（默认值：-1）","show-word-limit":""},model:{value:e.modelForm.threads,callback:function(t){e.$set(e.modelForm,"threads",t)},expression:"modelForm.threads"}})],1):e._e(),t("el-form-item",{attrs:{label:"ctxSize","label-width":"120px",prop:"ctxSize"}},[t("el-input",{attrs:{type:"number",placeholder:"提示上下文的大小","show-word-limit":""},model:{value:e.modelForm.ctxSize,callback:function(t){e.$set(e.modelForm,"ctxSize",t)},expression:"modelForm.ctxSize"}})],1),"gguf"===e.selectedModel.type?t("el-form-item",{attrs:{label:"其他参数","label-width":"120px",prop:"args"}},[t("el-input",{attrs:{type:"textarea",placeholder:"其他llama.cpp参数"},model:{value:e.modelForm.args,callback:function(t){e.$set(e.modelForm,"args",t)},expression:"modelForm.args"}})],1):e._e(),t("el-form-item",{attrs:{label:"temperature","label-width":"120px",prop:"temperature"}},[t("el-input",{attrs:{placeholder:"请输入0.0-1.0之间的小数",clearable:""},model:{value:e.modelForm.temperature,callback:function(t){e.$set(e.modelForm,"temperature",t)},expression:"modelForm.temperature"}})],1),t("el-form-item",{attrs:{label:"top_k","label-width":"120px",prop:"top_k"}},[t("el-input",{attrs:{placeholder:"请输入0.0-1.0之间的小数",clearable:""},model:{value:e.modelForm.top_k,callback:function(t){e.$set(e.modelForm,"top_k",t)},expression:"modelForm.top_k"}})],1),t("el-form-item",{attrs:{label:"top_p","label-width":"120px",prop:"top_p"}},[t("el-input",{attrs:{placeholder:"请输入0.0-1.0之间的小数",clearable:""},model:{value:e.modelForm.top_p,callback:function(t){e.$set(e.modelForm,"top_p",t)},expression:"modelForm.top_p"}})],1),t("el-form-item",{attrs:{label:"记忆轮次","label-width":"120px",prop:"memory"}},[t("el-input-number",{attrs:{placeholder:"保存上下文记忆的轮次"},model:{value:e.modelForm.memory,callback:function(t){e.$set(e.modelForm,"memory",t)},expression:"modelForm.memory"}})],1),"hf"===e.selectedModel.type?t("el-form-item",{attrs:{label:"torch_dtype","label-width":"120px",prop:"torch_dtype"}},[t("el-select",{attrs:{placeholder:"模型数据类型"},model:{value:e.modelForm.torch_dtype,callback:function(t){e.$set(e.modelForm,"torch_dtype",t)},expression:"modelForm.torch_dtype"}},[t("el-option",{attrs:{value:"auto"}},[e._v("auto")]),t("el-option",{attrs:{value:"bfloat16"}},[e._v("bfloat16")]),t("el-option",{attrs:{value:"float32"}},[e._v("float32")]),t("el-option",{attrs:{value:"float16"}},[e._v("float16")]),t("el-option",{attrs:{value:"int16"}},[e._v("int16")]),t("el-option",{attrs:{value:"int8"}},[e._v("int8")])],1)],1):e._e(),t("el-form-item",{attrs:{label:"流式输出","label-width":"120px",prop:"stream"}},[t("el-switch",{model:{value:e.modelForm.stream,callback:function(t){e.$set(e.modelForm,"stream",t)},expression:"modelForm.stream"}}),t("i",{staticStyle:{color:"#909399"}},[e._v(" 大模型流式输出即文本逐字实时生成显示，如果不开启则需要等待模型完成推理后才能响应")])],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.exec("modelForm")}}},[e._v("确 定")])],1)],1)],1)},o=[],r=n("c7eb"),a=n("1da1"),l=(n("14d9"),n("b64b"),n("ff51")),s=n("4989"),c={name:"watch",data:function(){return{showDialog:!1,modelForm:{modelId:"",fileId:"",ngl:99,threads:-1,ctxSize:4096,temperature:.8,top_p:.9,top_k:40,memory:5,stream:!0,torch_dtype:"auto"},selectedModel:{},modelList:[],fileList:[],rules:{modelId:[{required:!0,message:"请输入模型名称",trigger:"blur"}],stream:[{required:!0,message:"请确认是否开启流式输出",trigger:"blur"}],temperature:[{pattern:/^(0(\.\d+)?|1(\.0+)?)$/,message:"请输入0.1-1.0之间的小数",trigger:"blur"}],top_k:[{pattern:/[1-9]\d*/,message:"请输入数字",trigger:"blur"}],top_p:[{pattern:/^(0(\.\d+)?|1(\.0+)?)$/,message:"请输入0.1-1.0之间的小数",trigger:"blur"}]},formInline:{search:""},tableData:[],currentPage:1,pageSize:10,total:0,pageSizes:[10,20,50]}},created:function(){this.getModelList(),this.getTableData()},methods:{handleSizeChange:function(e){this.pageSize=e,this.getTableData()},handleCurrentChange:function(e){this.currentPage=e,this.getTableData()},chat:function(e,t){this.$router.push({path:"/ai/chat",query:{modelId:e.model_id,modelName:e.model_name,modelType:e.model_type,reasoningArgs:e.reasoning_args}})},stop:function(e,t){var n=this;s["a"].stopRunningModel(e.id).then((function(t){"success"===t&&n.$message.success(e.model_name+"已停止"),n.getTableData()})).catch((function(e){n.$message.error(e)}))},modelChange:function(e){var t=this;return Object(a["a"])(Object(r["a"])().mark((function n(){return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.getModel(e);case 2:"gguf"===t.selectedModel.type&&t.getFileList(e);case 3:case"end":return n.stop()}}),n)})))()},resetDialog:function(){this.showDialog=!1,this.modelForm={modelId:"",fileId:"",ngl:99,threads:-1,ctxSize:4096,temperature:"0.8",top_p:.9,top_k:40,memory:5,stream:!0},this.selectedModel={},this.getTableData()},addNew:function(){this.showDialog=!0},exec:function(e){var t=this;this.$refs[e].validate((function(e){if(e){if("gguf"===t.selectedModel.type&&(!t.modelForm.fileId||0==t.modelForm.fileId.length))return t.$message.error("gguf模型需要选择模型文件"),!1;var n=Object(l["e"])();s["a"].runModel(t.modelForm).then((function(e){Object(l["b"])(n),e&&(t.$message.success("运行成功"),t.showDialog=!1)})).catch((function(e){Object(l["b"])(n),t.$message.error(e)}))}}))},getTableData:function(){var e=this,t=Object(l["e"])();s["a"].listRunningModel({page:this.currentPage,limit:this.pageSize,search:this.formInline.search}).then((function(n){Object(l["b"])(t);var i=JSON.parse(n);e.tableData=i.record,e.total=i.total})).catch((function(n){Object(l["b"])(t),e.$message.error(n)}))},getModel:function(e){var t=this;return Object(a["a"])(Object(r["a"])().mark((function n(){return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,s["a"].getModel(e).then((function(e){t.selectedModel=JSON.parse(e)})).catch((function(e){t.$message.error(e)}));case 2:case"end":return n.stop()}}),n)})))()},getModelList:function(){var e=this;s["a"].modelList(1,9999).then((function(t){var n=JSON.parse(t);e.modelList=n.record})).catch((function(t){e.$message.error(t)}))},getFileList:function(e){var t=this;s["a"].fileList({modelId:e,ggufOnly:!0}).then((function(e){t.fileList=JSON.parse(e)})).catch((function(e){t.$message.error(e)}))}}},d=c,p=(n("309a"),n("2877")),u=Object(p["a"])(d,i,o,!1,null,null,null);t["default"]=u.exports},"841c":function(e,t,n){"use strict";var i=n("c65b"),o=n("d784"),r=n("825a"),a=n("7234"),l=n("1d80"),s=n("129f"),c=n("577e"),d=n("dc4a"),p=n("14c3");o("search",(function(e,t,n){return[function(t){var n=l(this),o=a(t)?void 0:d(t,e);return o?i(o,t,n):new RegExp(t)[e](c(n))},function(e){var i=r(this),o=c(e),a=n(t,i,o);if(a.done)return a.value;var l=i.lastIndex;s(l,0)||(i.lastIndex=0);var d=p(i,o);return s(i.lastIndex,l)||(i.lastIndex=l),null===d?-1:d.index}]}))},b64b:function(e,t,n){"use strict";var i=n("23e7"),o=n("7b0b"),r=n("df75"),a=n("d039"),l=a((function(){r(1)}));i({target:"Object",stat:!0,forced:l},{keys:function(e){return r(o(e))}})}}]);
//# sourceMappingURL=chunk-6e75313f.fd65c60c.js.map