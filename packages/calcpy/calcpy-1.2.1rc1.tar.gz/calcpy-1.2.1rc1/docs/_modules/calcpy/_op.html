<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>calcpy._op &#8212; calcpy  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=362ab14a" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css?v=0f882399" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../index.html">calcpy  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">calcpy._op</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for calcpy._op</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Extension of Python operators and functions.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span> <span class="k">as</span> <span class="n">shallowcopy</span><span class="p">,</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">operator</span>

<span class="kn">from</span> <span class="nn">.matcher</span> <span class="kn">import</span> <span class="n">_get_matcher</span>
<span class="kn">from</span> <span class="nn">._arg</span> <span class="kn">import</span> <span class="n">RAISE</span><span class="p">,</span> <span class="n">SELF</span>
<span class="kn">from</span> <span class="nn">._it</span> <span class="kn">import</span> <span class="n">pairwise</span>
<span class="kn">from</span> <span class="nn">._seq</span> <span class="kn">import</span> <span class="n">count_unique</span>


<span class="k">def</span> <span class="nf">_check_attr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auxiliary function for attrchecker.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">attr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>


<div class="viewcode-block" id="attrchecker">
<a class="viewcode-back" href="../../builtin.html#calcpy.attrchecker">[docs]</a>
<span class="k">def</span> <span class="nf">attrchecker</span><span class="p">(</span><span class="o">*</span><span class="n">attrs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a callable object to check the existence of the given attribute(s).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; c = attrchecker(&quot;mro&quot;, &quot;type&quot;)</span>
<span class="sd">        &gt;&gt;&gt; c(type)</span>
<span class="sd">        (True, False)</span>

<span class="sd">        &gt;&gt;&gt; import os</span>
<span class="sd">        &gt;&gt;&gt; c = attrchecker(&quot;path&quot;, &quot;path.sep&quot;, &quot;sep.path&quot;)</span>
<span class="sd">        &gt;&gt;&gt; c(os)</span>
<span class="sd">        (True, True, False)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">c</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">_check_attr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="k">def</span> <span class="nf">c</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">_check_attr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c</span></div>



<span class="k">def</span> <span class="nf">_resolve_attr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">default</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auxiliary function for attrgetter.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">attr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">RAISE</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;type object &#39;</span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; has no attribute &#39;</span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">SELF</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">attr</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">default</span>
    <span class="k">return</span> <span class="n">obj</span>


<div class="viewcode-block" id="attrgetter">
<a class="viewcode-back" href="../../builtin.html#calcpy.attrgetter">[docs]</a>
<span class="k">def</span> <span class="nf">attrgetter</span><span class="p">(</span><span class="o">*</span><span class="n">attrs</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">RAISE</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a callable object that fetches the given attribute(s) from its operand.</span>

<span class="sd">    Fully compatible with Python&#39;s built-in ``operator.attrgetter``,</span>
<span class="sd">    and furthermore support an optional default value when a named attr is not found.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Get attributes with default values.</span>

<span class="sd">        &gt;&gt;&gt; from collections import namedtuple</span>
<span class="sd">        &gt;&gt;&gt; name = namedtuple(&#39;Name&#39;, [&#39;first&#39;, &#39;last&#39;])</span>
<span class="sd">        &gt;&gt;&gt; name.first = &#39;Zhiqing&#39;</span>
<span class="sd">        &gt;&gt;&gt; name.last = &#39;Xiao&#39;</span>
<span class="sd">        &gt;&gt;&gt; person = namedtuple(&#39;Person&#39;, [&#39;name&#39;, &#39;city&#39;])</span>
<span class="sd">        &gt;&gt;&gt; person.name = name</span>
<span class="sd">        &gt;&gt;&gt; person.city = &#39;Beijing&#39;</span>
<span class="sd">        &gt;&gt;&gt; g = attrgetter(&#39;name.first&#39;, &#39;name.middle&#39;, &#39;name.last&#39;, default=&#39;&#39;)</span>
<span class="sd">        &gt;&gt;&gt; g(person)</span>
<span class="sd">        (&#39;Zhiqing&#39;, &#39;&#39;, &#39;Xiao&#39;)</span>
<span class="sd">        &gt;&gt;&gt; g = attrgetter(&#39;name.first&#39;, &#39;city&#39;)</span>
<span class="sd">        &gt;&gt;&gt; g(person)</span>
<span class="sd">        (&#39;Zhiqing&#39;, &#39;Beijing&#39;)</span>

<span class="sd">        It will raise errors when the default is not set.</span>

<span class="sd">        &gt;&gt;&gt; g = attrgetter(&#39;hello&#39;)</span>
<span class="sd">        &gt;&gt;&gt; g(sum)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        AttributeError: type object &#39;builtin_function_or_method&#39; has no attribute &#39;hello&#39;</span>

<span class="sd">    See also:</span>
<span class="sd">        https://docs.python.org/3/library/operator.html#operator.attrgetter</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">_resolve_attr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">_resolve_attr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">g</span></div>



<span class="k">def</span> <span class="nf">_resolve_item</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">default</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auxiliary function for itemgetter.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">item</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">RAISE</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">err</span>
            <span class="k">elif</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">SELF</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">item</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">default</span>
    <span class="k">return</span> <span class="n">obj</span>


<div class="viewcode-block" id="itemgetter">
<a class="viewcode-back" href="../../builtin.html#calcpy.itemgetter">[docs]</a>
<span class="k">def</span> <span class="nf">itemgetter</span><span class="p">(</span><span class="o">*</span><span class="n">items</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">RAISE</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a callable object that fetches the given item(s) from its operand.</span>

<span class="sd">    Fully compatible with Python&#39;s builtin ``operator.itemgetter``,</span>
<span class="sd">    and furthermore support multi-level item and an optional default value when a item is not found.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Get multiple items with default values.</span>

<span class="sd">        &gt;&gt;&gt; person = {&#39;name&#39;: {&#39;first&#39;: &#39;Zhiqing&#39;, &#39;last&#39;: &#39;Xiao&#39;}, &#39;city&#39;: &#39;Beijing&#39;}</span>
<span class="sd">        &gt;&gt;&gt; g = itemgetter([&#39;name&#39;, &#39;first&#39;], [&#39;name&#39;, &#39;middle&#39;], [&#39;name&#39;, &#39;last&#39;], &#39;city&#39;, default=&#39;&#39;)</span>
<span class="sd">        &gt;&gt;&gt; g(person)</span>
<span class="sd">        (&#39;Zhiqing&#39;, &#39;&#39;, &#39;Xiao&#39;, &#39;Beijing&#39;)</span>
<span class="sd">        &gt;&gt;&gt; itemgetter(4, default=0)([1, 2, 3])</span>
<span class="sd">        0</span>

<span class="sd">        It will raise errors when the default is not set.</span>
<span class="sd">        &gt;&gt;&gt; itemgetter(4)([1, 2, 3])</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        IndexError: list index out of range</span>

<span class="sd">    See also:</span>
<span class="sd">        https://docs.python.org/3/library/operator.html#operator.itemgetter</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">_resolve_item</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">_resolve_item</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">g</span></div>



<span class="k">def</span> <span class="nf">_check_item</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auxiliary function for itemchecker.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">item</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>


<div class="viewcode-block" id="itemchecker">
<a class="viewcode-back" href="../../builtin.html#calcpy.itemchecker">[docs]</a>
<span class="k">def</span> <span class="nf">itemchecker</span><span class="p">(</span><span class="o">*</span><span class="n">items</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a callable object to check the existence of the given item(s).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; data = {&quot;name&quot;: {&quot;first&quot;: &quot;Zhiqing&quot;, &quot;last&quot;: &quot;Xiao&quot;}, &quot;city&quot;: &quot;Beijing&quot;}</span>
<span class="sd">        &gt;&gt;&gt; c = itemchecker([&quot;name&quot;, &quot;first&quot;], [&quot;name&quot;, &quot;middle&quot;], [&quot;name&quot;, &quot;last&quot;], &quot;city&quot;, &quot;sex&quot;)</span>
<span class="sd">        &gt;&gt;&gt; c(data)</span>
<span class="sd">        (True, False, True, True, False)</span>

<span class="sd">        &gt;&gt;&gt; itemchecker(-3, 0, 3)([1, 2, 3])</span>
<span class="sd">        (True, True, False)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">c</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">_check_item</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="k">def</span> <span class="nf">c</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">_check_item</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c</span></div>



<div class="viewcode-block" id="methodcaller">
<a class="viewcode-back" href="../../builtin.html#calcpy.methodcaller">[docs]</a>
<span class="k">def</span> <span class="nf">methodcaller</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;methodcaller</span>

<span class="sd">    Fully compatible with Python&#39;s built-in ``operator.methodcaller``.</span>

<span class="sd">    Support ``pandas`` accessor.</span>

<span class="sd">    Can be decorated by ``calcpy.fillerr`` when needed to resolve the case where method name is not found.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; s = pd.Series([&quot;a&quot;, &quot;b&quot;])</span>
<span class="sd">        &gt;&gt;&gt; methodcaller(&quot;str.upper&quot;)(s)</span>
<span class="sd">        0    A</span>
<span class="sd">        1    B</span>
<span class="sd">        dtype: object</span>

<span class="sd">    See also:</span>
<span class="sd">        https://docs.python.org/3/library/operator.html#operator.methodcaller</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">caller</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="o">*</span><span class="n">args_</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">attrgetter</span><span class="p">(</span><span class="n">name</span><span class="p">)(</span><span class="n">obj</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="n">args_</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">caller</span></div>



<div class="viewcode-block" id="argchecker">
<a class="viewcode-back" href="../../builtin.html#calcpy.argchecker">[docs]</a>
<span class="k">def</span> <span class="nf">argchecker</span><span class="p">(</span><span class="o">*</span><span class="n">keys</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a callable object to check the existences of argument(s).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        *keys (int | str):</span>
<span class="sd">            If it is an ``int`` (can be negative), it is the index of the positional argument to be fetched.</span>
<span class="sd">            If it is a ``str``, it is the name of keyword argument to be fetched.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool | tuple[bool]:</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; getter = argchecker(-1, 0, 1, 5, &quot;key&quot;, &quot;other&quot;)</span>
<span class="sd">        &gt;&gt;&gt; getter(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, key=&quot;value&quot;)</span>
<span class="sd">        (True, True, True, False, True, False)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">checker</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">count</span> <span class="o">&lt;=</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="n">count</span><span class="p">)</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># If only one result, return it directly</span>
            <span class="k">return</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">checker</span></div>



<div class="viewcode-block" id="arggetter">
<a class="viewcode-back" href="../../builtin.html#calcpy.arggetter">[docs]</a>
<span class="k">def</span> <span class="nf">arggetter</span><span class="p">(</span><span class="o">*</span><span class="n">keys</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">RAISE</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a callable object that fetches the argument(s) from its operand.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        *keys (int | str):</span>
<span class="sd">            If it is an ``int`` (can be negative), it is the index of the positional argument to be fetched.</span>
<span class="sd">            If it is a ``str``, it is the name of keyword argument to be fetched.</span>
<span class="sd">        default: Default value to return when the argument is not found.</span>

<span class="sd">    Returns:</span>
<span class="sd">        callable:</span>

<span class="sd">    Raises:</span>
<span class="sd">        IndexError: Raises when the argument is not found and the default is not set.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Get the first positional argument.</span>

<span class="sd">        &gt;&gt;&gt; getter = arggetter(0)</span>
<span class="sd">        &gt;&gt;&gt; getter(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, key=&quot;value&quot;)</span>
<span class="sd">        &#39;a&#39;</span>

<span class="sd">        Get the positional arguments and keyword arguments.</span>

<span class="sd">        &gt;&gt;&gt; getter = arggetter(-1, 0, 1, &quot;key&quot;, default=&quot;default&quot;)</span>
<span class="sd">        &gt;&gt;&gt; getter(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, key=&quot;value&quot;)</span>
<span class="sd">        (&#39;c&#39;, &#39;a&#39;, &#39;b&#39;, &#39;value&#39;)</span>

<span class="sd">        Get the positional arguments and keyword arguments with default values.</span>

<span class="sd">        &gt;&gt;&gt; getter = arggetter(-1, 0, 1, 5, &quot;key&quot;, &quot;other&quot;, default=&quot;default&quot;)</span>
<span class="sd">        &gt;&gt;&gt; getter(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, key=&quot;value&quot;)</span>
<span class="sd">        (&#39;c&#39;, &#39;a&#39;, &#39;b&#39;, &#39;default&#39;, &#39;value&#39;, &#39;default&#39;)</span>

<span class="sd">        Raise an error if the index is out of range and the default is not set.</span>
<span class="sd">        &gt;&gt;&gt; getter = arggetter(0, 1, 2)</span>
<span class="sd">        &gt;&gt;&gt; getter(&quot;A&quot;, key=&quot;value&quot;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        IndexError: positional argument index is out of range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">getter</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
                <span class="k">if</span> <span class="o">-</span><span class="n">count</span> <span class="o">&lt;=</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="n">count</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">RAISE</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;positional argument index is out of range&quot;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">SELF</span><span class="p">:</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="n">key</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="n">default</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># If only one result, return it directly</span>
            <span class="k">return</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">getter</span></div>



<div class="viewcode-block" id="constantcreator">
<a class="viewcode-back" href="../../builtin.html#calcpy.constantcreator">[docs]</a>
<span class="k">class</span> <span class="nc">constantcreator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Callable that returns the same constant when it is called.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        value : Constant value to be returned.</span>
<span class="sd">        copy : If ``True``, return a new copy of the constant value.</span>

<span class="sd">    Returns:</span>
<span class="sd">        callable: Callable object that returns ``value``, ignoring its parameters.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Always return the string ``&quot;value&quot;``.</span>

<span class="sd">        &gt;&gt;&gt; creator = constantcreator(&quot;value&quot;)</span>
<span class="sd">        &gt;&gt;&gt; creator()</span>
<span class="sd">        &#39;value&#39;</span>

<span class="sd">        Create a pd.DataFrame whose elements are all empty lists.</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(index=range(3), columns=[&quot;A&quot;])</span>
<span class="sd">        &gt;&gt;&gt; df.map(constantcreator([]))</span>
<span class="sd">            A</span>
<span class="sd">        0  []</span>
<span class="sd">        1  []</span>
<span class="sd">        2  []</span>

<span class="sd">        Return a new copy when ``copy=True``.</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(index=range(3), columns=[&quot;A&quot;])</span>
<span class="sd">        &gt;&gt;&gt; constantcreator(df, copy=True)() is df</span>
<span class="sd">        False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">copy</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;shallow&quot;</span><span class="p">,</span> <span class="n">shallowcopy</span><span class="p">]:</span>
                <span class="n">copy</span> <span class="o">=</span> <span class="n">shallowcopy</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">copy</span> <span class="o">=</span> <span class="n">deepcopy</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">copy</span> <span class="o">=</span> <span class="n">arggetter</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copy</span> <span class="o">=</span> <span class="n">copy</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>



<div class="viewcode-block" id="all_">
<a class="viewcode-back" href="../../math.html#calcpy.all_">[docs]</a>
<span class="k">def</span> <span class="nf">all_</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return ``True`` of ``bool(x)`` is ``True`` for all ``x`` in the iterable.</span>

<span class="sd">    If the iterable is empty, return what ``empty`` specifies.</span>

<span class="sd">    Fully compatible with Python&#39;s built-in ``all()``.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        iterable (iterable):</span>
<span class="sd">        empty : Value if ``iterable`` is empty.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; all_([])</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; all_([False])</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; all_([True])</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; all_([True, False])</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; all_([True, True])</span>
<span class="sd">        True</span>

<span class="sd">    See also:</span>
<span class="sd">        https://docs.python.org/3/library/functions.html#all</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">empty</span>
    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span></div>



<div class="viewcode-block" id="any_">
<a class="viewcode-back" href="../../math.html#calcpy.any_">[docs]</a>
<span class="k">def</span> <span class="nf">any_</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return ``True`` if ``bool(x)`` is ``True`` for any ``x`` in the iterable.</span>

<span class="sd">    If the iterable is empty, return what ``empty`` specifies.</span>

<span class="sd">    Fully compatible with Python&#39;s built-in ``any()``.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        iterable (iterable):</span>
<span class="sd">        empty : Value if ``iterable`` is empty.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; any_([])</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; any_([False])</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; any_([True])</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; any_([True, False])</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; any_([True, True])</span>
<span class="sd">        True</span>

<span class="sd">    See also:</span>
<span class="sd">        https://docs.python.org/3/library/functions.html#any</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">empty</span>
    <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span></div>



<div class="viewcode-block" id="never">
<a class="viewcode-back" href="../../math.html#calcpy.never">[docs]</a>
<span class="k">def</span> <span class="nf">never</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return ``True`` if ``bool(x)`` is ``False`` for all ``x`` in the iterable.</span>

<span class="sd">    If the iterable is empty, return what ``empty`` specifies.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        iterable (iterable):</span>
<span class="sd">        empty : Value if ``iterable`` is empty.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; never([])</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; never([False])</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; never([True])</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; never([True, False])</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; never([True, True])</span>
<span class="sd">        False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span></div>



<div class="viewcode-block" id="odd">
<a class="viewcode-back" href="../../math.html#calcpy.odd">[docs]</a>
<span class="k">def</span> <span class="nf">odd</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return ``True`` if an odd number of items in the iterable are ``True``.</span>

<span class="sd">    If the iterable is empty, return what ``empty`` specifies.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        iterable (iterable):</span>
<span class="sd">        empty : Value if ``iterable`` is empty.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; odd([])</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; odd([False])</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; odd([True])</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; odd([True, False])</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; odd([True, True])</span>
<span class="sd">        False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">empty</span>

    <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">xor</span><span class="p">,</span> <span class="n">iterable</span><span class="p">)</span></div>



<div class="viewcode-block" id="and_">
<a class="viewcode-back" href="../../math.html#calcpy.and_">[docs]</a>
<span class="k">def</span> <span class="nf">and_</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return ``True`` if all values are ``True``.</span>

<span class="sd">    Fully compatible with Python&#39;s built-in ``operator.and_``.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        *args</span>
<span class="sd">        empty : Value if ``args`` have no values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool:</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; and_()</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; and_(True, True)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; and_(True, True, False)</span>
<span class="sd">        False</span>

<span class="sd">    See also:</span>
<span class="sd">        https://docs.python.org/3/library/operator.html#operator.and_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">all_</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="n">empty</span><span class="p">)</span></div>



<div class="viewcode-block" id="or_">
<a class="viewcode-back" href="../../math.html#calcpy.or_">[docs]</a>
<span class="k">def</span> <span class="nf">or_</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return ``True`` if any values are ``True``.</span>

<span class="sd">    Fully compatible with Python&#39;s built-in ``operator.or_``.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        *args</span>
<span class="sd">        empty : Value if ``args`` have no values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool:</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; or_()</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; or_(True, True)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; or_(True, True, False)</span>
<span class="sd">        True</span>

<span class="sd">    See also:</span>
<span class="sd">        https://docs.python.org/3/library/operator.html#operator.or_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">any_</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="n">empty</span><span class="p">)</span></div>



<div class="viewcode-block" id="xor">
<a class="viewcode-back" href="../../math.html#calcpy.xor">[docs]</a>
<span class="k">def</span> <span class="nf">xor</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return ``True`` if any values are ``True``.</span>

<span class="sd">    Fully compatible with Python&#39;s built-in ``operator.xor``.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        *args</span>
<span class="sd">        empty : Value if ``args`` have no values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool:</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; xor()</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; xor(True)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; xor(True, True, False)</span>
<span class="sd">        False</span>

<span class="sd">    See also:</span>
<span class="sd">        https://docs.python.org/3/library/operator.html#operator.xor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">odd</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="n">empty</span><span class="p">)</span></div>



<span class="k">def</span> <span class="nf">_allpairwise_glet</span><span class="p">(</span><span class="n">glet_name</span><span class="p">):</span>
    <span class="c1"># glet is short for the collection of [&quot;lt&quot;, &quot;le&quot;, &quot;gt&quot;, &quot;ge&quot;].</span>
    <span class="n">glet</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">operator</span><span class="p">,</span> <span class="n">glet_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span>
        <span class="n">iterable</span> <span class="o">=</span> <span class="p">(</span><span class="n">glet</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pairwise</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="n">glet_name</span>
    <span class="n">f</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Return ``True`` when all arguments are </span><span class="si">{</span><span class="n">glet_name</span><span class="si">}</span><span class="s2"> the next argument.</span>

<span class="s2">    Fully compatible with Python&#39;s built-in ``operator.</span><span class="si">{</span><span class="n">glet_name</span><span class="si">}</span><span class="s2">``.</span>

<span class="s2">    Parameters:</span>
<span class="s2">        *args</span>
<span class="s2">        key (callable):</span>

<span class="s2">    Returns:</span>
<span class="s2">        bool:</span>

<span class="s2">    Examples:</span>
<span class="s2">        &gt;&gt;&gt; </span><span class="si">{</span><span class="n">glet_name</span><span class="si">}</span><span class="s2">()</span>
<span class="s2">        True</span>
<span class="s2">        &gt;&gt;&gt; </span><span class="si">{</span><span class="n">glet_name</span><span class="si">}</span><span class="s2">(1)</span>
<span class="s2">        True</span>
<span class="s2">        &gt;&gt;&gt; </span><span class="si">{</span><span class="n">glet_name</span><span class="si">}</span><span class="s2">(1, 1)</span>
<span class="s2">        </span><span class="si">{</span><span class="n">glet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        &gt;&gt;&gt; </span><span class="si">{</span><span class="n">glet_name</span><span class="si">}</span><span class="s2">(1, 2)</span>
<span class="s2">        </span><span class="si">{</span><span class="n">glet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        &gt;&gt;&gt; </span><span class="si">{</span><span class="n">glet_name</span><span class="si">}</span><span class="s2">(2, 1)</span>
<span class="s2">        </span><span class="si">{</span><span class="n">glet</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        &gt;&gt;&gt; </span><span class="si">{</span><span class="n">glet_name</span><span class="si">}</span><span class="s2">(1, 1, 2)</span>
<span class="s2">        </span><span class="si">{</span><span class="n">glet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">glet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        &gt;&gt;&gt; </span><span class="si">{</span><span class="n">glet_name</span><span class="si">}</span><span class="s2">(1, 2, 3)</span>
<span class="s2">        </span><span class="si">{</span><span class="n">glet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">glet</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        &gt;&gt;&gt; </span><span class="si">{</span><span class="n">glet_name</span><span class="si">}</span><span class="s2">(3, 2, 1)</span>
<span class="s2">        </span><span class="si">{</span><span class="n">glet</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">glet</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span>

<span class="s2">    See also:</span>
<span class="s2">        https://docs.python.org/3/library/operator.html#operator.</span><span class="si">{</span><span class="n">glet_name</span><span class="si">}</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">f</span>


<span class="n">lt</span> <span class="o">=</span> <span class="n">_allpairwise_glet</span><span class="p">(</span><span class="s2">&quot;lt&quot;</span><span class="p">)</span>
<span class="n">le</span> <span class="o">=</span> <span class="n">_allpairwise_glet</span><span class="p">(</span><span class="s2">&quot;le&quot;</span><span class="p">)</span>
<span class="n">gt</span> <span class="o">=</span> <span class="n">_allpairwise_glet</span><span class="p">(</span><span class="s2">&quot;gt&quot;</span><span class="p">)</span>
<span class="n">ge</span> <span class="o">=</span> <span class="n">_allpairwise_glet</span><span class="p">(</span><span class="s2">&quot;ge&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="eq">
<a class="viewcode-back" href="../../cmp.html#calcpy.eq">[docs]</a>
<span class="k">def</span> <span class="nf">eq</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether all parameters are the same.</span>

<span class="sd">    Fully compatible with Python&#39;s built-in ``operator.eq``.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        *args</span>
<span class="sd">        key (callable)</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool:</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; eq({&quot;a&quot;: 1}, {&quot;a&quot;: 1}, {&quot;a&quot;: 1})</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; eq(1, 1, 2, 2)</span>
<span class="sd">        False</span>

<span class="sd">    See also:</span>
<span class="sd">        https://docs.python.org/3/library/operator.html#operator.eq</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">distinct_count</span> <span class="o">=</span> <span class="n">count_unique</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">distinct_count</span> <span class="o">&lt;=</span> <span class="mi">1</span></div>



<div class="viewcode-block" id="ne">
<a class="viewcode-back" href="../../cmp.html#calcpy.ne">[docs]</a>
<span class="k">def</span> <span class="nf">ne</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether all parameters are distinct.</span>

<span class="sd">    Fully compatible with Python&#39;s built-in ``operator.ne``.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        *args</span>
<span class="sd">        key (callable)</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool:</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; ne([1, 2], [1, 3], [2, 3])</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; ne([1, 2], [1, 3], [1, 3])</span>
<span class="sd">        False</span>

<span class="sd">    See also:</span>
<span class="sd">        https://docs.python.org/3/library/operator.html#operator.ne</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">original_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="n">distinct_count</span> <span class="o">=</span> <span class="n">count_unique</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">original_count</span> <span class="o">==</span> <span class="n">distinct_count</span></div>



<div class="viewcode-block" id="same">
<a class="viewcode-back" href="../../seq.html#calcpy.same">[docs]</a>
<span class="k">def</span> <span class="nf">same</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether all elements are the same.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        values (iterable)</span>
<span class="sd">        key (callable)</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool:</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; same([{&quot;a&quot;: 1}, {&quot;a&quot;: 1}, {&quot;a&quot;: 1}])</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; same([1, 1, 2, 2])</span>
<span class="sd">        False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">eq</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>



<div class="viewcode-block" id="distinct">
<a class="viewcode-back" href="../../seq.html#calcpy.distinct">[docs]</a>
<span class="k">def</span> <span class="nf">distinct</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether all elements are distinct.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        values (iterable)</span>
<span class="sd">        key (callable)</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool:</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; distinct([[1, 2], [1, 3], [2, 3]])</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; distinct([[1, 2], [1, 3], [1, 3]])</span>
<span class="sd">        False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ne</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>



<span class="k">def</span> <span class="nf">_concat</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">matcher</span><span class="p">,</span> <span class="n">assemble</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">results</span> <span class="o">+=</span> <span class="n">matcher</span><span class="o">.</span><span class="n">disassemble</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">assemble</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">matcher</span><span class="o">.</span><span class="n">assemble</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">results</span>


<div class="viewcode-block" id="concat">
<a class="viewcode-back" href="../../collect.html#calcpy.concat">[docs]</a>
<span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Concat multiple parameters.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        *args</span>
<span class="sd">        key (callable)</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; concat([1, 2, 3], [], [4, 5], [5])</span>
<span class="sd">        [1, 2, 3, 4, 5, 5]</span>
<span class="sd">        &gt;&gt;&gt; concat((1, 2, 3), (), (4, 5), (5,))</span>
<span class="sd">        (1, 2, 3, 4, 5, 5)</span>
<span class="sd">        &gt;&gt;&gt; concat({1, 2, 3}, set(), {4, 5}, {5})</span>
<span class="sd">        {1, 2, 3, 4, 5}</span>
<span class="sd">        &gt;&gt;&gt; concat({1: &#39;a&#39;, 2: &#39;b&#39;}, {}, {3: &#39;c&#39;, 4: &#39;d&#39;}, {5: &#39;e&#39;})</span>
<span class="sd">        {1: &#39;a&#39;, 2: &#39;b&#39;, 3: &#39;c&#39;, 4: &#39;d&#39;, 5: &#39;e&#39;}</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; s = pd.Series([0, 1])</span>
<span class="sd">        &gt;&gt;&gt; concat(s, s)</span>
<span class="sd">        0    0</span>
<span class="sd">        1    1</span>
<span class="sd">        0    0</span>
<span class="sd">        1    1</span>
<span class="sd">        dtype: int64</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
    <span class="n">matcher</span> <span class="o">=</span> <span class="n">_get_matcher</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_concat</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">matcher</span><span class="o">=</span><span class="n">matcher</span><span class="p">)</span></div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../index.html">calcpy  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">calcpy._op</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright .
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    </div>
  </body>
</html>