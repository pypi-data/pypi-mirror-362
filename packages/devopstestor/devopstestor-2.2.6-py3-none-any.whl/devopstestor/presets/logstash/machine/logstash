# syntax=docker/dockerfile:1.3-labs
FROM debian:bookworm-slim

ENV container docker
ENV LC_ALL C
ENV DEBIAN_FRONTEND noninteractive

# Init testauto in container
RUN apt update && apt upgrade -y && apt install -y python3 python3-pip python3-pytest python3-testinfra python3-coloredlogs curl python3-dateutil && \
 python3 -m pip install --break-system-packages devopstestor


# Install product
RUN curl -o /tmp/logstash.deb https://artifacts.elastic.co/downloads/logstash/logstash-8.13.4-amd64.deb && \
  apt install -y /tmp/logstash.deb

#Â cleanup
RUN apt clean

# Start logstash on mock configuration
COPY entrypoint.sh /usr/bin/
CMD /usr/bin/entrypoint.sh