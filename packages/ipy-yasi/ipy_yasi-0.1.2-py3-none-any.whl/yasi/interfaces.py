"""Functions to extract information from interfaces like the file system or the internet"""

# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/01_interfaces.ipynb.

# %% auto 0
__all__ = ['extract_styled_text', 'extract_docx_content']

# %% ../nbs/01_interfaces.ipynb 3
from docx import Document
from os import listdir

def extract_styled_text(document):
    out = ''
    # Iterate over each paragraph in the document
    for para in document.paragraphs:
        for run in para.runs:
            if len(run.text) > 1:
                prefix = '' if run.font.bold is None else '**'
                suffix = '' if run.font.bold is None else '**'
                prefix += '' if run.font.highlight_color is None else '<mark>'
                suffix += '' if run.font.highlight_color is None else '</mark>'
                out += f'{prefix}{run.text}{suffix}'
            else:
                out += run.text
        out += '\n\n'
    return out

def extract_docx_content(file_name):
    try:
        # Open the .docx file using python-docx
        doc = Document(file_name)
        return extract_styled_text(doc)
    except FileNotFoundError:
        print("Sorry, the file does not exist.")
        return None
    except Exception as e:
        print(f"Error: {e}")
        return None
