runtime: 
  mode: pipeline
  log_type: []

dataset:
  name: CIFAR10
  params:
    root: ./data
    train: true
    download: true
  wrapper: contrastive
  transform:
    - name: RandomResizedCrop
      params: { size: 32 }
    - name: RandomHorizontalFlip
      params: { p: 0.5 }
    - name: ToTensor
    - name: RandomApply
      params:
        transforms:
          - name: ColorJitter
            params: { brightness: 0.4, contrast: 0.4, saturation: 0.4, hue: 0.1 }
        p: 0.8
    - name: RandomGrayscale
      params: { p: 0.2 }
    - name: Normalize
      params:
        mean: [0.4914, 0.4822, 0.4465]
        std: [0.2023, 0.1994, 0.2010]

dataloader:
  params: 
    batch_size: 32
    shuffle: true
    num_workers: 4
    drop_last: true

model:
  name: dino
  wrapper: dino
  params:
    backbone: resnet18
    out_dim: 65536
  # fusion:
  #   type: cuml
  #   model: logistic_regression
  #   params:
  #     C: 1.0
  #     penalty: l2
  #     solver: qn
  #     max_iter: 500


loss:
  name: dino_wrapped
  mode: embedding
  params:
    out_dim: 65536
    teacher_temp: 0.04
    student_temp: 0.1
    center_momentum: 0.9

optimizer:
  name: adam
  params:
    lr: 0.0003

scheduler:
  name: cosine
  params:
    T_max: 100

trainer:
  name: dino
  params:
    save_dir: "./checkpoints"
    num_epochs: 1
    device: cuda