"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[515],{97500:function(e,t,r){async function l(e,t){let{arg:r}=t,l=await fetch(""+e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!(l.status>=200&&l.status<300))throw Error(await l.text());let i=await l.json();if(!l.ok)throw Error(i.message);return i}r.d(t,{_i:function(){return i},gz:function(){return o},hw:function(){return a},sj:function(){return n},wG:function(){return l}});let i=async function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let l=await fetch(""+t[0],t[1]);if(!l.ok)throw Error(await l.text());return l.json()},n=async(e,t)=>{let r=await fetch(""+e,t);if(!r.ok)throw Error(await r.text());return r};async function a(e,t){let{arg:r}=t,l=await fetch("".concat("").concat(e,"/").concat(r),{method:"DELETE"});if(!l.ok)throw Error(await l.text());return l}async function o(e,t){let{arg:r}=t,l=await fetch("".concat("").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!l.ok)throw Error(await l.text());return l}},21659:function(e,t,r){r.d(t,{Bf:function(){return o},JB:function(){return s},ZP:function(){return a}});var l=r(85323),i=r(97500),n=r(2265);function a(){let{data:e,error:t,isLoading:r}=(0,l.ZP)("/v1/streamers",i._i);return{isLoading:r,streamers:e}}function o(){let{data:e,error:t,isLoading:r}=(0,l.ZP)("/v1/users",i._i),[a,o]=(0,n.useState)([]);return(0,n.useEffect)(()=>{if(!e||0===e.length)return;let t=async e=>{try{var t;let r=await (0,i._i)("/bili/space/myinfo?user=".concat(e.value),void 0),l=await (0,i.sj)("/bili/proxy?url=".concat(null===(t=r.data)||void 0===t?void 0:t.face)),n=await l.blob();return{...e,name:r.data.name,face:URL.createObjectURL(n)}}catch(l){console.error(l);let t=await (0,i.sj)("/bili/proxy?url=https://i0.hdslb.com/bfs/face/member/noface.jpg"),r=await t.blob();return{...e,name:"Cookie已失效",face:URL.createObjectURL(r)}}};Promise.all(e.map(t)).then(o)},[e]),{isLoading:r,isError:t,biliUsers:a}}function s(){var e;let{data:t,error:r,isLoading:n}=(0,l.ZP)("/bili/archive/pre",i._i);return{isLoading:n,isError:r,typeTree:null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.typelist.map(e=>({label:e.name,value:e.id,children:e.children}))}}},36699:function(e,t,r){r.d(t,{Fg:function(){return s},K4:function(){return o},cE:function(){return a},f:function(){return i},ql:function(){return n}});var l=r(2265);let i={xs:"(max-width: 575px)",sm:"(min-width: 576px)",md:"(min-width: 768px)",lg:"(min-width: 992px)",xl:"(min-width: 1200px)",xxl:"(min-width: 1600px)"},n=(e,t)=>{let{match:r,unmatch:l,callInInit:i=!0}=t;{let t=window.matchMedia(e),n=function(e){e.matches?r&&r(e):l&&l(e)};return(i&&n(t),Object.prototype.hasOwnProperty.call(t,"addEventListener"))?(t.addEventListener("change",n),()=>t.removeEventListener("change",n)):(t.addListener(n),()=>t.removeListener(n))}},a=e=>new Date(1e3*e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replaceAll("/","-"),o=()=>{let[e,t]=(0,l.useState)("light");return(0,l.useEffect)(()=>{let e=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";t(e);let r=window.matchMedia("(prefers-color-scheme: dark)"),l=()=>t(e);return r.addEventListener("change",l),()=>r.removeEventListener("change",l)},[]),e},s=(e,t)=>{(0,l.useEffect)(()=>{switch(localStorage.setItem("mode",e),e){case"light":document.body.setAttribute("theme-mode","light");break;case"dark":document.body.setAttribute("theme-mode","dark");break;default:document.body.setAttribute("theme-mode",t)}},[e,t])}},9707:function(e,t,r){var l=r(57437),i=r(2265),n=r(62146),a=r(97349),o=r(48045),s=r(78499),c=r(76301),u=r(21659);t.Z=e=>{var t,r;let{formState:d,formApi:h,values:f}=e,{Section:m,Input:x,DatePicker:p,TimePicker:g,Select:w,Switch:y,InputNumber:b,Checkbox:v,CheckboxGroup:j,RadioGroup:E,Radio:S,Cascader:_,TagInput:k,TextArea:C}=c.Form,{Text:O}=c.Typography,{typeTree:L,isError:R,isLoading:M}=(0,u.JB)(),P=null==L?void 0:L.map(e=>({...e,children:e.children.map(e=>({label:(0,l.jsxs)(l.Fragment,{children:[e.name," ",(0,l.jsx)(O,{type:"quaternary",size:"small",children:e.desc})]}),value:e.id}))})),Z=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j,{field:"sound",options:[{label:"杜比音效",value:"dolby"},{label:"Hi-Res无损音质",value:"hires"}],direction:"horizontal",label:"音效设置"}),(0,l.jsx)(j,{field:"interaction",options:[{label:"关闭弹幕",value:"up_close_danmu"},{label:"关闭评论",value:"up_close_reply"},{label:"开启精选评论",value:"up_selection_reply"}],direction:"horizontal",label:"互动设置"}),(0,l.jsx)(x,{field:"dynamic",label:"粉丝动态",style:{width:464}}),(0,l.jsxs)(c.Form.Select,{field:"uploader",label:"上传插件",initValue:null!==(t=f.uploader)&&void 0!==t?t:"biliup-rs",style:{width:250},showClear:!0,children:[(0,l.jsx)(c.Form.Select.Option,{value:"bili_web",children:"bili_web"}),(0,l.jsx)(c.Form.Select.Option,{value:"biliup-rs",children:"biliup-rs"}),(0,l.jsx)(c.Form.Select.Option,{value:"Noop",children:"Noop"})]}),(0,l.jsx)(y,{field:"no_reprint",label:"自制声明"}),(0,l.jsx)(y,{field:"is_only_self",label:"仅自己可见"}),(0,l.jsx)(c.Form.Switch,{field:"open_elec",label:"开启充电面板"}),(0,l.jsx)(c.OF,{field:"credits",children:e=>{let{add:t,arrayFields:r}=e;return(0,l.jsxs)(c.Form.Section,{text:"简介@替换",children:[(0,l.jsxs)("div",{className:"semi-form-field-extra",style:{fontSize:"14px"},children:["如需在简介中@别人，请使用此项。示例：",(0,l.jsx)("br",{}),"简介：","{","streamer","}","主播直播间地址：","{","url","}"," 【@credit】",(0,l.jsx)("br",{}),'其中的"@credits"会依次替换为下面输入的@']}),(0,l.jsx)(c.zx,{icon:(0,l.jsx)(n.Z,{}),onClick:t,theme:"light",children:"添加行"}),r.map((e,t)=>{let{field:r,key:i,remove:n}=e;return(0,l.jsxs)("div",{style:{width:1e3,display:"flex"},children:[(0,l.jsxs)(c.BZ,{children:[(0,l.jsx)(x,{field:"".concat(r,".username"),label:"需要@的用户名",placeholder:"username"}),(0,l.jsx)(x,{field:"".concat(r,".uid"),label:"需要@的uid",placeholder:"uid"})]}),(0,l.jsx)(c.zx,{type:"danger",theme:"borderless",icon:(0,l.jsx)(a.Z,{}),onClick:n,style:{margin:12}})]},i)})]})}})]}),[z,F]=(0,i.useState)(!1),{biliUsers:T}=(0,u.Bf)(),q=null==T?void 0:T.map(e=>({value:e.value,label:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.qE,{size:"extra-small",src:e.face}),(0,l.jsx)("span",{style:{marginLeft:8},children:e.name})]})})),A=Array(360).fill(0).map((e,t)=>({value:t,text:"".concat(t,"小时"),disabled:t<4||t>=360})),U=Array(12).fill(0).map((e,t)=>({value:5*t,text:"".concat(5*t,"分钟")})),[B,D]=(0,i.useState)(4),[I,N]=(0,i.useState)(0);return(0,i.useEffect)(()=>{let e=h.getValue("dtime");if(e){let t=Math.floor(e/3600);t>=4&&t<360&&(D(t),N(5*Math.floor(Math.floor(e%3600/60)/5)))}},[h]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(m,{text:"基本信息",children:[(0,l.jsx)(x,{rules:[{required:!0}],field:"template_name",label:"模板名称",style:{width:464}}),(0,l.jsx)(c.Form.Select,{rules:[{required:!0}],field:"user_cookie",label:{text:"投稿账号"},style:{width:176},optionList:q})]}),(0,l.jsxs)(m,{text:"基本设置",children:[(0,l.jsx)(x,{field:"title",label:"视频标题",style:{width:464},placeholder:"稿件标题",extraText:(0,l.jsxs)("div",{style:{fontSize:14},children:["{","streamer","}",": 录播备注",(0,l.jsx)("br",{}),"{","title","}",": 直播标题",(0,l.jsx)("br",{}),"%Y-%m-%d %H_%M_%S: 开始录制时的 年-月-日 时_分_秒"]})}),(0,l.jsxs)(E,{field:"copyright",label:"类型",direction:"vertical",initValue:null!==(r=h.getValue("copyright"))&&void 0!==r?r:2,extraText:(0,l.jsx)("div",{style:{fontSize:14},children:"如不填写转载来源默认为直播间地址"}),children:[(0,l.jsxs)(S,{value:2,style:{alignItems:"center",flexShrink:0},children:[(0,l.jsx)("span",{style:{flexShrink:0},children:"转载"}),(0,l.jsx)(x,{field:"copyright_source",onClick:()=>h.setValue("copyright",2),placeholder:"转载视频请注明来源（例：转自http://www.xx.com/yy）注明来源会更快地通过审核哦",noLabel:!0,fieldStyle:{padding:0,marginLeft:24,width:560}})]}),(0,l.jsx)("div",{onClick:()=>h.setValue("copyright_source",""),children:(0,l.jsx)(S,{value:1,children:"自制"})})]}),(0,l.jsx)(_,{field:"tid",label:"分区",style:{width:272},treeData:P,placeholder:"投稿分区",dropdownStyle:{maxWidth:670},rules:[{required:!0}]}),(0,l.jsx)(k,{max:12,maxLength:20,field:"tags",label:"标签",allowDuplicates:!1,addOnBlur:!0,separator:",",placeholder:"可用英文逗号分隔以批量输入标签，失焦/Enter 以保存",onChange:e=>console.log(e),style:{width:560},rules:[{required:!0,message:"Tag不能为空"}],onExceed:e=>{c.P_.warning({title:"标签输入错误",position:"top",content:"标签数量不能超过12个",duration:3})},onInputExceed:e=>{c.P_.warning({title:"标签输入错误",position:"top",content:"单个标签字数不能超过20",duration:3})}}),(0,l.jsx)(x,{field:"cover_path",label:"视频封面",style:{width:464},placeholder:"/cover/up.jpg"}),(0,l.jsx)(C,{style:{maxWidth:560},field:"description",label:"简介",placeholder:"填写更全面的相关信息，让更多的人能找到你的视频吧",autosize:!0,maxCount:2e3,showClear:!0}),(0,l.jsx)(C,{style:{maxWidth:560},field:"extra_fields",label:"额外字段",placeholder:"Json格式，示例：{key: 'value'}",autosize:!0,maxCount:2e3,showClear:!0,rules:[{validator:(e,t)=>{if(!t)return!0;try{return JSON.parse(t),!0}catch(e){return!1}},message:"请输入正确的Json格式文本"}]}),(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",color:"var(--semi-color-tertiary)"},children:[(0,l.jsx)(y,{field:"isDtime",label:{text:"定时发布"},checkedText:"｜",uncheckedText:"〇"}),(0,l.jsx)("span",{style:{paddingLeft:12,fontSize:12},children:"(当前+2小时 ≤ 可选时间 ≤ 当前+15天，转载稿件撞车判定以过审发布时间为准。上传速度不佳的机器请谨慎开启，或设置更大的延迟时间。)"})]}),f.isDtime?(0,l.jsxs)(c.Rq,{style:{border:"unset",boxShadow:"unset",width:300,height:300},header:"延迟时间",footer:(0,l.jsx)(c.zx,{size:"small",type:"primary",onClick:()=>{let e=3600*B+60*I;h.setValue("dtime",e),c.P_.success({title:"保存成功",content:"延迟时间：".concat(B,"小时").concat(I,"分钟"),duration:3,position:"top"}),console.log(e)},children:"确认"}),children:[(0,l.jsx)(c.YC,{mode:"wheel",cycled:!0,list:A,type:1,selectedIndex:A.findIndex(e=>e.value===B),onSelect:e=>D(e.value)}),(0,l.jsx)(c.YC,{mode:"wheel",cycled:!0,list:U,type:2,selectedIndex:U.findIndex(e=>e.value===I),onSelect:e=>N(e.value)})]}):null]}),(0,l.jsx)(m,{style:{paddingBottom:40},text:(0,l.jsxs)("div",{style:{cursor:"pointer"},onClick:()=>{F(!z),h.scrollToField("isDtime")},children:["更多设置"," ",z?(0,l.jsx)(o.Z,{style:{marginLeft:12}}):(0,l.jsx)(s.Z,{style:{marginLeft:12}})]}),children:(0,l.jsx)(c.qq,{isOpen:z,keepDOM:!0,children:Z})})]})}},97349:function(e,t,r){var l=r(2265);let i=(0,r(87565).A)(function(e){return l.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 23a11 11 0 1 0 0-22 11 11 0 0 0 0 22ZM6.5 10.5h11a1.5 1.5 0 0 1 0 3h-11a1.5 1.5 0 0 1 0-3Z",fill:"currentColor"}))},"minus_circle");t.Z=i},62146:function(e,t,r){var l=r(2265);let i=(0,r(87565).A)(function(e){return l.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 23a11 11 0 1 0 0-22 11 11 0 0 0 0 22Zm7-11.12a1.5 1.5 0 0 1-1.47 1.52l-4 .07.07 4a1.5 1.5 0 0 1-3 .06l-.07-4-4 .07a1.5 1.5 0 0 1-.06-3l4-.07-.07-4a1.5 1.5 0 1 1 3-.06l.07 4 4-.07A1.5 1.5 0 0 1 19 11.88Z",fill:"currentColor"}))},"plus_circle");t.Z=i},99376:function(e,t,r){var l=r(35475);r.o(l,"usePathname")&&r.d(t,{usePathname:function(){return l.usePathname}}),r.o(l,"useRouter")&&r.d(t,{useRouter:function(){return l.useRouter}}),r.o(l,"useSearchParams")&&r.d(t,{useSearchParams:function(){return l.useSearchParams}})},65582:function(e,t,r){r.d(t,{Z:function(){return c}});var l=r(2265),i=r(62827),n=r(85323),a=r(60951);let o=a.I?e=>{e()}:l.startTransition,s=e=>{let[,t]=(0,l.useState)({}),r=(0,l.useRef)(!1),i=(0,l.useRef)(e),n=(0,l.useRef)({data:!1,error:!1,isValidating:!1}),o=(0,l.useCallback)(e=>{let l=!1,a=i.current;for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&a[t]!==e[t]&&(a[t]=e[t],n.current[t]&&(l=!0));l&&!r.current&&t({})},[]);return(0,a.v)(()=>(r.current=!1,()=>{r.current=!0})),[i,n.current,o]},c=(0,i.xD)(n.ZP,()=>(e,t,r={})=>{let{mutate:n}=(0,i.kY)(),c=(0,l.useRef)(e),u=(0,l.useRef)(t),d=(0,l.useRef)(r),h=(0,l.useRef)(0),[f,m,x]=s({data:a.U,error:a.U,isMutating:!1}),p=f.current,g=(0,l.useCallback)(async(e,t)=>{let[r,l]=(0,a.s)(c.current);if(!u.current)throw Error("Can’t trigger the mutation: missing fetcher.");if(!r)throw Error("Can’t trigger the mutation: missing key.");let i=(0,a.m)((0,a.m)({populateCache:!1,throwOnError:!0},d.current),t),s=(0,a.p)();h.current=s,x({isMutating:!0});try{let t=await n(r,u.current(l,{arg:e}),(0,a.m)(i,{throwOnError:!0}));return h.current<=s&&(o(()=>x({data:t,isMutating:!1,error:void 0})),null==i.onSuccess||i.onSuccess.call(i,t,r,i)),t}catch(e){if(h.current<=s&&(o(()=>x({error:e,isMutating:!1})),null==i.onError||i.onError.call(i,e,r,i),i.throwOnError))throw e}},[]),w=(0,l.useCallback)(()=>{h.current=(0,a.p)(),x({data:a.U,error:a.U,isMutating:!1})},[]);return(0,a.v)(()=>{c.current=e,u.current=t,d.current=r}),{trigger:g,reset:w,get data(){return m.data=!0,p.data},get error(){return m.error=!0,p.error},get isMutating(){return m.isMutating=!0,p.isMutating}}})}}]);