# OpenCrawler Production Configuration
# Author: Nik Jois <nikjois@llamasearch.ai>

# Engine Configuration
engines:
  preferred: "playwright"  # Most reliable for JavaScript-heavy sites
  fallback_order: ["requests", "selenium", "cloudscraper"]
  
  playwright:
    headless: true
    timeout: 30000  # 30 seconds
    viewport: 
      width: 1920
      height: 1080
    user_agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
    args:
      - "--disable-blink-features=AutomationControlled"
      - "--disable-dev-shm-usage"
      - "--no-sandbox"
      - "--disable-setuid-sandbox"
  
  requests:
    timeout: 30  # 30 seconds
    verify_ssl: true
    headers:
      User-Agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
      Accept: "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
      Accept-Language: "en-US,en;q=0.5"
      Accept-Encoding: "gzip, deflate"
      Connection: "keep-alive"
      Upgrade-Insecure-Requests: "1"
  
  selenium:
    headless: true
    timeout: 30
    options:
      - "--disable-blink-features=AutomationControlled"
      - "--disable-dev-shm-usage"
      - "--no-sandbox"
      - "--disable-setuid-sandbox"
      - "--disable-gpu"
      - "--disable-background-timer-throttling"
      - "--disable-backgrounding-occluded-windows"
      - "--disable-renderer-backgrounding"

# AI Configuration
ai:
  enabled: true
  default_model: "gpt-4o"
  fallback_model: "gpt-3.5-turbo"
  
  # OpenAI Configuration
  openai:
    api_base: "https://api.openai.com/v1"
    temperature: 0.1
    max_tokens: 4096
    timeout: 60
    retries: 3
    
  # Anthropic Configuration
  anthropic:
    api_base: "https://api.anthropic.com"
    temperature: 0.1
    max_tokens: 4096
    timeout: 60
    retries: 3
    
  # Local/Ollama Configuration
  ollama:
    base_url: "http://localhost:11434"
    model_name: "llama3.2"
    temperature: 0.3
    max_tokens: 2000
    timeout: 120
    retries: 2

# Stealth Configuration
stealth:
  enabled: true
  rotate_user_agents: true
  random_delays: true
  use_proxies: false
  anti_detection:
    enabled: true
    techniques:
      - "user_agent_rotation"
      - "viewport_randomization"
      - "request_timing_variation"
      - "header_randomization"
      - "fingerprint_masking"
  
  # Proxy Configuration (if enabled)
  proxies:
    # Add your proxy list here
    # - "http://user:pass@proxy1:port"
    # - "http://user:pass@proxy2:port"
    
  # Rate Limiting
  rate_limiting:
    enabled: true
    requests_per_second: 2
    burst_size: 10
    backoff_factor: 2
    max_backoff: 60

# Performance Configuration
performance:
  max_concurrent_requests: 10
  request_delay_range: [1, 3]  # seconds
  retry_attempts: 3
  retry_backoff: 2  # exponential backoff multiplier
  timeout: 30  # global timeout in seconds
  
  # Memory Management
  memory:
    max_memory_mb: 2048
    cleanup_interval: 300  # seconds
    
  # Caching
  cache:
    enabled: true
    ttl: 3600  # 1 hour
    max_size: 1000  # max cached items
    
  # Database Connection Pool
  database:
    pool_size: 10
    max_overflow: 20
    pool_timeout: 30
    pool_recycle: 3600

# Output Configuration
output:
  default_format: "json"
  pretty_print: true
  include_metadata: true
  include_timestamps: true
  include_source_url: true
  
  # File Output
  file:
    create_directories: true
    overwrite_existing: false
    compression: "gzip"
    
  # Export Options
  export:
    formats: ["json", "csv", "excel", "markdown"]
    batch_size: 1000
    max_file_size_mb: 100

# Security Configuration
security:
  enabled: true
  
  # Content Security
  content_filtering:
    enabled: true
    max_content_size_mb: 50
    blocked_extensions: [".exe", ".bat", ".cmd", ".scr"]
    
  # Request Security
  request_security:
    verify_ssl: true
    follow_redirects: true
    max_redirects: 10
    timeout: 30
    
  # Data Protection
  data_protection:
    sanitize_output: true
    remove_sensitive_data: true
    encrypt_storage: false  # Enable for production

# Logging Configuration
logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  
  # File Logging
  file:
    enabled: true
    path: "logs/opencrawler.log"
    max_size_mb: 100
    backup_count: 5
    rotation: "daily"
    
  # Console Logging
  console:
    enabled: true
    level: "INFO"
    colors: true
    
  # Structured Logging
  structured:
    enabled: false
    format: "json"

# Monitoring Configuration
monitoring:
  enabled: true
  metrics:
    enabled: true
    interval: 60  # seconds
    
  health_check:
    enabled: true
    interval: 30  # seconds
    endpoint: "/health"
    
  alerts:
    enabled: false
    email: ""
    webhook: ""

# Development Configuration
development:
  debug: false
  auto_reload: false
  profile: false
  
  # Testing
  test_mode: false
  mock_responses: false
  
  # Validation
  strict_validation: true
  schema_validation: true

# Production Overrides
production:
  debug: false
  auto_reload: false
  stealth:
    enabled: true
  performance:
    max_concurrent_requests: 20
  logging:
    level: "WARNING"
  security:
    enabled: true
    data_protection:
      encrypt_storage: true