SPAN: SPectral ANalysis software V6.6
Daniele Gasparri, June 2025


****Plot maps window****

This sub-program provides a simple and efficient way to visualize 2D maps from spectra processed from datacubes and fully processed with SPAN using the "DataCube extraction" routine and any Spectral analysis task applied.
You need two mandatory files in order to plot the maps:

1. The RUN_NAME_table.fits generated during the extraction process of the "DataCube extraction" routine, which contains the information of the Voronoi (or manual) spectral bins generated. This file is stored in the "SPAN_results/RUN_NAME" folder, once the datacube extraction is completed;
2. The RUN_NAME_*.dat file(s) generated by any spectral analysis routine on the same sample of 1D extracted spectra. This ASCII file is available once a spectral analysis task is performed on the spectra list conteining the spectral bins of the considered datacube, and the "Process all" mode is applied. 

**Optional file**  
If you want to overplot to the maps also the isophotal contour of your datacube image, therefore, you should browse and insert the FITS file containing the image, which has been automatically generated by the "Datacube extraction" sub-program and stored in the "SPAN_results/RUN_NAME" folder. This file has the suffix: "RUN_NAME_2dimage.fits"
If this image is provided, you can play with the contour levels to adjust the isophotal contours to your needs.  

**Plotting and saving the maps**  
Once the required files are browsed (they can be anywhere on your computer), just click "Load files" and in the listbox below will appear the quantities available to plot, taken from the ASCII .dat file loaded. You can change the color code of the maps in the "Colormap" menu and then you can plot any of these quantities and display an interactive map on a Matplotlib window by clicking "Plot Map". In this window, you can click on the map to show the identifier of the selected spectral bin and the relative information (e.g. velocity).

You can also perform a smoothing of the Voronoi bins (if Voronoi has been performed) and their values to create more pleasant plots. This is achieved by activating two options: 1) "Enable spaxel re-projection (show value per spaxel)", and 2) "Gaussian smoothing". Adjust the smooth value to your needs and see the results by clicking "Plot maps".
You can also change the plot limits, by inserting manual X and Y values (min-max).

Once you are satisfied, you can save the current map in high resolution PNG image by clicking the "Save selected" button, or you can automatically save the maps for all the quantities available by clicking the "Save all" button.