{"version":3,"file":"c8jZi83U.js","sources":["../../../../../../src/lib/components/channel/MessageInput/InputMenu.svelte","../../../../../../src/lib/components/channel/MessageInput.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { DropdownMenu } from 'bits-ui';\n\timport { flyAndScale } from '$lib/utils/transitions';\n\timport { getContext, onMount, tick } from 'svelte';\n\n\timport { config, user, tools as _tools, mobile } from '$lib/stores';\n\timport { getTools } from '$lib/apis/tools';\n\n\timport Dropdown from '$lib/components/common/Dropdown.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport DocumentArrowUpSolid from '$lib/components/icons/DocumentArrowUpSolid.svelte';\n\timport Switch from '$lib/components/common/Switch.svelte';\n\timport GlobeAltSolid from '$lib/components/icons/GlobeAltSolid.svelte';\n\timport WrenchSolid from '$lib/components/icons/WrenchSolid.svelte';\n\timport CameraSolid from '$lib/components/icons/CameraSolid.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let screenCaptureHandler: Function;\n\texport let uploadFilesHandler: Function;\n\n\texport let onClose: Function = () => {};\n\n\tlet show = false;\n\n\t$: if (show) {\n\t\tinit();\n\t}\n\n\tconst init = async () => {};\n</script>\n\n<Dropdown\n\tbind:show\n\ton:change={(e) => {\n\t\tif (e.detail === false) {\n\t\t\tonClose();\n\t\t}\n\t}}\n>\n\t<Tooltip content={$i18n.t('More')}>\n\t\t<slot />\n\t</Tooltip>\n\n\t<div slot=\"content\">\n\t\t<DropdownMenu.Content\n\t\t\tclass=\"w-full max-w-[200px] rounded-xl px-1 py-1  border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-sm\"\n\t\t\tsideOffset={15}\n\t\t\talignOffset={-8}\n\t\t\tside=\"top\"\n\t\t\talign=\"start\"\n\t\t\ttransition={flyAndScale}\n\t\t>\n\t\t\t{#if !$mobile}\n\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tscreenCaptureHandler();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<CameraSolid />\n\t\t\t\t\t<div class=\" line-clamp-1\">{$i18n.t('Capture')}</div>\n\t\t\t\t</DropdownMenu.Item>\n\t\t\t{/if}\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tuploadFilesHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<DocumentArrowUpSolid />\n\t\t\t\t<div class=\"line-clamp-1\">{$i18n.t('Upload Files')}</div>\n\t\t\t</DropdownMenu.Item>\n\t\t</DropdownMenu.Content>\n\t</div>\n</Dropdown>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { v4 as uuidv4 } from 'uuid';\n\timport heic2any from 'heic2any';\n\n\timport { tick, getContext, onMount, onDestroy } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\n\timport { config, mobile, settings, socket, user } from '$lib/stores';\n\timport {\n\t\tblobToFile,\n\t\tcompressImage,\n\t\textractInputVariables,\n\t\tgetCurrentDateTime,\n\t\tgetFormattedDate,\n\t\tgetFormattedTime,\n\t\tgetUserPosition,\n\t\tgetUserTimezone,\n\t\tgetWeekday\n\t} from '$lib/utils';\n\n\timport Tooltip from '../common/Tooltip.svelte';\n\timport RichTextInput from '../common/RichTextInput.svelte';\n\timport VoiceRecording from '../chat/MessageInput/VoiceRecording.svelte';\n\timport InputMenu from './MessageInput/InputMenu.svelte';\n\timport { uploadFile } from '$lib/apis/files';\n\timport { WEBUI_API_BASE_URL } from '$lib/constants';\n\timport FileItem from '../common/FileItem.svelte';\n\timport Image from '../common/Image.svelte';\n\timport FilesOverlay from '../chat/MessageInput/FilesOverlay.svelte';\n\timport Commands from '../chat/MessageInput/Commands.svelte';\n\timport InputVariablesModal from '../chat/MessageInput/InputVariablesModal.svelte';\n\n\texport let placeholder = $i18n.t('Send a Message');\n\texport let transparentBackground = false;\n\n\texport let id = null;\n\n\tlet draggedOver = false;\n\n\tlet recording = false;\n\tlet content = '';\n\tlet files = [];\n\n\texport let chatInputElement;\n\n\tlet commandsElement;\n\tlet filesInputElement;\n\tlet inputFiles;\n\n\texport let typingUsers = [];\n\texport let inputLoading = false;\n\n\texport let onSubmit: Function = (e) => {};\n\texport let onChange: Function = (e) => {};\n\texport let onStop: Function = (e) => {};\n\n\texport let scrollEnd = true;\n\texport let scrollToBottom: Function = () => {};\n\n\texport let acceptFiles = true;\n\texport let showFormattingButtons = true;\n\n\tlet showInputVariablesModal = false;\n\tlet inputVariables: Record<string, any> = {};\n\tlet inputVariableValues = {};\n\n\tconst inputVariableHandler = async (text: string) => {\n\t\tinputVariables = extractInputVariables(text);\n\t\tif (Object.keys(inputVariables).length > 0) {\n\t\t\tshowInputVariablesModal = true;\n\t\t}\n\t};\n\n\tconst textVariableHandler = async (text: string) => {\n\t\tif (text.includes('{{CLIPBOARD}}')) {\n\t\t\tconst clipboardText = await navigator.clipboard.readText().catch((err) => {\n\t\t\t\ttoast.error($i18n.t('Failed to read clipboard contents'));\n\t\t\t\treturn '{{CLIPBOARD}}';\n\t\t\t});\n\n\t\t\tconst clipboardItems = await navigator.clipboard.read();\n\n\t\t\tlet imageUrl = null;\n\t\t\tfor (const item of clipboardItems) {\n\t\t\t\t// Check for known image types\n\t\t\t\tfor (const type of item.types) {\n\t\t\t\t\tif (type.startsWith('image/')) {\n\t\t\t\t\t\tconst blob = await item.getType(type);\n\t\t\t\t\t\timageUrl = URL.createObjectURL(blob);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (imageUrl) {\n\t\t\t\tfiles = [\n\t\t\t\t\t...files,\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: 'image',\n\t\t\t\t\t\turl: imageUrl\n\t\t\t\t\t}\n\t\t\t\t];\n\t\t\t}\n\n\t\t\ttext = text.replaceAll('{{CLIPBOARD}}', clipboardText);\n\t\t}\n\n\t\tif (text.includes('{{USER_LOCATION}}')) {\n\t\t\tlet location;\n\t\t\ttry {\n\t\t\t\tlocation = await getUserPosition();\n\t\t\t} catch (error) {\n\t\t\t\ttoast.error($i18n.t('Location access not allowed'));\n\t\t\t\tlocation = 'LOCATION_UNKNOWN';\n\t\t\t}\n\t\t\ttext = text.replaceAll('{{USER_LOCATION}}', String(location));\n\t\t}\n\n\t\tif (text.includes('{{USER_NAME}}')) {\n\t\t\tconst name = $user?.name || 'User';\n\t\t\ttext = text.replaceAll('{{USER_NAME}}', name);\n\t\t}\n\n\t\tif (text.includes('{{USER_LANGUAGE}}')) {\n\t\t\tconst language = localStorage.getItem('locale') || 'en-US';\n\t\t\ttext = text.replaceAll('{{USER_LANGUAGE}}', language);\n\t\t}\n\n\t\tif (text.includes('{{CURRENT_DATE}}')) {\n\t\t\tconst date = getFormattedDate();\n\t\t\ttext = text.replaceAll('{{CURRENT_DATE}}', date);\n\t\t}\n\n\t\tif (text.includes('{{CURRENT_TIME}}')) {\n\t\t\tconst time = getFormattedTime();\n\t\t\ttext = text.replaceAll('{{CURRENT_TIME}}', time);\n\t\t}\n\n\t\tif (text.includes('{{CURRENT_DATETIME}}')) {\n\t\t\tconst dateTime = getCurrentDateTime();\n\t\t\ttext = text.replaceAll('{{CURRENT_DATETIME}}', dateTime);\n\t\t}\n\n\t\tif (text.includes('{{CURRENT_TIMEZONE}}')) {\n\t\t\tconst timezone = getUserTimezone();\n\t\t\ttext = text.replaceAll('{{CURRENT_TIMEZONE}}', timezone);\n\t\t}\n\n\t\tif (text.includes('{{CURRENT_WEEKDAY}}')) {\n\t\t\tconst weekday = getWeekday();\n\t\t\ttext = text.replaceAll('{{CURRENT_WEEKDAY}}', weekday);\n\t\t}\n\n\t\tinputVariableHandler(text);\n\t\treturn text;\n\t};\n\n\tconst replaceVariables = (variables: Record<string, any>) => {\n\t\tif (!chatInputElement) return;\n\t\tconsole.log('Replacing variables:', variables);\n\n\t\tchatInputElement.replaceVariables(variables);\n\t\tchatInputElement.focus();\n\t};\n\n\texport const setText = async (text?: string) => {\n\t\tif (!chatInputElement) return;\n\n\t\ttext = await textVariableHandler(text || '');\n\n\t\tchatInputElement?.setText(text);\n\t\tchatInputElement?.focus();\n\t};\n\n\tconst getCommand = () => {\n\t\tif (!chatInputElement) return;\n\n\t\tlet word = '';\n\t\tword = chatInputElement?.getWordAtDocPos();\n\n\t\treturn word;\n\t};\n\n\tconst replaceCommandWithText = (text) => {\n\t\tif (!chatInputElement) return;\n\n\t\tchatInputElement?.replaceCommandWithText(text);\n\t};\n\n\tconst insertTextAtCursor = async (text: string) => {\n\t\ttext = await textVariableHandler(text);\n\n\t\tif (command) {\n\t\t\treplaceCommandWithText(text);\n\t\t} else {\n\t\t\tconst selection = window.getSelection();\n\t\t\tif (selection && selection.rangeCount > 0) {\n\t\t\t\tconst range = selection.getRangeAt(0);\n\t\t\t\trange.deleteContents();\n\t\t\t\trange.insertNode(document.createTextNode(text));\n\t\t\t\trange.collapse(false);\n\t\t\t\tselection.removeAllRanges();\n\t\t\t\tselection.addRange(range);\n\t\t\t}\n\t\t}\n\n\t\tawait tick();\n\t\tconst chatInputContainer = document.getElementById('chat-input-container');\n\t\tif (chatInputContainer) {\n\t\t\tchatInputContainer.scrollTop = chatInputContainer.scrollHeight;\n\t\t}\n\n\t\tawait tick();\n\t\tif (chatInputElement) {\n\t\t\tchatInputElement.focus();\n\t\t}\n\t};\n\n\tlet command = '';\n\n\texport let showCommands = false;\n\t$: showCommands = ['/'].includes(command?.charAt(0));\n\n\tconst screenCaptureHandler = async () => {\n\t\ttry {\n\t\t\t// Request screen media\n\t\t\tconst mediaStream = await navigator.mediaDevices.getDisplayMedia({\n\t\t\t\tvideo: { cursor: 'never' },\n\t\t\t\taudio: false\n\t\t\t});\n\t\t\t// Once the user selects a screen, temporarily create a video element\n\t\t\tconst video = document.createElement('video');\n\t\t\tvideo.srcObject = mediaStream;\n\t\t\t// Ensure the video loads without affecting user experience or tab switching\n\t\t\tawait video.play();\n\t\t\t// Set up the canvas to match the video dimensions\n\t\t\tconst canvas = document.createElement('canvas');\n\t\t\tcanvas.width = video.videoWidth;\n\t\t\tcanvas.height = video.videoHeight;\n\t\t\t// Grab a single frame from the video stream using the canvas\n\t\t\tconst context = canvas.getContext('2d');\n\t\t\tcontext.drawImage(video, 0, 0, canvas.width, canvas.height);\n\t\t\t// Stop all video tracks (stop screen sharing) after capturing the image\n\t\t\tmediaStream.getTracks().forEach((track) => track.stop());\n\n\t\t\t// bring back focus to this current tab, so that the user can see the screen capture\n\t\t\twindow.focus();\n\n\t\t\t// Convert the canvas to a Base64 image URL\n\t\t\tconst imageUrl = canvas.toDataURL('image/png');\n\t\t\t// Add the captured image to the files array to render it\n\t\t\tfiles = [...files, { type: 'image', url: imageUrl }];\n\t\t\t// Clean memory: Clear video srcObject\n\t\t\tvideo.srcObject = null;\n\t\t} catch (error) {\n\t\t\t// Handle any errors (e.g., user cancels screen sharing)\n\t\t\tconsole.error('Error capturing screen:', error);\n\t\t}\n\t};\n\n\tconst inputFilesHandler = async (inputFiles) => {\n\t\tinputFiles.forEach(async (file) => {\n\t\t\tconsole.info('Processing file:', {\n\t\t\t\tname: file.name,\n\t\t\t\ttype: file.type,\n\t\t\t\tsize: file.size,\n\t\t\t\textension: file.name.split('.').at(-1)\n\t\t\t});\n\n\t\t\tif (\n\t\t\t\t($config?.file?.max_size ?? null) !== null &&\n\t\t\t\tfile.size > ($config?.file?.max_size ?? 0) * 1024 * 1024\n\t\t\t) {\n\t\t\t\tconsole.error('File exceeds max size limit:', {\n\t\t\t\t\tfileSize: file.size,\n\t\t\t\t\tmaxSize: ($config?.file?.max_size ?? 0) * 1024 * 1024\n\t\t\t\t});\n\t\t\t\ttoast.error(\n\t\t\t\t\t$i18n.t(`File size should not exceed {{maxSize}} MB.`, {\n\t\t\t\t\t\tmaxSize: $config?.file?.max_size\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (file['type'].startsWith('image/')) {\n\t\t\t\tconst compressImageHandler = async (imageUrl, settings = {}, config = {}) => {\n\t\t\t\t\t// Quick shortcut so we donâ€™t do unnecessary work.\n\t\t\t\t\tconst settingsCompression = settings?.imageCompression ?? false;\n\t\t\t\t\tconst configWidth = config?.file?.image_compression?.width ?? null;\n\t\t\t\t\tconst configHeight = config?.file?.image_compression?.height ?? null;\n\n\t\t\t\t\t// If neither settings nor config wants compression, return original URL.\n\t\t\t\t\tif (!settingsCompression && !configWidth && !configHeight) {\n\t\t\t\t\t\treturn imageUrl;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Default to null (no compression unless set)\n\t\t\t\t\tlet width = null;\n\t\t\t\t\tlet height = null;\n\n\t\t\t\t\t// If user/settings want compression, pick their preferred size.\n\t\t\t\t\tif (settingsCompression) {\n\t\t\t\t\t\twidth = settings?.imageCompressionSize?.width ?? null;\n\t\t\t\t\t\theight = settings?.imageCompressionSize?.height ?? null;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Apply config limits as an upper bound if any\n\t\t\t\t\tif (configWidth && (width === null || width > configWidth)) {\n\t\t\t\t\t\twidth = configWidth;\n\t\t\t\t\t}\n\t\t\t\t\tif (configHeight && (height === null || height > configHeight)) {\n\t\t\t\t\t\theight = configHeight;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Do the compression if required\n\t\t\t\t\tif (width || height) {\n\t\t\t\t\t\treturn await compressImage(imageUrl, width, height);\n\t\t\t\t\t}\n\t\t\t\t\treturn imageUrl;\n\t\t\t\t};\n\n\t\t\t\tlet reader = new FileReader();\n\n\t\t\t\treader.onload = async (event) => {\n\t\t\t\t\tlet imageUrl = event.target.result;\n\n\t\t\t\t\t// Compress the image if settings or config require it\n\t\t\t\t\timageUrl = await compressImageHandler(imageUrl, $settings, $config);\n\n\t\t\t\t\tfiles = [\n\t\t\t\t\t\t...files,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'image',\n\t\t\t\t\t\t\turl: `${imageUrl}`\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\t\t\t\t};\n\n\t\t\t\treader.readAsDataURL(\n\t\t\t\t\tfile['type'] === 'image/heic'\n\t\t\t\t\t\t? await heic2any({ blob: file, toType: 'image/jpeg' })\n\t\t\t\t\t\t: file\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tuploadFileHandler(file);\n\t\t\t}\n\t\t});\n\t};\n\n\tconst uploadFileHandler = async (file) => {\n\t\tconst tempItemId = uuidv4();\n\t\tconst fileItem = {\n\t\t\ttype: 'file',\n\t\t\tfile: '',\n\t\t\tid: null,\n\t\t\turl: '',\n\t\t\tname: file.name,\n\t\t\tcollection_name: '',\n\t\t\tstatus: 'uploading',\n\t\t\tsize: file.size,\n\t\t\terror: '',\n\t\t\titemId: tempItemId\n\t\t};\n\n\t\tif (fileItem.size == 0) {\n\t\t\ttoast.error($i18n.t('You cannot upload an empty file.'));\n\t\t\treturn null;\n\t\t}\n\n\t\tfiles = [...files, fileItem];\n\n\t\ttry {\n\t\t\t// During the file upload, file content is automatically extracted.\n\n\t\t\t// If the file is an audio file, provide the language for STT.\n\t\t\tlet metadata = null;\n\t\t\tif (\n\t\t\t\t(file.type.startsWith('audio/') || file.type.startsWith('video/')) &&\n\t\t\t\t$settings?.audio?.stt?.language\n\t\t\t) {\n\t\t\t\tmetadata = {\n\t\t\t\t\tlanguage: $settings?.audio?.stt?.language\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst uploadedFile = await uploadFile(localStorage.token, file, metadata);\n\n\t\t\tif (uploadedFile) {\n\t\t\t\tconsole.info('File upload completed:', {\n\t\t\t\t\tid: uploadedFile.id,\n\t\t\t\t\tname: fileItem.name,\n\t\t\t\t\tcollection: uploadedFile?.meta?.collection_name\n\t\t\t\t});\n\n\t\t\t\tif (uploadedFile.error) {\n\t\t\t\t\tconsole.error('File upload warning:', uploadedFile.error);\n\t\t\t\t\ttoast.warning(uploadedFile.error);\n\t\t\t\t}\n\n\t\t\t\tfileItem.status = 'uploaded';\n\t\t\t\tfileItem.file = uploadedFile;\n\t\t\t\tfileItem.id = uploadedFile.id;\n\t\t\t\tfileItem.collection_name =\n\t\t\t\t\tuploadedFile?.meta?.collection_name || uploadedFile?.collection_name;\n\t\t\t\tfileItem.url = `${WEBUI_API_BASE_URL}/files/${uploadedFile.id}`;\n\n\t\t\t\tfiles = files;\n\t\t\t} else {\n\t\t\t\tfiles = files.filter((item) => item?.itemId !== tempItemId);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\ttoast.error(`${e}`);\n\t\t\tfiles = files.filter((item) => item?.itemId !== tempItemId);\n\t\t}\n\t};\n\n\tconst handleKeyDown = (event: KeyboardEvent) => {\n\t\tif (event.key === 'Escape') {\n\t\t\tdraggedOver = false;\n\t\t}\n\t};\n\n\tconst onDragOver = (e) => {\n\t\te.preventDefault();\n\n\t\t// Check if a file is being draggedOver.\n\t\tif (e.dataTransfer?.types?.includes('Files')) {\n\t\t\tdraggedOver = true;\n\t\t} else {\n\t\t\tdraggedOver = false;\n\t\t}\n\t};\n\n\tconst onDragLeave = () => {\n\t\tdraggedOver = false;\n\t};\n\n\tconst onDrop = async (e) => {\n\t\te.preventDefault();\n\n\t\tif (e.dataTransfer?.files && acceptFiles) {\n\t\t\tconst inputFiles = Array.from(e.dataTransfer?.files);\n\t\t\tif (inputFiles && inputFiles.length > 0) {\n\t\t\t\tconsole.log(inputFiles);\n\t\t\t\tinputFilesHandler(inputFiles);\n\t\t\t}\n\t\t}\n\n\t\tdraggedOver = false;\n\t};\n\n\tconst submitHandler = async () => {\n\t\tif (content === '' && files.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tonSubmit({\n\t\t\tcontent,\n\t\t\tdata: {\n\t\t\t\tfiles: files\n\t\t\t}\n\t\t});\n\n\t\tcontent = '';\n\t\tfiles = [];\n\n\t\tif (chatInputElement) {\n\t\t\tchatInputElement?.setText('');\n\n\t\t\tawait tick();\n\n\t\t\tchatInputElement.focus();\n\t\t}\n\t};\n\n\t$: if (content) {\n\t\tonChange();\n\t}\n\n\tonMount(async () => {\n\t\twindow.setTimeout(() => {\n\t\t\tif (chatInputElement) {\n\t\t\t\tchatInputElement.focus();\n\t\t\t}\n\t\t}, 100);\n\n\t\twindow.addEventListener('keydown', handleKeyDown);\n\t\tawait tick();\n\n\t\tconst dropzoneElement = document.getElementById('channel-container');\n\n\t\tdropzoneElement?.addEventListener('dragover', onDragOver);\n\t\tdropzoneElement?.addEventListener('drop', onDrop);\n\t\tdropzoneElement?.addEventListener('dragleave', onDragLeave);\n\t});\n\n\tonDestroy(() => {\n\t\twindow.removeEventListener('keydown', handleKeyDown);\n\n\t\tconst dropzoneElement = document.getElementById('channel-container');\n\n\t\tif (dropzoneElement) {\n\t\t\tdropzoneElement?.removeEventListener('dragover', onDragOver);\n\t\t\tdropzoneElement?.removeEventListener('drop', onDrop);\n\t\t\tdropzoneElement?.removeEventListener('dragleave', onDragLeave);\n\t\t}\n\t});\n</script>\n\n<FilesOverlay show={draggedOver} />\n\n{#if acceptFiles}\n\t<input\n\t\tbind:this={filesInputElement}\n\t\tbind:files={inputFiles}\n\t\ttype=\"file\"\n\t\thidden\n\t\tmultiple\n\t\ton:change={async () => {\n\t\t\tif (inputFiles && inputFiles.length > 0) {\n\t\t\t\tinputFilesHandler(Array.from(inputFiles));\n\t\t\t} else {\n\t\t\t\ttoast.error($i18n.t(`File not found.`));\n\t\t\t}\n\n\t\t\tfilesInputElement.value = '';\n\t\t}}\n\t/>\n{/if}\n\n<InputVariablesModal\n\tbind:show={showInputVariablesModal}\n\tvariables={inputVariables}\n\tonSave={(variableValues) => {\n\t\tinputVariableValues = { ...inputVariableValues, ...variableValues };\n\t\treplaceVariables(inputVariableValues);\n\t}}\n/>\n\n<div class=\"bg-transparent\">\n\t<div\n\t\tclass=\"{($settings?.widescreenMode ?? null)\n\t\t\t? 'max-w-full'\n\t\t\t: 'max-w-6xl'}  mx-auto inset-x-0 relative\"\n\t>\n\t\t<div class=\"absolute top-0 left-0 right-0 mx-auto inset-x-0 bg-transparent flex justify-center\">\n\t\t\t<div class=\"flex flex-col px-3 w-full\">\n\t\t\t\t<div class=\"relative\">\n\t\t\t\t\t{#if scrollEnd === false}\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\" absolute -top-12 left-0 right-0 flex justify-center z-30 pointer-events-none\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\" bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full pointer-events-auto\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tscrollEnd = true;\n\t\t\t\t\t\t\t\t\tscrollToBottom();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\tclass=\"w-5 h-5\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\td=\"M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z\"\n\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"relative\">\n\t\t\t\t\t<div class=\" -mt-5\">\n\t\t\t\t\t\t{#if typingUsers.length > 0}\n\t\t\t\t\t\t\t<div class=\" text-xs px-4 mb-1\">\n\t\t\t\t\t\t\t\t<span class=\" font-normal text-black dark:text-white\">\n\t\t\t\t\t\t\t\t\t{typingUsers.map((user) => user.name).join(', ')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t{$i18n.t('is typing...')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<Commands\n\t\t\t\t\t\tbind:this={commandsElement}\n\t\t\t\t\t\tshow={showCommands}\n\t\t\t\t\t\t{command}\n\t\t\t\t\t\tinsertTextHandler={insertTextAtCursor}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"\">\n\t\t\t{#if recording}\n\t\t\t\t<VoiceRecording\n\t\t\t\t\tbind:recording\n\t\t\t\t\tonCancel={async () => {\n\t\t\t\t\t\trecording = false;\n\n\t\t\t\t\t\tawait tick();\n\n\t\t\t\t\t\tif (chatInputElement) {\n\t\t\t\t\t\t\tchatInputElement.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\tonConfirm={async (data) => {\n\t\t\t\t\t\tconst { text, filename } = data;\n\t\t\t\t\t\trecording = false;\n\n\t\t\t\t\t\tawait tick();\n\t\t\t\t\t\tinsertTextAtCursor(text);\n\n\t\t\t\t\t\tawait tick();\n\n\t\t\t\t\t\tif (chatInputElement) {\n\t\t\t\t\t\t\tchatInputElement.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t{:else}\n\t\t\t\t<form\n\t\t\t\t\tclass=\"w-full flex gap-1.5\"\n\t\t\t\t\ton:submit|preventDefault={() => {\n\t\t\t\t\t\tsubmitHandler();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"flex-1 flex flex-col relative w-full rounded-3xl px-1 bg-gray-600/5 dark:bg-gray-400/5 dark:text-gray-100\"\n\t\t\t\t\t\tdir={$settings?.chatDirection ?? 'auto'}\n\t\t\t\t\t>\n\t\t\t\t\t\t{#if files.length > 0}\n\t\t\t\t\t\t\t<div class=\"mx-2 mt-2.5 -mb-1 flex flex-wrap gap-2\">\n\t\t\t\t\t\t\t\t{#each files as file, fileIdx}\n\t\t\t\t\t\t\t\t\t{#if file.type === 'image'}\n\t\t\t\t\t\t\t\t\t\t<div class=\" relative group\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"relative\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Image\n\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={file.url}\n\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"input\"\n\t\t\t\t\t\t\t\t\t\t\t\t\timageClassName=\" h-16 w-16 rounded-xl object-cover\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\" absolute -top-1 -right-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\" bg-white text-black border border-white rounded-full group-hover:visible invisible transition\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles.splice(fileIdx, 1);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles = files;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t<FileItem\n\t\t\t\t\t\t\t\t\t\t\titem={file}\n\t\t\t\t\t\t\t\t\t\t\tname={file.name}\n\t\t\t\t\t\t\t\t\t\t\ttype={file.type}\n\t\t\t\t\t\t\t\t\t\t\tsize={file?.size}\n\t\t\t\t\t\t\t\t\t\t\tloading={file.status === 'uploading'}\n\t\t\t\t\t\t\t\t\t\t\tdismissible={true}\n\t\t\t\t\t\t\t\t\t\t\tedit={true}\n\t\t\t\t\t\t\t\t\t\t\ton:dismiss={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tfiles.splice(fileIdx, 1);\n\t\t\t\t\t\t\t\t\t\t\t\tfiles = files;\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(file);\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t<div class=\"px-2.5\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"scrollbar-hidden font-primary text-left bg-transparent dark:text-gray-100 outline-hidden w-full pt-3 px-1 resize-none h-fit max-h-80 overflow-auto\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<RichTextInput\n\t\t\t\t\t\t\t\t\tbind:this={chatInputElement}\n\t\t\t\t\t\t\t\t\tjson={true}\n\t\t\t\t\t\t\t\t\tmessageInput={true}\n\t\t\t\t\t\t\t\t\t{showFormattingButtons}\n\t\t\t\t\t\t\t\t\tshiftEnter={!($settings?.ctrlEnterToSend ?? false) &&\n\t\t\t\t\t\t\t\t\t\t(!$mobile ||\n\t\t\t\t\t\t\t\t\t\t\t!(\n\t\t\t\t\t\t\t\t\t\t\t\t'ontouchstart' in window ||\n\t\t\t\t\t\t\t\t\t\t\t\tnavigator.maxTouchPoints > 0 ||\n\t\t\t\t\t\t\t\t\t\t\t\tnavigator.msMaxTouchPoints > 0\n\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\tlargeTextAsFile={$settings?.largeTextAsFile ?? false}\n\t\t\t\t\t\t\t\t\tfloatingMenuPlacement={'top-start'}\n\t\t\t\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\t\t\t\tconst { md } = e;\n\t\t\t\t\t\t\t\t\t\tcontent = md;\n\t\t\t\t\t\t\t\t\t\tcommand = getCommand();\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\ton:keydown={async (e) => {\n\t\t\t\t\t\t\t\t\t\te = e.detail.event;\n\t\t\t\t\t\t\t\t\t\tconst isCtrlPressed = e.ctrlKey || e.metaKey; // metaKey is for Cmd key on Mac\n\n\t\t\t\t\t\t\t\t\t\tconst commandsContainerElement = document.getElementById('commands-container');\n\n\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement) {\n\t\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement && e.key === 'ArrowUp') {\n\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\tcommandsElement.selectUp();\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst commandOptionButton = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('selected-command-option-button')\n\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\t\t\t\t\t\t\t\t\t\t\t\tcommandOptionButton.scrollIntoView({ block: 'center' });\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement && e.key === 'ArrowDown') {\n\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\tcommandsElement.selectDown();\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst commandOptionButton = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('selected-command-option-button')\n\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\t\t\t\t\t\t\t\t\t\t\t\tcommandOptionButton.scrollIntoView({ block: 'center' });\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement && e.key === 'Tab') {\n\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst commandOptionButton = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('selected-command-option-button')\n\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\n\t\t\t\t\t\t\t\t\t\t\t\tcommandOptionButton?.click();\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement && e.key === 'Enter') {\n\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst commandOptionButton = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('selected-command-option-button')\n\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (commandOptionButton) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcommandOptionButton?.click();\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById('send-message-button')?.click();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t\t!$mobile ||\n\t\t\t\t\t\t\t\t\t\t\t\t!(\n\t\t\t\t\t\t\t\t\t\t\t\t\t'ontouchstart' in window ||\n\t\t\t\t\t\t\t\t\t\t\t\t\tnavigator.maxTouchPoints > 0 ||\n\t\t\t\t\t\t\t\t\t\t\t\t\tnavigator.msMaxTouchPoints > 0\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\t\t// Prevent Enter key from creating a new line\n\t\t\t\t\t\t\t\t\t\t\t\t// Uses keyCode '13' for Enter key for chinese/japanese keyboards\n\t\t\t\t\t\t\t\t\t\t\t\tif (e.keyCode === 13 && !e.shiftKey) {\n\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t// Submit the content when Enter key is pressed\n\t\t\t\t\t\t\t\t\t\t\t\tif (content !== '' && e.keyCode === 13 && !e.shiftKey) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tsubmitHandler();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif (e.key === 'Escape') {\n\t\t\t\t\t\t\t\t\t\t\tconsole.info('Escape');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\ton:paste={async (e) => {\n\t\t\t\t\t\t\t\t\t\te = e.detail.event;\n\t\t\t\t\t\t\t\t\t\tconsole.info(e);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\" flex justify-between mb-2.5 mt-1.5 mx-0.5\">\n\t\t\t\t\t\t\t<div class=\"ml-1 self-end flex space-x-1 flex-1\">\n\t\t\t\t\t\t\t\t<slot name=\"menu\">\n\t\t\t\t\t\t\t\t\t{#if acceptFiles}\n\t\t\t\t\t\t\t\t\t\t<InputMenu\n\t\t\t\t\t\t\t\t\t\t\t{screenCaptureHandler}\n\t\t\t\t\t\t\t\t\t\t\tuploadFilesHandler={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tfilesInputElement.click();\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"bg-transparent hover:bg-white/80 text-gray-800 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5 outline-hidden focus:outline-hidden\"\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"More\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t</InputMenu>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</slot>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\"self-end flex space-x-1 mr-1\">\n\t\t\t\t\t\t\t\t{#if content === ''}\n\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Record voice')}>\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tid=\"voice-input-button\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\" text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200 transition rounded-full p-1.5 mr-0.5 self-center\"\n\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet stream = await navigator.mediaDevices\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.getUserMedia({ audio: true })\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.catch(function (err) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$i18n.t(`Permission denied when accessing microphone: {{error}}`, {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\terror: err\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (stream) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trecording = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst tracks = stream.getTracks();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttracks.forEach((track) => track.stop());\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tstream = null;\n\t\t\t\t\t\t\t\t\t\t\t\t} catch {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error($i18n.t('Permission denied when accessing microphone'));\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\taria-label=\"Voice Input\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-5 h-5 translate-y-[0.5px]\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<path d=\"M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z\" />\n\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t\t<div class=\" flex items-center\">\n\t\t\t\t\t\t\t\t\t{#if inputLoading && onStop}\n\t\t\t\t\t\t\t\t\t\t<div class=\" flex items-center\">\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Stop')}>\n\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonStop();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t<div class=\" flex items-center\">\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Send message')}>\n\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"send-message-button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{content !== '' || files.length !== 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 '\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled'} transition rounded-full p-1.5 self-center\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={content === '' && files.length === 0}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n</div>\n"],"names":["ctx","insert_hydration","target","div","anchor","set_data","t1","t1_value","create_if_block","flyAndScale","i18n","getContext","screenCaptureHandler","$$props","uploadFilesHandler","onClose","show","init","e","input","append_hydration","button","t0_value","func_1","span","dirty","t0","t2","t2_value","create_if_block_4","_a","_b","if_block1","create_if_block_2","form","div6","div1","div0","div5","div2","div4","div3","_c","i","each_blocks","fileitem_changes","image_changes","create_if_block_3","attr","button_class_value","button_disabled_value","svg","path","create_if_block_8","create_if_block_7","create_if_block_6","div7","user","placeholder","$i18n","transparentBackground","id","draggedOver","recording","content","files","chatInputElement","commandsElement","filesInputElement","inputFiles","typingUsers","inputLoading","onSubmit","onChange","onStop","scrollEnd","scrollToBottom","acceptFiles","showFormattingButtons","showInputVariablesModal","inputVariables","inputVariableValues","inputVariableHandler","text","$$invalidate","extractInputVariables","textVariableHandler","clipboardText","err","toast","clipboardItems","imageUrl","item","type","blob","location","getUserPosition","name","$user","language","date","getFormattedDate","time","getFormattedTime","dateTime","getCurrentDateTime","timezone","getUserTimezone","weekday","getWeekday","replaceVariables","variables","setText","getCommand","word","replaceCommandWithText","insertTextAtCursor","command","selection","range","tick","chatInputContainer","showCommands","mediaStream","video","canvas","track","error","inputFilesHandler","file","$config","_d","compressImageHandler","settings","config","settingsCompression","configWidth","configHeight","width","height","compressImage","reader","event","$settings","heic2any","uploadFileHandler","tempItemId","uuidv4","fileItem","metadata","uploadedFile","uploadFile","_e","_f","WEBUI_API_BASE_URL","handleKeyDown","onDragOver","onDragLeave","onDrop","submitHandler","onMount","dropzoneElement","onDestroy","$$value","variableValues","value","data","filename","fileIdx","md","commandsContainerElement","commandOptionButton","$mobile","stream"],"mappings":"82CAwCmBA,EAAK,CAAA,EAAC,EAAE,MAAM,qJAAdA,EAAK,CAAA,EAAC,EAAE,MAAM,imBAqBAA,EAAK,CAAA,EAAC,EAAE,SAAS,EAAA,iPAA7CC,EAAoDC,EAAAC,EAAAC,CAAA,yCAAxBJ,EAAK,CAAA,EAAC,EAAE,SAAS,EAAA,KAAAK,GAAAC,EAAAC,CAAA,4HAWnBP,EAAK,CAAA,EAAC,EAAE,cAAc,EAAA,iPAAjDC,EAAwDC,EAAAC,EAAAC,CAAA,yCAA7BJ,EAAK,CAAA,EAAC,EAAE,cAAc,EAAA,KAAAK,GAAAC,EAAAC,CAAA,6HAnB5CP,EAAO,CAAA,GAAAQ,GAAAR,CAAA,0VAAPA,EAAO,CAAA,oeAND,sDAIAS,2MAPdR,EA+BKC,EAAAC,EAAAC,CAAA,+sBA3DC,MAAAM,EAAOC,GAAW,MAAM,sBAEnB,GAAA,CAAA,qBAAAC,CAAA,EAAAC,EACA,CAAA,mBAAAC,CAAA,EAAAD,EAEA,CAAA,QAAAE,EAAA,IAAA,MAEPC,EAAO,GAML,MAAAC,EAAA,SAAA,UA4BDL,YAWDE,sCAlCQI,GAAC,CACRA,EAAE,SAAW,IAChBH,yOAXKC,GACNC,kZCweDhB,EAeCC,EAAAiB,EAAAf,CAAA,43BAsBIH,EAuBKC,EAAAC,EAAAC,CAAA,EApBJgB,EAmBQjB,EAAAkB,CAAA,uFAULC,EAAAtB,EAAY,CAAA,EAAA,IAAyBuB,EAAA,EAAA,KAAK,IAAI,EAAA,SAE/CvB,EAAK,EAAA,EAAC,EAAE,cAAc,EAAA,qTAJxBC,EAKKC,EAAAC,EAAAC,CAAA,EAJJgB,EAEMjB,EAAAqB,CAAA,+BADJC,EAAA,CAAA,EAAA,GAAAH,KAAAA,EAAAtB,EAAY,CAAA,EAAA,IAAyBuB,EAAA,EAAA,KAAK,IAAI,EAAA,KAAAlB,GAAAqB,EAAAJ,CAAA,uBAE/CtB,EAAK,EAAA,EAAC,EAAE,cAAc,EAAA,KAAAK,GAAAsB,EAAAC,CAAA,uFAqDpB5B,EAAK,EAAA,EAAC,OAAS,GAAC6B,GAAA7B,CAAA,WA8DZ,gBACQ,6CAEA8B,GAAA9B,EAAS,EAAA,IAAT,YAAA8B,GAAW,kBAAmB,OACzC9B,EAAO,EAAA,GAAA,EAEP,iBAAkB,QAClB,UAAU,eAAiB,GAC3B,UAAU,iBAAmB,sBAEf+B,GAAA/B,EAAS,EAAA,IAAT,YAAA+B,GAAW,kBAAmB,yBACxB,yJA0HnB,IAAAC,EAAAhC,OAAY,IAAEiC,GAAAjC,CAAA,wCA+Cb,OAAAA,MAAgBA,EAAM,CAAA,EAAA,usCApPzB8B,EAAA9B,EAAS,EAAA,IAAT,YAAA8B,EAAW,gBAAiB,MAAM,6CARzC7B,EAmTMC,EAAAgC,EAAA9B,CAAA,EA7SLgB,EA4SKc,EAAAC,CAAA,wBAhPJf,EAyGKe,EAAAC,CAAA,EAxGJhB,EAuGKgB,EAAAC,CAAA,qBAGNjB,EAoIKe,EAAAG,CAAA,EAnIJlB,EA4BKkB,EAAAC,CAAA,wBAELnB,EAoGKkB,EAAAE,CAAA,wBArDJpB,EAoDKoB,EAAAC,CAAA,8EArSFzC,EAAK,EAAA,EAAC,OAAS,0LAiEH8B,EAAA9B,EAAS,EAAA,IAAT,YAAA8B,EAAW,kBAAmB,OACzC9B,EAAO,EAAA,GAAA,EAEP,iBAAkB,QAClB,UAAU,eAAiB,GAC3B,UAAU,iBAAmB,wCAEf+B,EAAA/B,EAAS,EAAA,IAAT,YAAA+B,EAAW,kBAAmB,2KA2H3C/B,OAAY,wQArMd0C,GAAA1C,EAAS,EAAA,IAAT,YAAA0C,GAAW,gBAAiB,0sBAIxB1C,EAAK,EAAA,CAAA,uBAAV,OAAI2C,GAAA,wSADP1C,EAoDKC,EAAAC,EAAAC,CAAA,mFAnDGJ,EAAK,EAAA,CAAA,oBAAV,OAAI,GAAA,EAAA,4GAAJ,OAAI,EAAA4C,EAAA,OAAA,GAAA,0CAAJ,OAAID,GAAA,uOAkCG3C,EAAI,EAAA,EACJ,KAAAA,MAAK,KACL,KAAAA,MAAK,KACL,MAAA8B,EAAA9B,QAAA,YAAA8B,EAAM,aACH9B,EAAI,EAAA,EAAC,SAAW,wBACZ,QACP,+JANAA,EAAI,EAAA,GACJyB,EAAA,CAAA,EAAA,OAAAoB,EAAA,KAAA7C,MAAK,MACLyB,EAAA,CAAA,EAAA,OAAAoB,EAAA,KAAA7C,MAAK,MACLyB,EAAA,CAAA,EAAA,OAAAoB,EAAA,MAAAf,EAAA9B,QAAA,YAAA8B,EAAM,4BACH9B,EAAI,EAAA,EAAC,SAAW,wcAjClB,IAAAA,MAAK,kuBAHbC,EA6BKC,EAAAqC,EAAAnC,CAAA,EA5BJgB,EAMKmB,EAAAF,CAAA,qBACLjB,EAoBKmB,EAAAH,CAAA,EAnBJhB,EAkBQgB,EAAAf,CAAA,iEAxBFI,EAAA,CAAA,EAAA,OAAAqB,EAAA,IAAA9C,MAAK,qLAJTA,EAAI,EAAA,EAAC,OAAS,QAAO,82CA0KxBC,EAeQC,EAAAmB,EAAAjB,CAAA,gDAtBLJ,EAAW,CAAA,GAAA+C,GAAA/C,CAAA,8FAAXA,EAAW,CAAA,sOA8BEA,EAAK,EAAA,EAAC,EAAE,cAAc,6JAAtBA,EAAK,EAAA,EAAC,EAAE,cAAc,y9BACvCC,EAwCQC,EAAAmB,EAAAjB,CAAA,yHA+BWJ,EAAK,EAAA,EAAC,EAAE,cAAc,sNADzCC,EAwBKC,EAAAC,EAAAC,CAAA,+DAvBcJ,EAAK,EAAA,EAAC,EAAE,cAAc,kNAxBtBA,EAAK,EAAA,EAAC,EAAE,MAAM,sNADjCC,EAsBKC,EAAAC,EAAAC,CAAA,+DArBcJ,EAAK,EAAA,EAAC,EAAE,MAAM,00BA2BtBgD,EAAA3B,EAAA,QAAA4B,GAAAjD,OAAY,IAAMA,EAAK,EAAA,EAAC,SAAW,EACxC,8FACA,uEAAqE,4CAAA,uBAE9DqB,EAAA,SAAA6B,EAAAlD,OAAY,IAAMA,EAAM,EAAA,EAAA,SAAW,UAN9CC,EAoBQC,EAAAmB,EAAAjB,CAAA,EAZPgB,EAWKC,EAAA8B,CAAA,EALJ/B,EAIC+B,EAAAC,CAAA,UAhBM3B,EAAA,CAAA,EAAA,MAAAwB,KAAAA,GAAAjD,OAAY,IAAMA,EAAK,EAAA,EAAC,SAAW,EACxC,8FACA,uEAAqE,8DAE9DyB,EAAA,CAAA,EAAA,MAAAyB,KAAAA,EAAAlD,OAAY,IAAMA,EAAM,EAAA,EAAA,SAAW,2wBA9B9CC,EAkBQC,EAAAmB,EAAAjB,CAAA,uJAtYAJ,EAAW,EAAA,CAAA,CAAA,CAAA,QAE1BA,EAAW,CAAA,GAAAqD,GAAArD,CAAA,0CAqBJA,EAAc,EAAA,gBADdA,EAAuB,EAAA,IAAA,gBAAvBA,EAAuB,EAAA,mDAiBzB,IAAAgC,EAAAhC,OAAc,IAAKsD,GAAAtD,CAAA,IA8BlBA,EAAW,CAAA,EAAC,OAAS,GAACuD,GAAAvD,CAAA,WAYrBA,EAAY,CAAA,kCAECA,EAAkB,EAAA,+EAOnCA,EAAS,EAAA,EAAA,8hCA1DN8B,EAAA9B,EAAS,EAAA,IAAT,YAAA8B,EAAW,iBAAkB,KACnC,aACA,aAAW,6BAAA,iGAJhB7B,EA8YKC,EAAAsD,EAAApD,CAAA,EA7YJgB,EA4YKoC,EAAArB,CAAA,EAvYJf,EAmDKe,EAAAK,CAAA,EAlDJpB,EAiDKoB,EAAAC,CAAA,EAhDJrB,EA2BKqB,EAAAJ,CAAA,wBAELjB,EAkBKqB,EAAAF,CAAA,EAjBJnB,EASKmB,EAAAH,CAAA,2CAYRhB,EAiVKe,EAAAG,CAAA,oEA1aatC,EAAW,EAAA,aAE1BA,EAAW,CAAA,yGAqBJA,EAAc,EAAA,+DADdA,EAAuB,EAAA,0BAiBzBA,OAAc,6DA8BbA,EAAW,CAAA,EAAC,OAAS,uFAYpBA,EAAY,CAAA,yNAjDb8B,EAAA9B,EAAS,EAAA,IAAT,YAAA8B,EAAW,iBAAkB,KACnC,aACA,aAAW,0TAsCW2B,GAASA,EAAK,4JAhkBlC,MAAA/C,EAAOC,GAAW,MAAM,2BA2BnB,YAAA+C,EAAcC,EAAM,EAAE,gBAAgB,CAAA,EAAA9C,GACtC,sBAAA+C,EAAwB,EAAA,EAAA/C,GAExB,GAAAgD,EAAK,IAAA,EAAAhD,EAEZiD,EAAc,GAEdC,EAAY,GACZC,EAAU,GACVC,EAAA,CAAA,EAEO,CAAA,iBAAAC,CAAA,EAAArD,EAEPsD,EACAC,EACAC,GAEO,CAAA,YAAAC,GAAA,EAAA,EAAAzD,GACA,aAAA0D,EAAe,EAAA,EAAA1D,GAEf,SAAA2D,EAAsBtD,GAAA,OACtB,SAAAuD,EAAsBvD,GAAA,OACtB,OAAAwD,EAAoBxD,GAAA,OAEpB,UAAAyD,EAAY,EAAA,EAAA9D,EACZ,CAAA,eAAA+D,GAAA,IAAA,OAEA,YAAAC,GAAc,EAAA,EAAAhE,GACd,sBAAAiE,GAAwB,EAAA,EAAAjE,EAE/BkE,EAA0B,GAC1BC,EAAA,CAAA,EACAC,EAAA,CAAA,QAEEC,EAA8B,MAAAC,GAAA,CACnCC,EAAA,GAAAJ,EAAiBK,GAAsBF,CAAI,CAAA,EACvC,OAAO,KAAKH,CAAc,EAAE,OAAS,QACxCD,EAA0B,EAAA,GAItBO,EAA6B,MAAAH,GAAA,CAC9B,GAAAA,EAAK,SAAS,eAAe,EAAA,OAC1BI,EAAsB,MAAA,UAAU,UAAU,SAAA,EAAW,MAAOC,KACjEC,GAAM,MAAM9B,EAAM,EAAE,mCAAmC,CAAA,EAChD,kBAGF+B,EAAA,MAAuB,UAAU,UAAU,KAAA,MAE7CC,EAAW,eACJC,MAAQF,EAEP,UAAAG,MAAQD,GAAK,MACnB,GAAAC,GAAK,WAAW,QAAQ,EAAA,OACrBC,GAAa,MAAAF,GAAK,QAAQC,EAAI,EACpCF,EAAW,IAAI,gBAAgBG,EAAI,EAKlCH,QACH1B,EACI,CAAA,GAAAA,EAAA,CAEF,KAAM,QACN,IAAK0B,CAAA,CAAA,CAAA,EAKRR,EAAOA,EAAK,WAAW,gBAAiBI,CAAa,EAGlD,GAAAJ,EAAK,SAAS,mBAAmB,EAAA,CAChC,IAAAY,MAEHA,EAAiB,MAAAC,IACT,MAAA,CACRP,GAAM,MAAM9B,EAAM,EAAE,6BAA6B,CAAA,EACjDoC,EAAW,mBAEZZ,EAAOA,EAAK,WAAW,oBAAqB,OAAOY,CAAQ,CAAA,EAGxD,GAAAZ,EAAK,SAAS,eAAe,EAAA,CAC1B,MAAAc,GAAOC,GAAA,YAAAA,EAAO,OAAQ,OAC5Bf,EAAOA,EAAK,WAAW,gBAAiBc,CAAI,EAGzC,GAAAd,EAAK,SAAS,mBAAmB,EAAA,OAC9BgB,EAAW,aAAa,QAAQ,QAAQ,GAAK,QACnDhB,EAAOA,EAAK,WAAW,oBAAqBgB,CAAQ,EAGjD,GAAAhB,EAAK,SAAS,kBAAkB,EAAA,OAC7BiB,EAAOC,KACblB,EAAOA,EAAK,WAAW,mBAAoBiB,CAAI,EAG5C,GAAAjB,EAAK,SAAS,kBAAkB,EAAA,OAC7BmB,EAAOC,KACbpB,EAAOA,EAAK,WAAW,mBAAoBmB,CAAI,EAG5C,GAAAnB,EAAK,SAAS,sBAAsB,EAAA,OACjCqB,EAAWC,KACjBtB,EAAOA,EAAK,WAAW,uBAAwBqB,CAAQ,EAGpD,GAAArB,EAAK,SAAS,sBAAsB,EAAA,OACjCuB,EAAWC,KACjBxB,EAAOA,EAAK,WAAW,uBAAwBuB,CAAQ,EAGpD,GAAAvB,EAAK,SAAS,qBAAqB,EAAA,OAChCyB,EAAUC,KAChB1B,EAAOA,EAAK,WAAW,sBAAuByB,CAAO,EAGtD,OAAA1B,EAAqBC,CAAI,EAClBA,GAGF2B,EAAoBC,GAAA,CACpB7C,IAGLA,EAAiB,iBAAiB6C,CAAS,EAC3C7C,EAAiB,MAAA,IAGL8C,GAAiB,MAAA7B,GAAA,CACxBjB,IAELiB,EAAa,MAAAG,EAAoBH,GAAQ,EAAE,EAE3CjB,GAAA,MAAAA,EAAkB,QAAQiB,GAC1BjB,GAAA,MAAAA,EAAkB,UAGb+C,EAAA,IAAA,CACA,GAAA,CAAA/C,EAAA,WAEDgD,EAAO,GACX,OAAAA,EAAOhD,GAAA,YAAAA,EAAkB,kBAElBgD,GAGFC,GAA0BhC,GAAA,CAC1BjB,IAELA,GAAA,MAAAA,EAAkB,uBAAuBiB,KAGpCiC,GAA4B,MAAAjC,GAAA,CAG7B,GAFJA,EAAA,MAAaG,EAAoBH,CAAI,EAEjCkC,GACHF,GAAuBhC,CAAI,OAErB,MAAAmC,EAAY,OAAO,eACrB,GAAAA,GAAaA,EAAU,WAAa,EAAA,OACjCC,EAAQD,EAAU,WAAW,CAAC,EACpCC,EAAM,eAAA,EACNA,EAAM,WAAW,SAAS,eAAepC,CAAI,CAAA,EAC7CoC,EAAM,SAAS,EAAK,EACpBD,EAAU,gBAAA,EACVA,EAAU,SAASC,CAAK,GAIpB,MAAAC,GAAA,QACAC,EAAqB,SAAS,eAAe,sBAAsB,EACrEA,IACHA,EAAmB,UAAYA,EAAmB,cAG7C,MAAAD,GAAA,EACFtD,GACHA,EAAiB,MAAA,OAIfmD,GAAU,IAEH,aAAAK,GAAe,EAAA,EAAA7G,EAGpB,MAAAD,GAAA,SAAA,KAGE,MAAA+G,EAAA,MAAoB,UAAU,aAAa,gBAAA,CAChD,MAAS,CAAA,OAAQ,SACjB,MAAO,EAAA,CAAA,EAGFC,EAAQ,SAAS,cAAc,OAAO,EAC5CA,EAAM,UAAYD,QAEZC,EAAM,aAENC,EAAS,SAAS,cAAc,QAAQ,EAC9CA,EAAO,MAAQD,EAAM,WACrBC,EAAO,OAASD,EAAM,YAENC,EAAO,WAAW,IAAI,EAC9B,UAAUD,EAAO,EAAG,EAAGC,EAAO,MAAOA,EAAO,MAAM,EAE1DF,EAAY,UAAA,EAAY,QAASG,IAAUA,GAAM,KAAA,CAAA,EAGjD,OAAO,MAAA,QAGDnC,GAAWkC,EAAO,UAAU,WAAW,OAE7C5D,EAAY,CAAA,GAAAA,EAAA,CAAS,KAAM,QAAS,IAAK0B,EAAA,CAAA,CAAA,EAEzCiC,EAAM,UAAY,IACV,OAAAG,EAAA,CAER,QAAQ,MAAM,0BAA2BA,CAAK,IAI1CC,GAA2B3D,MAAAA,GAAAA,CAChCA,EAAW,QAAe,MAAA4D,GAAA,kBACzB,QAAQ,KAAK,mBAAA,CACZ,KAAMA,EAAK,KACX,KAAMA,EAAK,KACX,KAAMA,EAAK,KACX,UAAWA,EAAK,KAAK,MAAM,GAAG,EAAE,KAAK,OAIpCnG,EAAAoG,GAAA,YAAAA,EAAS,OAAT,YAAApG,EAAe,WAAY,QAAU,MACtCmG,EAAK,QAAQlG,EAAAmG,GAAA,YAAAA,EAAS,OAAT,YAAAnG,EAAe,WAAY,GAAK,KAAO,KAAA,CAEpD,QAAQ,MAAM,+BAAA,CACb,SAAUkG,EAAK,KACf,WAAUvF,GAAAwF,GAAA,YAAAA,EAAS,OAAT,YAAAxF,GAAe,WAAY,GAAK,KAAO,OAElD+C,GAAM,MACL9B,EAAM,EACL,8CAAA,CAAA,SAASwE,GAAAD,GAAA,YAAAA,EAAS,OAAT,YAAAC,GAAe,QAAA,CAAA,CAAA,YAMvBF,EAAK,KAAQ,WAAW,QAAQ,EAAA,CAC7B,MAAAG,GAAA,MAA8BzC,GAAU0C,EAAeC,CAAAA,EAAAA,EAAAA,KAAAA,uBAEtD,MAAAC,IAAsBF,GAAAA,YAAAA,EAAU,mBAAoB,GACpDG,KAAcF,IAAAA,GAAAA,GAAAA,YAAAA,EAAQ,OAARA,YAAAA,GAAc,oBAAdA,YAAAA,GAAiC,QAAS,KACxDG,KAAeH,IAAAA,GAAAA,GAAAA,YAAAA,EAAQ,OAARA,YAAAA,GAAc,oBAAdA,YAAAA,GAAiC,SAAU,KAG3D,GAAA,CAAAC,IAAA,CAAwBC,IAAgB,CAAAC,GACrC,OAAA9C,OAIJ+C,GAAQ,KACRC,GAAS,YAGTJ,KACHG,KAAQL,GAAAA,GAAAA,YAAAA,EAAU,uBAAVA,YAAAA,GAAgC,QAAS,KACjDM,KAASN,GAAAA,GAAAA,YAAAA,EAAU,uBAAVA,YAAAA,GAAgC,SAAU,MAIhDG,KAAgBE,KAAU,MAAQA,GAAQF,MAC7CE,GAAQF,IAELC,KAAiBE,KAAW,MAAQA,GAASF,MAChDE,GAASF,IAINC,IAASC,SACCC,GAAcjD,GAAU+C,GAAOC,EAAM,EAE5ChD,QAGJkD,GAAa,IAAA,WAEjBA,GAAO,OAAgB,MAAAC,IAAA,CAClB,IAAAnD,EAAWmD,GAAM,OAAO,OAG5BnD,EAAiB,MAAAyC,GAAqBzC,EAAUoD,EAAWb,CAAO,EAElE9C,EAAA,GAAAnB,EAAA,CAAA,GACIA,EAEF,CAAA,KAAM,QACN,IAAA,GAAQ0B,CAAQ,EAAA,CAAA,CAAA,GAKnBkD,GAAO,cACNZ,EAAK,OAAY,mBACRe,GAAW,CAAA,KAAMf,EAAM,OAAQ,YAAA,CAAA,EACrCA,CAAA,OAGJgB,GAAkBhB,CAAI,KAKnBgB,GAA2B,MAAAhB,GAAA,4BAC1BiB,EAAaC,KACbC,EAAA,CACL,KAAM,OACN,KAAM,GACN,GAAI,KACJ,IAAK,GACL,KAAMnB,EAAK,KACX,gBAAiB,GACjB,OAAQ,YACR,KAAMA,EAAK,KACX,MAAO,GACP,OAAQiB,GAGL,GAAAE,EAAS,MAAQ,EACpB,OAAA3D,GAAM,MAAM9B,EAAM,EAAE,kCAAkC,CAAA,EAC/C,KAGRyB,EAAA,GAAAnB,EAAA,CAAA,GAAYA,EAAOmF,CAAQ,CAAA,UAMtBC,EAAW,MAEbpB,EAAK,KAAK,WAAW,QAAQ,GAAKA,EAAK,KAAK,WAAW,QAAQ,MAChElG,IAAAD,EAAAiH,GAAA,YAAAA,EAAW,QAAX,YAAAjH,EAAkB,MAAlB,MAAAC,GAAuB,YAEvBsH,EAAA,CACC,UAAUlB,IAAAzF,GAAAqG,GAAA,YAAAA,EAAW,QAAX,YAAArG,GAAkB,MAAlB,YAAAyF,GAAuB,WAI7B,MAAAmB,EAAA,MAAqBC,GAAW,aAAa,MAAOtB,EAAMoB,CAAQ,EAEpEC,GACH,QAAQ,KAAK,yBAAA,CACZ,GAAIA,EAAa,GACjB,KAAMF,EAAS,KACf,YAAYI,GAAAF,GAAA,YAAAA,EAAc,OAAd,YAAAE,GAAoB,kBAG7BF,EAAa,QAChB,QAAQ,MAAM,uBAAwBA,EAAa,KAAK,EACxD7D,GAAM,QAAQ6D,EAAa,KAAK,GAGjCF,EAAS,OAAS,WAClBA,EAAS,KAAOE,EAChBF,EAAS,GAAKE,EAAa,GAC3BF,EAAS,kBACRK,GAAAH,GAAA,YAAAA,EAAc,OAAd,YAAAG,GAAoB,mBAAmBH,GAAA,YAAAA,EAAc,iBACtDF,EAAS,IAAS,GAAAM,EAAkB,UAAUJ,EAAa,EAAE,YAI7DlE,EAAA,GAAAnB,EAAQA,EAAM,OAAQ2B,KAASA,IAAA,YAAAA,GAAM,UAAWsD,CAAU,CAAA,CAEnD,OAAAhI,EAAA,CACRuE,GAAM,SAASvE,CAAC,EAAA,EAChBkE,EAAA,GAAAnB,EAAQA,EAAM,OAAQ2B,IAASA,GAAA,YAAAA,EAAM,UAAWsD,CAAU,CAAA,IAItDS,GAAiBb,GAAA,CAClBA,EAAM,MAAQ,eACjBhF,EAAc,EAAA,GAIV8F,GAAc1I,GAAA,SACnBA,EAAE,eAAA,GAGEa,GAAAD,EAAAZ,EAAE,eAAF,YAAAY,EAAgB,QAAhB,MAAAC,EAAuB,SAAS,cACnC+B,EAAc,EAAA,OAEdA,EAAc,EAAA,GAIV+F,GAAA,IAAA,MACL/F,EAAc,EAAA,GAGTgG,GAAgB,MAAA5I,GAAA,SAGjB,GAFJA,EAAE,eAAA,GAEEY,EAAAZ,EAAE,eAAF,MAAAY,EAAgB,OAAS+C,GAAA,CACtBR,MAAAA,EAAa,MAAM,MAAKtC,EAAAb,EAAE,eAAF,YAAAa,EAAgB,KAAK,EAC/CsC,GAAcA,EAAW,OAAS,GAErC2D,GAAkB3D,CAAU,OAI9BP,EAAc,EAAA,GAGTiG,GAAA,SAAA,CACD/F,IAAY,IAAMC,EAAM,SAAW,IAIvCO,EAAA,CACC,QAAAR,EACA,KACC,CAAA,MAAAC,CAAA,CAAA,CAAA,MAIFD,EAAU,EAAA,EACVoB,EAAA,GAAAnB,EAAA,CAAA,CAAA,EAEIC,IACHA,GAAA,MAAAA,EAAkB,QAAQ,IAEpB,MAAAsD,GAAA,EAENtD,EAAiB,MAAA,KAQnB8F,GAAA,SAAA,CACC,OAAO,gBACF9F,GACHA,EAAiB,MAAA,GAEhB,KAEH,OAAO,iBAAiB,UAAWyF,EAAa,EAC1C,MAAAnC,GAAA,QAEAyC,EAAkB,SAAS,eAAe,mBAAmB,EAEnEA,GAAA,MAAAA,EAAiB,iBAAiB,WAAYL,IAC9CK,GAAA,MAAAA,EAAiB,iBAAiB,OAAQH,IAC1CG,GAAA,MAAAA,EAAiB,iBAAiB,YAAaJ,MAGhDK,GAAA,IAAA,CACC,OAAO,oBAAoB,UAAWP,EAAa,QAE7CM,EAAkB,SAAS,eAAe,mBAAmB,EAE/DA,IACHA,GAAA,MAAAA,EAAiB,oBAAoB,WAAYL,IACjDK,GAAA,MAAAA,EAAiB,oBAAoB,OAAQH,IAC7CG,GAAA,MAAAA,EAAiB,oBAAoB,YAAaJ,kDASxCzF,EAAiB+F,0BAChB9F,GAAU,KAAA,kCAKjBA,IAAcA,GAAW,OAAS,EACrC2D,GAAkB,MAAM,KAAK3D,EAAU,CAAA,EAEvCoB,GAAM,MAAM9B,EAAM,EAAC,iBAAA,CAAA,OAGpBS,EAAkB,MAAQ,GAAEA,CAAA,MAQrBgG,GAAc,MACtBnF,EAAmB,IAAQA,KAAwBmF,IACnDtD,EAAiB7B,CAAmB,kBAJ1BF,EAAuBsF,wBAwB1BjF,EAAA,EAAAT,EAAY,EAAI,EAChBC,iDAiCQT,EAAegG,+BAc1B/E,EAAA,GAAArB,EAAY,EAAK,QAEXyD,GAAI,EAENtD,GACHA,EAAiB,MAAK,YAGNoG,GAAI,OACb,KAAAnF,EAAM,SAAAoF,CAAQ,EAAKD,EAC3BlF,EAAA,GAAArB,EAAY,EAAK,QAEXyD,GAAI,EACVJ,GAAmBjC,CAAI,QAEjBqC,GAAI,EAENtD,GACHA,EAAiB,MAAK,2CAgCfD,EAAM,OAAOuG,EAAS,CAAC,kBA2BzBvG,EAAM,OAAOuG,EAAS,CAAC,uBA8BftJ,GAAC,CACH,KAAA,CAAA,GAAAuJ,GAAOvJ,EACfkE,EAAA,EAAApB,EAAUyG,CAAE,EACZrF,EAAA,GAAAiC,GAAUJ,EAAU,CAAA,8CAhBV/C,EAAgBiG,0BAkBRjJ,GAAC,OACnBA,EAAIA,EAAE,OAAO,MACSA,EAAE,SAAWA,EAAE,QAE/B,MAAAwJ,EAA2B,SAAS,eAAe,oBAAoB,KAEzEA,EAAwB,CAqBvB,GApBAA,GAA4BxJ,EAAE,MAAQ,YACzCA,EAAE,eAAc,EAChBiD,EAAgB,SAAQ,EAEC,CAAA,GACrB,SAAS,uBAAuB,gCAAgC,CAAA,EACjE,GAAE,EAAG,EACY,eAAiB,CAAA,MAAO,QAAQ,CAAA,GAGjDuG,GAA4BxJ,EAAE,MAAQ,cACzCA,EAAE,eAAc,EAChBiD,EAAgB,WAAU,EAED,CAAA,GACrB,SAAS,uBAAuB,gCAAgC,CAAA,EACjE,GAAE,EAAG,EACY,eAAiB,CAAA,MAAO,QAAQ,CAAA,GAGjDuG,GAA4BxJ,EAAE,MAAQ,MAAK,CAC9CA,EAAE,eAAc,QAEVyJ,EAAmB,CAAA,GACrB,SAAS,uBAAuB,gCAAgC,CAAA,EACjE,GAAE,EAAG,EAERA,GAAA,MAAAA,EAAqB,QAGlB,GAAAD,GAA4BxJ,EAAE,MAAQ,QAAO,CAChDA,EAAE,eAAc,QAEVyJ,EAAmB,CAAA,GACrB,SAAS,uBAAuB,gCAAgC,CAAA,EACjE,GAAE,EAAG,EAEJA,EACHA,GAAA,MAAAA,EAAqB,SAErB7I,EAAA,SAAS,eAAe,qBAAqB,IAA7C,MAAAA,EAAgD,cAKhD,CAAA8I,GAEA,EAAA,iBAAkB,QAClB,UAAU,eAAiB,GAC3B,UAAU,iBAAmB,MAK1B1J,EAAE,UAAY,IAAO,CAAAA,EAAE,UAC1BA,EAAE,eAAc,EAIb8C,IAAY,IAAM9C,EAAE,UAAY,IAAE,CAAKA,EAAE,UAC5C6I,MAKC7I,EAAE,MAAQ,UACb,QAAQ,KAAK,QAAQ,YAGNA,GAAC,CACjBA,EAAIA,EAAE,OAAO,MACb,QAAQ,KAAKA,CAAC,WAaZkD,EAAkB,MAAK,oBAiClB,IAAAyG,EAAe,MAAA,UAAU,aAC3B,aAAY,CAAG,MAAO,EAAI,CAAA,EAC1B,MAAK,SAAWrF,EAAG,CACnB,OAAAC,GAAM,MACL9B,EAAM,EAAC,yDAAA,CACN,MAAO6B,CAAA,CAAA,CAAA,EAGF,OAGLqF,IACHzF,EAAA,GAAArB,EAAY,EAAI,EACD8G,EAAO,YACf,QAAS/C,GAAUA,EAAM,KAAI,CAAA,GAErC+C,EAAS,WAETpF,GAAM,MAAM9B,EAAM,EAAE,6CAA6C,CAAA,YA2BhEe,aA/PRqF,0qBAzZL3E,EAAA,EAAGsC,IAAgB,GAAG,EAAE,SAASL,IAAA,YAAAA,GAAS,OAAO,EAAC,CAAA,qCA+P3CrD,GACNS"}