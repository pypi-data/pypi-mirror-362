import{s as re,p as ae,j as H,X as _e,q as ce,r as ie,v as fe,w as ue,x as de,e as y,c as w,a as C,d as p,f as k,i as E,k as j,o as B,g as I,B as J,u as ge,l as Q,S as he,t as L,b as M,h as q,n as W,F as X}from"./BId-c6mR.js";import{S as me,i as pe,b as A,d as U,m as z,t as x,a as V,e as O,g as P,c as R}from"./BuwtTo7z.js";import{e as G}from"./TjOgUCiB.js";import{k as Y}from"./8Hnar5y7.js";import{F as ve}from"./CU2r43ac.js";import"./CS5v2Vts.js";import{M as be}from"./Dr1Ql88Z.js";import{b as ke}from"./CKEIsxtJ.js";import{f as ye}from"./CBc5jlPY.js";import{D as we}from"./DjWVR4ZP.js";import{S as $e}from"./nViY0P2_.js";import{a as Ie}from"./DKtvgPI5.js";import{d as xe}from"./I1CDPYOB.js";import{F as De}from"./BhhVygoZ.js";import{g as Ce}from"./BUUQjd9A.js";function Z(o,e,n){const l=o.slice();return l[15]=e[n],l}function Ve(o){let e;const n=o[10].default,l=ie(n,o,o[14],null);return{c(){l&&l.c()},l(t){l&&l.l(t)},m(t,a){l&&l.m(t,a),e=!0},p(t,a){l&&l.p&&(!e||a&16384)&&fe(l,n,t,t[14],e?de(n,t[14],a,null):ue(t[14]),null)},i(t){e||(x(l,t),e=!0)},o(t){V(l,t),e=!1},d(t){l&&l.d(t)}}}function Ee(o){let e,n,l=G(o[2]),t=[];for(let s=0;s<l.length;s+=1)t[s]=ee(Z(o,l,s));const a=s=>V(t[s],1,1,()=>{t[s]=null});return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=Q()},l(s){for(let c=0;c<t.length;c+=1)t[c].l(s);e=Q()},m(s,c){for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(s,c);E(s,e,c),n=!0},p(s,c){if(c&100){l=G(s[2]);let r;for(r=0;r<l.length;r+=1){const i=Z(s,l,r);t[r]?(t[r].p(i,c),x(t[r],1)):(t[r]=ee(i),t[r].c(),x(t[r],1),t[r].m(e.parentNode,e))}for(P(),r=l.length;r<t.length;r+=1)a(r);R()}},i(s){if(!n){for(let c=0;c<l.length;c+=1)x(t[c]);n=!0}},o(s){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)V(t[c]);n=!1},d(s){s&&p(e),he(t,s)}}}function Se(o){let e,n=o[3].t("No knowledge found")+"",l;return{c(){e=y("div"),l=L(n),this.h()},l(t){e=w(t,"DIV",{class:!0});var a=C(e);l=M(a,n),a.forEach(p),this.h()},h(){k(e,"class","text-center text-xs text-gray-500 dark:text-gray-400 py-4")},m(t,a){E(t,e,a),I(e,l)},p(t,a){a&8&&n!==(n=t[3].t("No knowledge found")+"")&&q(l,n)},i:W,o:W,d(t){t&&p(e)}}}function Ke(o){let e,n="Collection";return{c(){e=y("div"),e.textContent=n,this.h()},l(l){e=w(l,"DIV",{class:!0,"data-svelte-h":!0}),X(e)!=="svelte-1j93cxc"&&(e.textContent=n),this.h()},h(){k(e,"class","bg-green-500/20 text-green-700 dark:text-green-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0")},m(l,t){E(l,e,t)},d(l){l&&p(e)}}}function Ne(o){let e,n="Note";return{c(){e=y("div"),e.textContent=n,this.h()},l(l){e=w(l,"DIV",{class:!0,"data-svelte-h":!0}),X(e)!=="svelte-1jerdxt"&&(e.textContent=n),this.h()},h(){k(e,"class","bg-blue-500/20 text-blue-700 dark:text-blue-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0")},m(l,t){E(l,e,t)},d(l){l&&p(e)}}}function Fe(o){let e,n="File";return{c(){e=y("div"),e.textContent=n,this.h()},l(l){e=w(l,"DIV",{class:!0,"data-svelte-h":!0}),X(e)!=="svelte-dn3g9i"&&(e.textContent=n),this.h()},h(){k(e,"class","bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0")},m(l,t){E(l,e,t)},d(l){l&&p(e)}}}function je(o){let e,n="Document";return{c(){e=y("div"),e.textContent=n,this.h()},l(l){e=w(l,"DIV",{class:!0,"data-svelte-h":!0}),X(e)!=="svelte-2kpkct"&&(e.textContent=n),this.h()},h(){k(e,"class","bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0")},m(l,t){E(l,e,t)},d(l){l&&p(e)}}}function Be(o){let e,n="Legacy";return{c(){e=y("div"),e.textContent=n,this.h()},l(l){e=w(l,"DIV",{class:!0,"data-svelte-h":!0}),X(e)!=="svelte-8uyvzr"&&(e.textContent=n),this.h()},h(){k(e,"class","bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0")},m(l,t){E(l,e,t)},d(l){l&&p(e)}}}function Te(o){var F,S;let e,n,l,t,a=o[6]((F=o[15])==null?void 0:F.name)+"",s,c,r,i=((S=o[15])==null?void 0:S.description)+"",f,m;function h($,u){var g,D,N,d;return $[15].legacy?Be:(D=(g=$[15])==null?void 0:g.meta)!=null&&D.document?je:((N=$[15])==null?void 0:N.type)==="file"?Fe:((d=$[15])==null?void 0:d.type)==="note"?Ne:Ke}let _=h(o),v=_(o);return{c(){e=y("div"),n=y("div"),v.c(),l=j(),t=y("div"),s=L(a),c=j(),r=y("div"),f=L(i),m=j(),this.h()},l($){e=w($,"DIV",{});var u=C(e);n=w(u,"DIV",{class:!0});var g=C(n);v.l(g),l=B(g),t=w(g,"DIV",{class:!0});var D=C(t);s=M(D,a),D.forEach(p),g.forEach(p),c=B(u),r=w(u,"DIV",{class:!0});var N=C(r);f=M(N,i),N.forEach(p),u.forEach(p),m=B($),this.h()},h(){k(t,"class","line-clamp-1"),k(n,"class","font-medium text-black dark:text-gray-100 flex items-center gap-1"),k(r,"class","text-xs text-gray-600 dark:text-gray-100 line-clamp-1")},m($,u){E($,e,u),I(e,n),v.m(n,null),I(n,l),I(n,t),I(t,s),I(e,c),I(e,r),I(r,f),E($,m,u)},p($,u){var g,D;_!==(_=h($))&&(v.d(1),v=_($),v&&(v.c(),v.m(n,l))),u&4&&a!==(a=$[6]((g=$[15])==null?void 0:g.name)+"")&&q(s,a),u&4&&i!==(i=((D=$[15])==null?void 0:D.description)+"")&&q(f,i)},d($){$&&(p(e),p(m)),v.d()}}}function ee(o){let e,n;function l(){return o[12](o[15])}return e=new be({props:{class:"flex gap-2.5 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Te]},$$scope:{ctx:o}}}),e.$on("click",l),{c(){A(e.$$.fragment)},l(t){U(e.$$.fragment,t)},m(t,a){z(e,t,a),n=!0},p(t,a){o=t;const s={};a&16388&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(t){n||(x(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}function Le(o){let e,n,l,t,a,s,c,r,i,f,m,h,_,v;t=new $e({});const F=[Se,Ee],S=[];function $(u,g){return u[2].length===0?0:1}return f=$(o),m=S[f]=F[f](o),{c(){e=y("div"),n=y("div"),l=y("div"),A(t.$$.fragment),a=j(),s=y("input"),r=j(),i=y("div"),m.c(),this.h()},l(u){e=w(u,"DIV",{class:!0});var g=C(e);n=w(g,"DIV",{class:!0});var D=C(n);l=w(D,"DIV",{class:!0});var N=C(l);U(t.$$.fragment,N),N.forEach(p),a=B(D),s=w(D,"INPUT",{class:!0,placeholder:!0}),D.forEach(p),g.forEach(p),r=B(u),i=w(u,"DIV",{class:!0});var d=C(i);m.l(d),d.forEach(p),this.h()},h(){k(l,"class","self-center ml-1 mr-3"),k(s,"class","w-full text-sm pr-4 py-1 rounded-r-xl outline-hidden bg-transparent"),k(s,"placeholder",c=o[3].t("Search Knowledge")),k(n,"class","flex flex-1"),k(e,"class","flex w-full space-x-2 py-0.5 px-2 pb-2"),k(i,"class","max-h-56 overflow-y-scroll")},m(u,g){E(u,e,g),I(e,n),I(n,l),z(t,l,null),I(n,a),I(n,s),J(s,o[1]),E(u,r,g),E(u,i,g),S[f].m(i,null),h=!0,_||(v=ge(s,"input",o[11]),_=!0)},p(u,g){(!h||g&8&&c!==(c=u[3].t("Search Knowledge")))&&k(s,"placeholder",c),g&2&&s.value!==u[1]&&J(s,u[1]);let D=f;f=$(u),f===D?S[f].p(u,g):(P(),V(S[D],1,1,()=>{S[D]=null}),R(),m=S[f],m?m.p(u,g):(m=S[f]=F[f](u),m.c()),x(m,1),m.m(i,null))},i(u){h||(x(t.$$.fragment,u),x(m),h=!0)},o(u){V(t.$$.fragment,u),V(m),h=!1},d(u){u&&(p(e),p(r),p(i)),O(t),S[f].d(),_=!1,v()}}}function Me(o){let e,n,l;return n=new ke({props:{class:"w-full max-w-96 rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-[99999999] bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:8,side:"bottom",align:"start",transition:ye,$$slots:{default:[Le]},$$scope:{ctx:o}}}),{c(){e=y("div"),A(n.$$.fragment),this.h()},l(t){e=w(t,"DIV",{slot:!0});var a=C(e);U(n.$$.fragment,a),a.forEach(p),this.h()},h(){k(e,"slot","content")},m(t,a){E(t,e,a),z(n,e,null),l=!0},p(t,a){const s={};a&16398&&(s.$$scope={dirty:a,ctx:t}),n.$set(s)},i(t){l||(x(n.$$.fragment,t),l=!0)},o(t){V(n.$$.fragment,t),l=!1},d(t){t&&p(e),O(n)}}}function qe(o){let e,n;return e=new we({props:{$$slots:{content:[Me],default:[Ve]},$$scope:{ctx:o}}}),e.$on("change",o[13]),{c(){A(e.$$.fragment)},l(l){U(e.$$.fragment,l)},m(l,t){z(e,l,t),n=!0},p(l,[t]){const a={};t&16398&&(a.$$scope={dirty:t,ctx:l}),e.$set(a)},i(l){n||(x(e.$$.fragment,l),n=!0)},o(l){V(e.$$.fragment,l),n=!1},d(l){O(e,l)}}}function Ae(o,e,n){let l,{$$slots:t={},$$scope:a}=e;const s=ae("i18n");H(o,s,u=>n(3,l=u));const c=_e();let{onClose:r=()=>{}}=e,{knowledgeItems:i=[]}=e,f="",m=[],h=[],_=null;const v=u=>{try{return decodeURIComponent(u)}catch{return u}};ce(async()=>{let u=await Ie(localStorage.token).catch(()=>[]);u=u.map(d=>({...d,type:"note",name:d.title,description:xe(d.updated_at/1e6).fromNow()}));let g=i.filter(d=>{var b;return(b=d==null?void 0:d.meta)==null?void 0:b.document}).map(d=>({...d,type:"file"})),D=g.length>0?[{name:"All Documents",legacy:!0,type:"collection",description:"Deprecated (legacy collection), please create a new knowledge base.",title:l.t("All Documents"),collection_names:g.map(d=>d.id)},...g.reduce((d,b)=>{var K;return[...new Set([...d,...(((K=b==null?void 0:b.meta)==null?void 0:K.tags)??[]).map(T=>T.name)])]},[]).map(d=>({name:d,legacy:!0,type:"collection",description:"Deprecated (legacy collection), please create a new knowledge base.",collection_names:g.filter(b=>{var K;return(((K=b==null?void 0:b.meta)==null?void 0:K.tags)??[]).map(T=>T.name).includes(d)}).map(b=>b.id)}))]:[],N=i.filter(d=>{var b;return!((b=d==null?void 0:d.meta)!=null&&b.document)}).map(d=>({...d,type:"collection"}));i.length>0&&[...i.reduce((d,b)=>[...new Set([...d,...((b==null?void 0:b.files)??[]).map(K=>({...K,collection:{name:b.name,description:b.description}}))])],[]).map(d=>{var b,K,T;return{...d,name:(b=d==null?void 0:d.meta)==null?void 0:b.name,description:`${(K=d==null?void 0:d.collection)==null?void 0:K.name} - ${(T=d==null?void 0:d.collection)==null?void 0:T.description}`,type:"file"}})],n(8,m=[...u,...N,...D].map(d=>{var b,K;return{...d,...d!=null&&d.legacy||(b=d==null?void 0:d.meta)!=null&&b.legacy||(K=d==null?void 0:d.meta)!=null&&K.document?{legacy:!0}:{}}})),n(9,_=new ve(m,{keys:["name","description"]}))});function F(){f=this.value,n(1,f)}const S=u=>{c("select",u)},$=u=>{u.detail===!1&&(r(),n(1,f=""))};return o.$$set=u=>{"onClose"in u&&n(0,r=u.onClose),"knowledgeItems"in u&&n(7,i=u.knowledgeItems),"$$scope"in u&&n(14,a=u.$$scope)},o.$$.update=()=>{o.$$.dirty&770&&_&&n(2,h=f?_.search(f).map(u=>u.item):m)},[r,f,h,l,s,c,v,i,m,_,t,F,S,$,a]}class Ue extends me{constructor(e){super(),pe(this,e,Ae,qe,re,{onClose:0,knowledgeItems:7})}}function te(o,e,n){const l=o.slice();return l[9]=e[n],l[11]=n,l}const ze=o=>({}),le=o=>({});function Oe(o){let e,n,l,t=o[3].t("Knowledge")+"",a,s,c,r=o[3].t('To attach knowledge base here, add them to the "Knowledge" workspace first.')+"",i;return{c(){e=y("div"),n=y("div"),l=y("div"),a=L(t),s=j(),c=y("div"),i=L(r),this.h()},l(f){e=w(f,"DIV",{class:!0});var m=C(e);n=w(m,"DIV",{class:!0});var h=C(n);l=w(h,"DIV",{class:!0});var _=C(l);a=M(_,t),_.forEach(p),h.forEach(p),s=B(m),c=w(m,"DIV",{class:!0});var v=C(c);i=M(v,r),v.forEach(p),m.forEach(p),this.h()},h(){k(l,"class","self-center text-sm font-semibold"),k(n,"class","flex w-full justify-between mb-1"),k(c,"class","text-xs dark:text-gray-500"),k(e,"class","mb-2")},m(f,m){E(f,e,m),I(e,n),I(n,l),I(l,a),I(e,s),I(e,c),I(c,i)},p(f,m){m&8&&t!==(t=f[3].t("Knowledge")+"")&&q(a,t),m&8&&r!==(r=f[3].t('To attach knowledge base here, add them to the "Knowledge" workspace first.')+"")&&q(i,r)},d(f){f&&p(e)}}}function ne(o){let e,n,l=G(o[0]),t=[];for(let s=0;s<l.length;s+=1)t[s]=se(te(o,l,s));const a=s=>V(t[s],1,1,()=>{t[s]=null});return{c(){e=y("div");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=w(s,"DIV",{class:!0});var c=C(e);for(let r=0;r<t.length;r+=1)t[r].l(c);c.forEach(p),this.h()},h(){k(e,"class","flex flex-wrap items-center gap-2 mb-2.5")},m(s,c){E(s,e,c);for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(e,null);n=!0},p(s,c){if(c&1){l=G(s[0]);let r;for(r=0;r<l.length;r+=1){const i=te(s,l,r);t[r]?(t[r].p(i,c),x(t[r],1)):(t[r]=se(i),t[r].c(),x(t[r],1),t[r].m(e,null))}for(P(),r=l.length;r<t.length;r+=1)a(r);R()}},i(s){if(!n){for(let c=0;c<l.length;c+=1)x(t[c]);n=!0}},o(s){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)V(t[c]);n=!1},d(s){s&&p(e),he(t,s)}}}function se(o){var t,a;let e,n;function l(...s){return o[6](o[11],...s)}return e=new De({props:{file:o[9],item:o[9],name:o[9].name,modal:!0,edit:!0,type:(t=o[9])!=null&&t.legacy?`Legacy${o[9].type?` ${o[9].type}`:""}`:((a=o[9])==null?void 0:a.type)??"Collection",dismissible:!0}}),e.$on("dismiss",l),{c(){A(e.$$.fragment)},l(s){U(e.$$.fragment,s)},m(s,c){z(e,s,c),n=!0},p(s,c){var i,f;o=s;const r={};c&1&&(r.file=o[9]),c&1&&(r.item=o[9]),c&1&&(r.name=o[9].name),c&1&&(r.type=(i=o[9])!=null&&i.legacy?`Legacy${o[9].type?` ${o[9].type}`:""}`:((f=o[9])==null?void 0:f.type)??"Collection"),e.$set(r)},i(s){n||(x(e.$$.fragment,s),n=!0)},o(s){V(e.$$.fragment,s),n=!1},d(s){O(e,s)}}}function oe(o){let e,n,l;return n=new Ue({props:{knowledgeItems:o[2]||[],$$slots:{default:[Pe]},$$scope:{ctx:o}}}),n.$on("select",o[7]),{c(){e=y("div"),A(n.$$.fragment),this.h()},l(t){e=w(t,"DIV",{class:!0});var a=C(e);U(n.$$.fragment,a),a.forEach(p),this.h()},h(){k(e,"class","flex flex-wrap text-sm font-medium gap-1.5")},m(t,a){E(t,e,a),z(n,e,null),l=!0},p(t,a){const s={};a&4&&(s.knowledgeItems=t[2]||[]),a&264&&(s.$$scope={dirty:a,ctx:t}),n.$set(s)},i(t){l||(x(n.$$.fragment,t),l=!0)},o(t){V(n.$$.fragment,t),l=!1},d(t){t&&p(e),O(n)}}}function Pe(o){let e,n=o[3].t("Select Knowledge")+"",l;return{c(){e=y("button"),l=L(n),this.h()},l(t){e=w(t,"BUTTON",{class:!0,type:!0});var a=C(e);l=M(a,n),a.forEach(p),this.h()},h(){k(e,"class","px-3.5 py-1.5 font-medium hover:bg-black/5 dark:hover:bg-white/5 outline outline-1 outline-gray-100 dark:outline-gray-850 rounded-3xl"),k(e,"type","button")},m(t,a){E(t,e,a),I(e,l)},p(t,a){a&8&&n!==(n=t[3].t("Select Knowledge")+"")&&q(l,n)},d(t){t&&p(e)}}}function Re(o){var m;let e,n,l,t,a;const s=o[5].label,c=ie(s,o,o[8],le),r=c||Oe(o);let i=((m=o[0])==null?void 0:m.length)>0&&ne(o),f=o[1]&&oe(o);return{c(){e=y("div"),r&&r.c(),n=j(),l=y("div"),i&&i.c(),t=j(),f&&f.c(),this.h()},l(h){e=w(h,"DIV",{});var _=C(e);r&&r.l(_),n=B(_),l=w(_,"DIV",{class:!0});var v=C(l);i&&i.l(v),t=B(v),f&&f.l(v),v.forEach(p),_.forEach(p),this.h()},h(){k(l,"class","flex flex-col")},m(h,_){E(h,e,_),r&&r.m(e,null),I(e,n),I(e,l),i&&i.m(l,null),I(l,t),f&&f.m(l,null),a=!0},p(h,[_]){var v;c?c.p&&(!a||_&256)&&fe(c,s,h,h[8],a?de(s,h[8],_,ze):ue(h[8]),le):r&&r.p&&(!a||_&8)&&r.p(h,a?_:-1),((v=h[0])==null?void 0:v.length)>0?i?(i.p(h,_),_&1&&x(i,1)):(i=ne(h),i.c(),x(i,1),i.m(l,t)):i&&(P(),V(i,1,1,()=>{i=null}),R()),h[1]?f?(f.p(h,_),_&2&&x(f,1)):(f=oe(h),f.c(),x(f,1),f.m(l,null)):f&&(P(),V(f,1,1,()=>{f=null}),R())},i(h){a||(x(r,h),x(i),x(f),a=!0)},o(h){V(r,h),V(i),V(f),a=!1},d(h){h&&p(e),r&&r.d(h),i&&i.d(),f&&f.d()}}}function Xe(o,e,n){let l,t;H(o,Y,h=>n(2,l=h));let{$$slots:a={},$$scope:s}=e,{selectedItems:c=[]}=e;const r=ae("i18n");H(o,r,h=>n(3,t=h));let i=!1;ce(async()=>{l||Y.set(await Ce(localStorage.token)),n(1,i=!0)});const f=(h,_)=>{n(0,c=c.filter((v,F)=>F!==h))},m=h=>{const _=h.detail;c.find(v=>v.id===_.id)||n(0,c=[...c,{..._}])};return o.$$set=h=>{"selectedItems"in h&&n(0,c=h.selectedItems),"$$scope"in h&&n(8,s=h.$$scope)},[c,i,l,t,r,a,f,m,s]}class ct extends me{constructor(e){super(),pe(this,e,Xe,Re,re,{selectedItems:0})}}export{ct as K};
//# sourceMappingURL=BMJ-I0sZ.js.map
