import{s as ae,X as re,q as ne,y as oe,A as ie,j as F,p as ce,e as S,t as D,k as O,c as T,a as E,b as $,d as _,o as V,f as I,i as B,g as y,u as q,h as M}from"./BId-c6mR.js";import{S as se,i as le,b as z,d as P,m as Y,t as N,a as j,e as J,f as fe,g as ue,c as de}from"./BuwtTo7z.js";import{a as he,b as me,u as Q,e as Z,f as _e,h as G,s as ge,i as pe}from"./Bb2Jjb0f.js";import{i as x,m as be,c as ke}from"./8Hnar5y7.js";import{T as we}from"./CJbts6k9.js";import{t as H}from"./C9Ej3FHW.js";import{d as ye}from"./BegY-nht.js";import{M as ve}from"./CoVddHTh.js";import{L as Ce}from"./WB5AN6Fa.js";import{X as Ie}from"./PhEylauG.js";function Se(n){let e,t;return e=new we({props:{tags:n[0]}}),e.$on("delete",n[4]),e.$on("add",n[5]),{c(){z(e.$$.fragment)},l(a){P(e.$$.fragment,a)},m(a,l){Y(e,a,l),t=!0},p(a,[l]){const c={};l&1&&(c.tags=a[0]),e.$set(c)},i(a){t||(N(e.$$.fragment,a),t=!0)},o(a){j(e.$$.fragment,a),t=!1},d(a){J(e,a)}}}function Te(n,e,t){const a=re();let{chatId:l=""}=e,c=[];const s=async()=>await he(localStorage.token,l).catch(async h=>[]),o=async h=>{await me(localStorage.token,l,h).catch(async d=>(H.error(`${d}`),null))&&(t(0,c=await s()),await Q(localStorage.token,l,{tags:c}),await x.set(await Z(localStorage.token)),a("add",{name:h}))},f=async h=>{await _e(localStorage.token,l,h),t(0,c=await s()),await Q(localStorage.token,l,{tags:c}),await x.set(await Z(localStorage.token)),a("delete",{name:h})};ne(async()=>{l&&t(0,c=await s())});const w=h=>{f(h.detail)},v=h=>{o(h.detail)};return n.$$set=h=>{"chatId"in h&&t(3,l=h.chatId)},[c,o,f,l,w,v]}class Pe extends se{constructor(e){super(),le(this,e,Te,Se,ae,{chatId:3})}}function ee(n){var L;let e,t,a,l,c,s,o,f,w,v,h,k,d;function m(r,u){return r[2].share_id?Ue:Ee}let p=m(n),b=p(n),g=((L=n[4])==null?void 0:L.features.enable_community_sharing)&&te(n);w=new Ce({});function U(r,u){return r[2].share_id?Le:Be}let i=U(n),C=i(n);return{c(){e=S("div"),t=S("div"),b.c(),a=O(),l=S("div"),c=S("div"),s=S("div"),g&&g.c(),o=O(),f=S("button"),z(w.$$.fragment),v=O(),C.c(),this.h()},l(r){e=T(r,"DIV",{class:!0});var u=E(e);t=T(u,"DIV",{class:!0});var A=E(t);b.l(A),A.forEach(_),a=V(u),l=T(u,"DIV",{class:!0});var R=E(l);c=T(R,"DIV",{class:!0});var K=E(c);s=T(K,"DIV",{class:!0});var W=E(s);g&&g.l(W),o=V(W),f=T(W,"BUTTON",{class:!0,type:!0,id:!0});var X=E(f);P(w.$$.fragment,X),v=V(X),C.l(X),X.forEach(_),W.forEach(_),K.forEach(_),R.forEach(_),u.forEach(_),this.h()},h(){I(t,"class","text-sm dark:text-gray-300 mb-1"),I(f,"class","self-center flex items-center gap-1 px-3.5 py-2 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),I(f,"type","button"),I(f,"id","copy-and-share-chat-button"),I(s,"class","flex gap-1"),I(c,"class","flex flex-col items-end space-x-1 mt-3"),I(l,"class","flex justify-end"),I(e,"class","px-5 pt-4 pb-5 w-full flex flex-col justify-center")},m(r,u){B(r,e,u),y(e,t),b.m(t,null),y(e,a),y(e,l),y(l,c),y(c,s),g&&g.m(s,null),y(s,o),y(s,f),Y(w,f,null),y(f,v),C.m(f,null),h=!0,k||(d=q(f,"click",n[11]),k=!0)},p(r,u){var A;p===(p=m(r))&&b?b.p(r,u):(b.d(1),b=p(r),b&&(b.c(),b.m(t,null))),(A=r[4])!=null&&A.features.enable_community_sharing?g?g.p(r,u):(g=te(r),g.c(),g.m(s,o)):g&&(g.d(1),g=null),i===(i=U(r))&&C?C.p(r,u):(C.d(1),C=i(r),C&&(C.c(),C.m(f,null)))},i(r){h||(N(w.$$.fragment,r),h=!0)},o(r){j(w.$$.fragment,r),h=!1},d(r){r&&_(e),b.d(),g&&g.d(),J(w),C.d(),k=!1,d()}}}function Ee(n){let e=n[3].t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")+"",t;return{c(){t=D(e)},l(a){t=$(a,e)},m(a,l){B(a,t,l)},p(a,l){l&8&&e!==(e=a[3].t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")+"")&&M(t,e)},d(a){a&&_(t)}}}function Ue(n){let e,t=n[3].t("You have shared this chat")+"",a,l,c,s=n[3].t("before")+"",o,f,w,v,h=n[3].t("Click here to")+"",k,d,m,p=n[3].t("delete this link")+"",b,g,U=n[3].t("and create a new shared link.")+"",i,C,L;return{c(){e=S("a"),a=D(t),l=O(),c=S("span"),o=D(s),f=D("."),v=O(),k=D(h),d=O(),m=S("button"),b=D(p),g=O(),i=D(U),this.h()},l(r){e=T(r,"A",{href:!0,target:!0});var u=E(e);a=$(u,t),l=V(u),c=T(u,"SPAN",{class:!0});var A=E(c);o=$(A,s),A.forEach(_),f=$(u,"."),u.forEach(_),v=V(r),k=$(r,h),d=V(r),m=T(r,"BUTTON",{class:!0});var R=E(m);b=$(R,p),R.forEach(_),g=V(r),i=$(r,U),this.h()},h(){I(c,"class","underline"),I(e,"href",w="/s/"+n[2].share_id),I(e,"target","_blank"),I(m,"class","underline")},m(r,u){B(r,e,u),y(e,a),y(e,l),y(e,c),y(c,o),y(e,f),B(r,v,u),B(r,k,u),B(r,d,u),B(r,m,u),y(m,b),B(r,g,u),B(r,i,u),C||(L=q(m,"click",n[9]),C=!0)},p(r,u){u&8&&t!==(t=r[3].t("You have shared this chat")+"")&&M(a,t),u&8&&s!==(s=r[3].t("before")+"")&&M(o,s),u&4&&w!==(w="/s/"+r[2].share_id)&&I(e,"href",w),u&8&&h!==(h=r[3].t("Click here to")+"")&&M(k,h),u&8&&p!==(p=r[3].t("delete this link")+"")&&M(b,p),u&8&&U!==(U=r[3].t("and create a new shared link.")+"")&&M(i,U)},d(r){r&&(_(e),_(v),_(k),_(d),_(m),_(g),_(i)),C=!1,L()}}}function te(n){let e,t=n[3].t("Share to Open WebUI Community")+"",a,l,c;return{c(){e=S("button"),a=D(t),this.h()},l(s){e=T(s,"BUTTON",{class:!0,type:!0});var o=E(e);a=$(o,t),o.forEach(_),this.h()},h(){I(e,"class","self-center flex items-center gap-1 px-3.5 py-2 text-sm font-medium bg-gray-100 hover:bg-gray-200 text-gray-800 dark:bg-gray-850 dark:text-white dark:hover:bg-gray-800 transition rounded-full"),I(e,"type","button")},m(s,o){B(s,e,o),y(e,a),l||(c=q(e,"click",n[10]),l=!0)},p(s,o){o&8&&t!==(t=s[3].t("Share to Open WebUI Community")+"")&&M(a,t)},d(s){s&&_(e),l=!1,c()}}}function Be(n){let e=n[3].t("Copy Link")+"",t;return{c(){t=D(e)},l(a){t=$(a,e)},m(a,l){B(a,t,l)},p(a,l){l&8&&e!==(e=a[3].t("Copy Link")+"")&&M(t,e)},d(a){a&&_(t)}}}function Le(n){let e=n[3].t("Update and Copy Link")+"",t;return{c(){t=D(e)},l(a){t=$(a,e)},m(a,l){B(a,t,l)},p(a,l){l&8&&e!==(e=a[3].t("Update and Copy Link")+"")&&M(t,e)},d(a){a&&_(t)}}}function De(n){let e,t,a,l=n[3].t("Share Chat")+"",c,s,o,f,w,v,h,k;f=new Ie({props:{className:"size-5"}});let d=n[2]&&ee(n);return{c(){e=S("div"),t=S("div"),a=S("div"),c=D(l),s=O(),o=S("button"),z(f.$$.fragment),w=O(),d&&d.c(),this.h()},l(m){e=T(m,"DIV",{});var p=E(e);t=T(p,"DIV",{class:!0});var b=E(t);a=T(b,"DIV",{class:!0});var g=E(a);c=$(g,l),g.forEach(_),s=V(b),o=T(b,"BUTTON",{class:!0});var U=E(o);P(f.$$.fragment,U),U.forEach(_),b.forEach(_),w=V(p),d&&d.l(p),p.forEach(_),this.h()},h(){I(a,"class","text-lg font-medium self-center"),I(o,"class","self-center"),I(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-0.5")},m(m,p){B(m,e,p),y(e,t),y(t,a),y(a,c),y(t,s),y(t,o),Y(f,o,null),y(e,w),d&&d.m(e,null),v=!0,h||(k=q(o,"click",n[8]),h=!0)},p(m,p){(!v||p&8)&&l!==(l=m[3].t("Share Chat")+"")&&M(c,l),m[2]?d?(d.p(m,p),p&4&&N(d,1)):(d=ee(m),d.c(),N(d,1),d.m(e,null)):d&&(ue(),j(d,1,1,()=>{d=null}),de())},i(m){v||(N(f.$$.fragment,m),N(d),v=!0)},o(m){j(f.$$.fragment,m),j(d),v=!1},d(m){m&&_(e),J(f),d&&d.d(),h=!1,k()}}}function $e(n){let e,t,a;function l(s){n[12](s)}let c={size:"md",$$slots:{default:[De]},$$scope:{ctx:n}};return n[0]!==void 0&&(c.show=n[0]),e=new ve({props:c}),oe.push(()=>fe(e,"show",l)),{c(){z(e.$$.fragment)},l(s){P(e.$$.fragment,s)},m(s,o){Y(e,s,o),a=!0},p(s,[o]){const f={};o&65567&&(f.$$scope={dirty:o,ctx:s}),!t&&o&1&&(t=!0,f.show=s[0],ie(()=>t=!1)),e.$set(f)},i(s){a||(N(e.$$.fragment,s),a=!0)},o(s){j(e.$$.fragment,s),a=!1},d(s){J(e,s)}}}function Me(n,e,t){let a,l,c;F(n,be,i=>t(14,a=i)),F(n,ke,i=>t(4,c=i));let{chatId:s}=e,o=null,f=null;const w=ce("i18n");F(n,w,i=>t(3,l=i));const v=async()=>{const i=await ge(localStorage.token,s);return f=`${window.location.origin}/s/${i.id}`,t(2,o=await G(localStorage.token,s)),f},h=async()=>{const i=o.chat;H.success(l.t("Redirecting you to Open WebUI Community"));const C="https://openwebui.com",L=await window.open(`${C}/chats/upload`,"_blank");window.addEventListener("message",r=>{r.origin===C&&r.data==="loaded"&&L.postMessage(JSON.stringify({chat:i,models:a.filter(u=>i.models.includes(u.id))}),"*")},!1)};let{show:k=!1}=e;const d=i=>o?i?o.id!==i.id||o.share_id!==i.share_id:!1:!0,m=()=>{t(0,k=!1)},p=async()=>{await pe(localStorage.token,s)&&t(2,o=await G(localStorage.token,s))},b=()=>{h(),t(0,k=!1)},g=async()=>{if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){const C=async()=>{const L=await v();return new Blob([L],{type:"text/plain"})};navigator.clipboard.write([new ClipboardItem({"text/plain":C()})]).then(()=>!0).catch(L=>(console.error("Async: Could not copy text: ",L),!1))}else ye(await v());H.success(l.t("Copied shared chat URL to clipboard!")),t(0,k=!1)};function U(i){k=i,t(0,k)}return n.$$set=i=>{"chatId"in i&&t(1,s=i.chatId),"show"in i&&t(0,k=i.show)},n.$$.update=()=>{n.$$.dirty&7&&k&&(async()=>{if(s){const i=await G(localStorage.token,s);d(i)&&t(2,o=i)}else t(2,o=null)})()},[k,s,o,l,c,w,v,h,m,p,b,g,U]}class Ye extends se{constructor(e){super(),le(this,e,Me,$e,ae,{chatId:1,show:0})}}export{Ye as S,Pe as T};
//# sourceMappingURL=Dk0EsShR.js.map
