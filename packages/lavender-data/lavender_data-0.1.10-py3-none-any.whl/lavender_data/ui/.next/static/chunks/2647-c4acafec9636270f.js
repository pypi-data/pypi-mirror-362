"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2647],{3949:(e,t,a)=>{a.d(t,{Cf:()=>u,Es:()=>m,L3:()=>f,c7:()=>x,lG:()=>o,rr:()=>h,zM:()=>i});var s=a(42227);a(49139);var l=a(74006),n=a(6126),r=a(27058);function o(e){let{...t}=e;return(0,s.jsx)(l.Root,{"data-slot":"dialog",...t})}function i(e){let{...t}=e;return(0,s.jsx)(l.Trigger,{"data-slot":"dialog-trigger",...t})}function d(e){let{...t}=e;return(0,s.jsx)(l.Portal,{"data-slot":"dialog-portal",...t})}function c(e){let{className:t,...a}=e;return(0,s.jsx)(l.Overlay,{"data-slot":"dialog-overlay",className:(0,r.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",t),...a})}function u(e){let{className:t,children:a,...o}=e;return(0,s.jsxs)(d,{"data-slot":"dialog-portal",children:[(0,s.jsx)(c,{}),(0,s.jsxs)(l.Content,{"data-slot":"dialog-content",className:(0,r.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200",t),...o,children:[a,(0,s.jsxs)(l.Close,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,s.jsx)(n.A,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function x(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-header",className:(0,r.cn)("flex flex-col gap-2 text-center sm:text-left",t),...a})}function m(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-footer",className:(0,r.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function f(e){let{className:t,...a}=e;return(0,s.jsx)(l.Title,{"data-slot":"dialog-title",className:(0,r.cn)("text-lg leading-none font-semibold",t),...a})}function h(e){let{className:t,...a}=e;return(0,s.jsx)(l.Description,{"data-slot":"dialog-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...a})}},11201:(e,t,a)=>{a.d(t,{K:()=>y});var s=a(42227),l=a(49139),n=a(78551),r=a(94079),o=a(50126),i=a(27058),d=a(70709),c=a(6148),u=a(62458);function x(e){let{className:t,...a}=e;return(0,s.jsx)(c.uB,{"data-slot":"command",className:(0,i.cn)("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",t),...a})}function m(e){let{className:t,...a}=e;return(0,s.jsxs)("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[(0,s.jsx)(u.A,{className:"size-4 shrink-0 opacity-50"}),(0,s.jsx)(c.uB.Input,{"data-slot":"command-input",className:(0,i.cn)("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",t),...a})]})}function f(e){let{className:t,...a}=e;return(0,s.jsx)(c.uB.List,{"data-slot":"command-list",className:(0,i.cn)("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",t),...a})}function h(e){let{...t}=e;return(0,s.jsx)(c.uB.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...t})}function p(e){let{className:t,...a}=e;return(0,s.jsx)(c.uB.Group,{"data-slot":"command-group",className:(0,i.cn)("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",t),...a})}function j(e){let{className:t,...a}=e;return(0,s.jsx)(c.uB.Item,{"data-slot":"command-item",className:(0,i.cn)("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...a})}a(3949);var g=a(84359);function v(e){let{...t}=e;return(0,s.jsx)(g.bL,{"data-slot":"popover",...t})}function b(e){let{...t}=e;return(0,s.jsx)(g.l9,{"data-slot":"popover-trigger",...t})}function w(e){let{className:t,align:a="center",sideOffset:l=4,...n}=e;return(0,s.jsx)(g.ZL,{children:(0,s.jsx)(g.UC,{"data-slot":"popover-content",align:a,sideOffset:l,className:(0,i.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...n})})}function y(e){let{value:t,onChange:a,draggable:c=!1,label:u="",placeholder:g="",emptyText:y="",className:N="",singleSelect:k=!1}=e,[C,S]=l.useState(!1),[A,_]=l.useState(null),E=e=>{_(e)},z=e=>{e.preventDefault()},F=(e,s)=>{if(e.preventDefault(),A){let e=[...t],l=e.findIndex(e=>e.value===A.value),n=e.findIndex(e=>e.value===s.value);if(l>n){for(let t=l;t>n;t--)e[t]=e[t-1];e[n]=A}else{for(let t=l;t<n;t++)e[t]=e[t+1];e[n]=A}a(e),_(null)}};return(0,s.jsxs)(v,{open:C,onOpenChange:S,children:[(0,s.jsx)(b,{asChild:!0,children:(0,s.jsxs)(d.$,{variant:"outline",role:"combobox","aria-expanded":C,className:(0,i.cn)("w-[200px] justify-between",N),children:[u,(0,s.jsx)(n.A,{className:"opacity-50"})]})}),(0,s.jsx)(w,{className:"w-full p-0",children:(0,s.jsxs)(x,{children:[(0,s.jsx)(m,{placeholder:g,className:"h-9"}),(0,s.jsxs)(f,{children:[(0,s.jsx)(h,{children:y}),(0,s.jsx)(p,{children:t.map(e=>{var l;return(0,s.jsxs)(j,{value:e.value,onSelect:e=>{let s=t.findIndex(t=>t.value===e);if(-1!==s){let e=[...t];e[s].selected=!e[s].selected,a(e)}},disabled:k&&t.filter(e=>e.selected).length>0&&!e.selected,draggable:c,onDragStart:()=>E(e),onDragOver:z,onDrop:t=>F(t,e),children:[c?(0,s.jsx)(r.A,{className:"w-4 h-4"}):(0,s.jsx)(s.Fragment,{}),e.label,(0,s.jsx)(o.A,{className:(0,i.cn)("ml-auto",(null===(l=t.find(t=>t.value===e.value))||void 0===l?void 0:l.selected)?"opacity-100":"opacity-0")})]},e.value)})})]})]})})]})}},17504:(e,t,a)=>{a.d(t,{E:()=>n});var s=a(42227),l=a(27058);function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"skeleton",className:(0,l.cn)("bg-primary/10 animate-pulse rounded-md",t),...a})}},61528:(e,t,a)=>{a.d(t,{B$:()=>n,HF:()=>s,LZ:()=>i,d1:()=>l,wH:()=>o});let s=async()=>{let e=await fetch("/api/version");if(!e.ok)throw Error("Failed to fetch version");return e.json()},l=async()=>{let e=await fetch("/api/background-tasks");if(!e.ok)throw Error("Failed to fetch background tasks: ".concat(e.status));return e.json()},n=async(e,t)=>{let a=await fetch("/api/datasets/".concat(e,"/preview/").concat(t));if(!a.ok)throw Error("Failed to fetch dataset preview: ".concat(await r(a)));return a.json()},r=async e=>{try{return"".concat(e.status," ").concat((await e.json()).detail)}catch(t){return"".concat(e.status," ").concat(await e.text())}},o=async(e,t)=>{let a=await fetch("/api/iterations",{method:"POST",body:JSON.stringify({dataset_id:e,...t})});if(!a.ok)throw Error("Failed to start iteration: ".concat(await r(a)));return a.json()},i=async e=>{let t=await fetch("/api/iterations/".concat(e,"/next-preview"));if(!t.ok)throw Error("Failed to fetch iteration next preview: ".concat(await r(t)));return t.json()}},94618:(e,t,a)=>{a.d(t,{A:()=>S});var s=a(42227),l=a(91747),n=a.n(l),r=a(49139),o=a(99887),i=a(92014),d=a(3949),c=a(17504),u=a(70709),x=a(2799),m=a(12622),f=a(10394),h=a(11201),p=a(51238),j=a(48981),g=a(33486);let v=e=>"object"==typeof e&&null!==e?JSON.stringify(e):"number"!=typeof e?String(e):n()(e)?String(e):e.toFixed(8),b=e=>{let t="";if("object"==typeof e&&null!==e)t=JSON.stringify(e);else if("number"==typeof e){if(!n()(e))return e.toFixed(2)}else t=String(e);return t.length>50?t.slice(0,50)+"...":t},w=e=>{let t=p.lookup(e.split("?")[0]);return t?{image:t.startsWith("image/"),video:t.startsWith("video/")||"application/mp4"==t}:{image:!1,video:!1}},y=e=>{if(e.startsWith("file://")){let t=e.replace("file://","");return"/api/files/".concat(t)}return e};function N(e){let{defaultShow:t,url:a,sample:l}=e,[n,i]=(0,r.useState)(t),[m,f]=(0,r.useState)(!0);(0,r.useEffect)(()=>{i(t),f(!0)},[a]),(0,r.useEffect)(()=>{i(t)},[t]);let h=y(a),p=w(a);return p.image?(0,s.jsxs)(d.lG,{children:[(0,s.jsx)(d.zM,{asChild:!0,children:(0,s.jsxs)("div",{children:[(0,s.jsx)(c.E,{className:"w-full h-[64px] ".concat(m?"block":"hidden")}),(0,s.jsx)("img",{src:h,className:"h-[64px] ".concat(m?"hidden":"block"),onLoad:()=>f(!1)})]})}),(0,s.jsxs)(d.Cf,{children:[(0,s.jsxs)(d.c7,{children:[(0,s.jsx)(d.L3,{children:"Image Preview"}),(0,s.jsx)(d.rr,{className:"w-full break-all",children:a})]}),(0,s.jsx)("div",{className:"w-full flex justify-center",children:(0,s.jsx)("img",{src:h,className:"w-[400px]"})}),(0,s.jsx)(d.Es,{className:"max-h-[500px] overflow-x-auto overflow-y-auto",children:(0,s.jsxs)(o.XI,{children:[(0,s.jsx)(o.A0,{children:(0,s.jsxs)(o.Hj,{children:[(0,s.jsx)(o.nd,{children:"Key"}),(0,s.jsx)(o.nd,{children:"Value"})]})}),(0,s.jsx)(o.BF,{children:Object.keys(l).map(e=>(0,s.jsxs)(o.Hj,{children:[(0,s.jsx)(o.nA,{children:e}),(0,s.jsx)(o.nA,{children:v(l[e])})]},e))})]})})]})]}):p.video?(0,s.jsxs)(d.lG,{children:[(0,s.jsx)(d.zM,{asChild:!0,children:n?(0,s.jsxs)("div",{children:[(0,s.jsx)(c.E,{className:"w-full h-[64px] ".concat(m?"block":"hidden")}),(0,s.jsx)("video",{src:h,className:"h-[64px] ".concat(m?"hidden":"block"),onCanPlay:()=>f(!1),autoPlay:!0,muted:!0,loop:!0,playsInline:!0})]}):(0,s.jsx)(u.$,{className:"w-full h-[64px]",onClick:()=>i(!0),children:(0,s.jsx)(x.A,{})})}),(0,s.jsxs)(d.Cf,{children:[(0,s.jsxs)(d.c7,{children:[(0,s.jsx)(d.L3,{children:"Video Preview"}),(0,s.jsx)(d.rr,{className:"w-full break-all",children:a})]}),(0,s.jsx)("div",{className:"w-full flex justify-center",children:(0,s.jsx)("video",{src:h,controls:!0,autoPlay:!0,className:"w-[400px]"})}),(0,s.jsx)(d.Es,{className:"max-h-[500px] overflow-x-auto overflow-y-auto",children:(0,s.jsxs)(o.XI,{children:[(0,s.jsx)(o.A0,{children:(0,s.jsxs)(o.Hj,{children:[(0,s.jsx)(o.nd,{children:"Key"}),(0,s.jsx)(o.nd,{children:"Value"})]})}),(0,s.jsx)(o.BF,{children:Object.keys(l).map(e=>(0,s.jsxs)(o.Hj,{children:[(0,s.jsx)(o.nA,{children:e}),(0,s.jsx)(o.nA,{children:v(l[e])})]},e))})]})})]})]}):(0,s.jsx)("div",{children:a})}let k=e=>{{let t=localStorage.getItem("columns-".concat(e));if(t)return JSON.parse(t)}return[]},C=(e,t)=>{localStorage.setItem("columns-".concat(e),JSON.stringify(t))};function S(e){let{datasetId:t,samples:a,fetchedColumns:l,statistics:n}=e,[d,c]=(0,r.useState)(!1),[p,w]=(0,r.useState)([]);(0,r.useEffect)(()=>{let e=k(t);0===e.length?w(l.map(e=>({name:e,selected:!0}))):w(e)},[t,l]),(0,r.useEffect)(()=>{p.length>0&&C(t,p)},[t,p]);let y=(0,r.useMemo)(()=>p.filter(e=>a.map(t=>t[e.name]).every(e=>"string"==typeof e&&(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("file://")))).map(e=>e),[a,p]);return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"w-full flex justify-start items-center mb-4 gap-8",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(h.K,{label:"Columns",placeholder:"Search columns...",emptyText:"No columns found",draggable:!0,value:p.map(e=>({label:e.name,value:e.name,selected:e.selected})),onChange:e=>w(e.map(e=>({name:e.value,selected:e.selected})))}),(0,s.jsx)(u.$,{variant:"outline",onClick:()=>w(l.map(e=>({name:e,selected:!0}))),children:"Reset"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(m.A,{className:"w-5 h-5"}),(0,s.jsx)(j.d,{checked:d,onCheckedChange:c,"aria-label":"Default show"}),(0,s.jsx)(x.A,{className:"w-5 h-5"})]})]}),!n&&(0,s.jsxs)("div",{className:"flex items-center gap-2 font-mono text-xs text-muted-foreground mb-4",children:[(0,s.jsx)(f.A,{className:"w-4 h-4"})," Dataset statistics are not ready yet."]}),(0,s.jsxs)(o.XI,{children:[(0,s.jsxs)(o.A0,{children:[(0,s.jsx)(o.Hj,{children:p.filter(e=>e.selected).map(e=>(0,s.jsx)(o.nd,{children:e.name},e.name))}),n&&(0,s.jsx)(o.Hj,{children:p.filter(e=>e.selected).map(e=>(0,s.jsx)(o.nd,{children:n.statistics[e.name]?(0,s.jsx)(g.StatisticsCell,{columnName:e.name,statistics:n.statistics[e.name]}):(0,s.jsx)("div",{children:"-"})},"".concat(e.name,"-statistics")))})]}),(0,s.jsx)(o.BF,{children:a.map((e,t)=>(0,s.jsx)(o.Hj,{children:p.filter(e=>e.selected).map(t=>{let a=e[t.name];if(y.some(e=>e.name===t.name&&e.selected))return(0,s.jsx)(o.nA,{children:(0,s.jsxs)(i.Tooltip,{children:[(0,s.jsx)(i.TooltipTrigger,{asChild:!0,children:(0,s.jsx)(N,{defaultShow:d,url:a,sample:e})}),(0,s.jsx)(i.TooltipContent,{className:"w-auto max-w-[500px] text-wrap break-all",children:a})]})},t.name);let l=v(a),n=b(l);return(0,s.jsx)(o.nA,{children:n?(0,s.jsxs)(i.Tooltip,{children:[(0,s.jsx)(i.TooltipTrigger,{asChild:!0,children:(0,s.jsx)("div",{children:n})}),(0,s.jsx)(i.TooltipContent,{className:"w-auto max-w-[500px] text-wrap break-all",children:l})]}):(0,s.jsx)("div",{children:l})},t.name)})},"preview-sample-".concat(t)))})]})]})}},99887:(e,t,a)=>{a.d(t,{A0:()=>r,BF:()=>o,Hj:()=>i,XI:()=>n,nA:()=>c,nd:()=>d});var s=a(42227);a(49139);var l=a(27058);function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,s.jsx)("table",{"data-slot":"table",className:(0,l.cn)("w-full caption-bottom text-sm",t),...a})})}function r(e){let{className:t,...a}=e;return(0,s.jsx)("thead",{"data-slot":"table-header",className:(0,l.cn)("[&_tr]:border-b",t),...a})}function o(e){let{className:t,...a}=e;return(0,s.jsx)("tbody",{"data-slot":"table-body",className:(0,l.cn)("[&_tr:last-child]:border-0",t),...a})}function i(e){let{className:t,...a}=e;return(0,s.jsx)("tr",{"data-slot":"table-row",className:(0,l.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...a})}function d(e){let{className:t,...a}=e;return(0,s.jsx)("th",{"data-slot":"table-head",className:(0,l.cn)("text-muted-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function c(e){let{className:t,...a}=e;return(0,s.jsx)("td",{"data-slot":"table-cell",className:(0,l.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}}}]);