(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9329],{15552:(e,r,s)=>{"use strict";s.d(r,{DeleteDatasetDialog:()=>d});var t=s(42227),a=s(28527),n=s(41458),i=s(4517);let c=(0,i.createServerReference)("402d3753d37d04587b5194c1a466b5d4d3a60e4e2b",i.callServer,void 0,i.findSourceMapURL,"deleteDataset");var l=s(73175);function d(e){let{datasetId:r,children:s}=e,i=(0,l.useRouter)(),d=async()=>{let e=await c(r);e.success?(a.oR.success("Dataset deleted successfully"),i.push("/datasets")):a.oR.error("Failed to delete dataset: ".concat(e.error))};return(0,t.jsxs)(n.Lt,{children:[(0,t.jsx)(n.tv,{asChild:!0,children:s}),(0,t.jsxs)(n.EO,{children:[(0,t.jsxs)(n.wd,{children:[(0,t.jsx)(n.r7,{children:"Are you absolutely sure?"}),(0,t.jsx)(n.$v,{children:"This action cannot be undone. This will permanently delete your dataset, related shardsets and iterations. Of course, actual data will not be affected."})]}),(0,t.jsxs)(n.ck,{children:[(0,t.jsx)(n.Zr,{children:"Cancel"}),(0,t.jsx)(n.Rx,{onClick:d,children:"Continue"})]})]})]})}},65898:(e,r,s)=>{"use strict";s.d(r,{X:()=>n});var t=s(49139),a=s(10938);function n(e){let[r,s]=t.useState(void 0);return(0,a.N)(()=>{if(e){s({width:e.offsetWidth,height:e.offsetHeight});let r=new ResizeObserver(r=>{let t,a;if(!Array.isArray(r)||!r.length)return;let n=r[0];if("borderBoxSize"in n){let e=n.borderBoxSize,r=Array.isArray(e)?e[0]:e;t=r.inlineSize,a=r.blockSize}else t=e.offsetWidth,a=e.offsetHeight;s({width:t,height:a})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}s(void 0)},[e]),r}},75323:(e,r,s)=>{Promise.resolve().then(s.bind(s,8550)),Promise.resolve().then(s.bind(s,15552)),Promise.resolve().then(s.bind(s,97533)),Promise.resolve().then(s.bind(s,23309))},97533:(e,r,s)=>{"use strict";s.d(r,{PreprocessDatasetDialog:()=>X});var t=s(42227),a=s(49139),n=s(27702),i=s(10394),c=s(28527),l=s(86722),d=s(15568),o=s(30194),u=s(70709),h=s(3949),p=s(75571),m=s(64825),x=s(65133),v=s(94185),j=s(4517);let g=(0,j.createServerReference)("7f9e7f2f8d2eeef4de59458efda0f9540fbc9c3f0a",j.callServer,void 0,j.findSourceMapURL,"preprocessDataset");var f=s(7567),b=s(12899),N=s(82250),y=s(72014),k=s(65898),C=s(12503),S=s(54246),w="Checkbox",[R,E]=(0,b.A)(w),[_,P]=R(w);function A(e){let{__scopeCheckbox:r,checked:s,children:n,defaultChecked:i,disabled:c,form:l,name:d,onCheckedChange:o,required:u,value:h="on",internal_do_not_use_render:p}=e,[m,x]=(0,y.i)({prop:s,defaultProp:null!=i&&i,onChange:o,caller:w}),[v,j]=a.useState(null),[g,f]=a.useState(null),b=a.useRef(!1),N=!v||!!l||!!v.closest("form"),k={checked:m,disabled:c,setChecked:x,control:v,setControl:j,name:d,form:l,value:h,hasConsumerStoppedPropagationRef:b,required:u,defaultChecked:!I(i)&&i,isFormControl:N,bubbleInput:g,setBubbleInput:f};return(0,t.jsx)(_,{scope:r,...k,children:"function"==typeof p?p(k):n})}var F="CheckboxTrigger",O=a.forwardRef((e,r)=>{let{__scopeCheckbox:s,onKeyDown:n,onClick:i,...c}=e,{control:l,value:d,disabled:o,checked:u,required:h,setControl:p,setChecked:m,hasConsumerStoppedPropagationRef:x,isFormControl:v,bubbleInput:j}=P(F,s),g=(0,f.s)(r,p),b=a.useRef(u);return a.useEffect(()=>{let e=null==l?void 0:l.form;if(e){let r=()=>m(b.current);return e.addEventListener("reset",r),()=>e.removeEventListener("reset",r)}},[l,m]),(0,t.jsx)(S.sG.button,{type:"button",role:"checkbox","aria-checked":I(u)?"mixed":u,"aria-required":h,"data-state":G(u),"data-disabled":o?"":void 0,disabled:o,value:d,...c,ref:g,onKeyDown:(0,N.m)(n,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,N.m)(i,e=>{m(e=>!!I(e)||!e),j&&v&&(x.current=e.isPropagationStopped(),x.current||e.stopPropagation())})})});O.displayName=F;var z=a.forwardRef((e,r)=>{let{__scopeCheckbox:s,name:a,checked:n,defaultChecked:i,required:c,disabled:l,value:d,onCheckedChange:o,form:u,...h}=e;return(0,t.jsx)(A,{__scopeCheckbox:s,checked:n,defaultChecked:i,disabled:l,required:c,onCheckedChange:o,name:a,form:u,value:d,internal_do_not_use_render:e=>{let{isFormControl:a}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(O,{...h,ref:r,__scopeCheckbox:s}),a&&(0,t.jsx)(q,{__scopeCheckbox:s})]})}})});z.displayName=w;var D="CheckboxIndicator",J=a.forwardRef((e,r)=>{let{__scopeCheckbox:s,forceMount:a,...n}=e,i=P(D,s);return(0,t.jsx)(C.C,{present:a||I(i.checked)||!0===i.checked,children:(0,t.jsx)(S.sG.span,{"data-state":G(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:r,style:{pointerEvents:"none",...e.style}})})});J.displayName=D;var L="CheckboxBubbleInput",q=a.forwardRef((e,r)=>{let{__scopeCheckbox:s,...n}=e,{control:i,hasConsumerStoppedPropagationRef:c,checked:l,defaultChecked:d,required:o,disabled:u,name:h,value:p,form:m,bubbleInput:x,setBubbleInput:v}=P(L,s),j=(0,f.s)(r,v),g=function(e){let r=a.useRef({value:e,previous:e});return a.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}(l),b=(0,k.X)(i);a.useEffect(()=>{if(!x)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,r=!c.current;if(g!==l&&e){let s=new Event("click",{bubbles:r});x.indeterminate=I(l),e.call(x,!I(l)&&l),x.dispatchEvent(s)}},[x,g,l,c]);let N=a.useRef(!I(l)&&l);return(0,t.jsx)(S.sG.input,{type:"checkbox","aria-hidden":!0,defaultChecked:null!=d?d:N.current,required:o,disabled:u,name:h,value:p,form:m,...n,tabIndex:-1,ref:j,style:{...n.style,...b,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function I(e){return"indeterminate"===e}function G(e){return I(e)?"indeterminate":e?"checked":"unchecked"}q.displayName=L;var M=s(50126),$=s(27058);function B(e){let{className:r,...s}=e;return(0,t.jsx)(z,{"data-slot":"checkbox",className:(0,$.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",r),...s,children:(0,t.jsx)(J,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,t.jsx)(M.A,{className:"size-3.5"})})})}function T(){let{pending:e}=(0,l.useFormStatus)();return(0,t.jsx)(u.$,{type:"submit",disabled:e,children:e?"Saving...":"Save"})}function H(e){let{index:r,preprocessors:s,preprocessorInputs:a,setPreprocessorInputs:n}=e;return(0,t.jsx)("div",{className:"my-4",children:(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(m.J,{htmlFor:"preprocessor-name-"+r,children:"Name"}),(0,t.jsxs)(v.l6,{required:!0,value:a[r].name,onValueChange:e=>n(a.map((s,t)=>t===r?{...s,name:e}:s)),children:[(0,t.jsx)(v.bq,{className:"col-span-3",children:(0,t.jsx)(v.yv,{placeholder:"Select a preprocessor"})}),(0,t.jsx)(v.gC,{className:"col-span-3",children:s.map(e=>(0,t.jsx)(v.eb,{value:e,children:e},e))})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(m.J,{htmlFor:"preprocessor-params-"+r,children:"Params"}),(0,t.jsx)(p.p,{id:"preprocessor-params-"+r,className:"col-span-3",placeholder:'{"max_length": 512}',required:!0,value:a[r].params,onChange:e=>n(a.map((s,t)=>t===r?{...s,params:e.target.value}:s))})]})]})})}function X(e){let{datasetId:r,shardsets:s,preprocessors:l,children:j}=e,[f,b]=(0,a.useState)(""),[N,y]=(0,a.useState)([]),[k,C]=(0,a.useState)([]),[S,w]=(0,a.useState)([]),[R,E]=(0,a.useState)(1),[_,P]=(0,a.useState)(!1),[A,F]=(0,a.useState)(!1),[O,z]=(0,a.useState)(!1),D=(0,a.useRef)(null),J=()=>{var e;b(""),y([]),C([]),w([]),E(1),null===(e=D.current)||void 0===e||e.reset()},L=async e=>{let s="";try{let e=N.map(e=>({name:e.name,params:JSON.parse(e.params)}));s=JSON.stringify(e)}catch(e){c.oR.error("Invalid preprocessor params");return}let t=await g(r,f,k,s,S,R,_,A);t.success?(c.oR.success("Started preprocessing"),z(!1),J()):c.oR.error("Failed to start preprocessing: ".concat(t.error))};return 0===l.length?(0,t.jsxs)(h.lG,{open:O,onOpenChange:z,children:[(0,t.jsx)(h.zM,{asChild:!0,children:j}),(0,t.jsx)(h.Cf,{className:"sm:max-w-[600px]",children:(0,t.jsxs)(h.c7,{children:[(0,t.jsx)(h.L3,{children:"No preprocessors found!"}),(0,t.jsx)(h.rr,{children:"Please create a preprocessor first."})]})})]}):(0,t.jsxs)(h.lG,{open:O,onOpenChange:z,children:[(0,t.jsx)(h.zM,{asChild:!0,children:j}),(0,t.jsxs)(h.Cf,{className:"sm:max-w-[600px]",children:[(0,t.jsxs)(h.c7,{children:[(0,t.jsx)(h.L3,{children:"Preprocess"}),(0,t.jsx)(h.rr,{children:"Generate a new shardset by preprocessing the dataset."})]}),(0,t.jsxs)("form",{ref:D,action:L,children:[(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsx)("div",{className:"text-lg mt-2",children:"Source"}),k.map((e,r)=>(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(m.J,{htmlFor:"source",className:"text-right",children:"Shardset"}),(0,t.jsxs)(v.l6,{name:"source",required:!0,value:e,onValueChange:e=>C(s=>{let t=[...s];return t[r]=e,t}),children:[(0,t.jsx)(v.bq,{className:"col-span-3",children:(0,t.jsx)(v.yv,{placeholder:"Select a source"})}),(0,t.jsx)(v.gC,{className:"col-span-3",children:s.map(e=>(0,t.jsx)(v.eb,{value:e.id,disabled:k.includes(e.id),children:e.location},e.id))})]})]},"sourceShardset-".concat(r))),k.length<s.length&&(0,t.jsxs)(u.$,{type:"button",variant:"outline",onClick:()=>C([...k,""]),children:[(0,t.jsx)(n.A,{}),"Add Source Shardset"]}),(0,t.jsxs)("div",{className:"text-lg mt-2 flex gap-2 items-center",children:[(0,t.jsx)("div",{children:"Preprocessors"}),(0,t.jsx)(x.F,{icon:(0,t.jsx)(i.A,{className:"w-4 h-4"}),content:(0,t.jsx)("p",{})})]}),(0,t.jsx)(d.F,{className:"max-h-[200px]",children:N.map((e,r)=>(0,t.jsxs)("div",{children:[(0,t.jsx)(H,{index:r,preprocessors:l,preprocessorInputs:N,setPreprocessorInputs:y}),(0,t.jsx)(o.w,{className:"my-2"})]},r))}),(0,t.jsxs)(u.$,{type:"button",variant:"outline",onClick:()=>y([...N,{name:"",params:"{}"}]),children:[(0,t.jsx)(n.A,{}),"Add Preprocessor"]})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsx)("div",{className:"text-lg mt-2",children:"Configuration"}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(m.J,{htmlFor:"location",className:"text-right",children:"Batch Size"}),(0,t.jsx)(p.p,{id:"batch_size",name:"batch_size",type:"number",className:"col-span-3",placeholder:"100",required:!0,value:R,onChange:e=>E(Number(e.target.value))})]})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsx)("div",{className:"text-lg mt-2",children:"Output"}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(m.J,{htmlFor:"location",className:"text-right",children:"Location"}),(0,t.jsx)(p.p,{id:"location",name:"location",className:"col-span-3",placeholder:"s3://bucket/path/to/shardset/",required:!0,value:f,onChange:e=>b(e.target.value)})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(m.J,{htmlFor:"location",className:"text-right",children:"Overwrite"}),(0,t.jsx)(B,{id:"overwrite",name:"overwrite",checked:_,onCheckedChange:e=>P("indeterminate"!==e&&e)})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(m.J,{htmlFor:"location",className:"text-right",children:"Drop Last"}),(0,t.jsx)(B,{id:"drop_last",name:"drop_last",checked:A,onCheckedChange:e=>F("indeterminate"!==e&&e)})]}),S.map((e,r)=>(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsxs)(m.J,{htmlFor:"location",className:"text-right",children:["Export Column ",r+1]}),(0,t.jsx)(p.p,{id:"location",name:"location",className:"col-span-3",placeholder:"new_column_name",required:!0,value:e,onChange:e=>w(s=>{let t=[...s];return t[r]=e.target.value,t})},"export-column-".concat(r))]})),(0,t.jsxs)(u.$,{type:"button",variant:"outline",className:"",onClick:()=>w([...S,""]),children:[(0,t.jsx)(n.A,{}),"Add Export Column"]})]}),(0,t.jsx)(h.Es,{children:(0,t.jsx)(T,{})})]})]})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[4452,1701,3228,4006,8527,543,4249,7756,2056,813,5236,7358],()=>r(75323)),_N_E=e.O()}]);